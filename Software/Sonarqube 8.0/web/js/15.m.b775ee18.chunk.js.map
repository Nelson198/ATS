{"version":3,"sources":["webpack:///./src/main/js/components/SourceViewer/helpers/issueLocations.ts","webpack:///./src/main/js/components/SourceViewer/SourceViewerContext.tsx","webpack:///./src/main/js/components/SourceViewer/components/DuplicationPopup.tsx","webpack:///./src/main/js/components/SourceViewer/helpers/duplications.ts","webpack:///./src/main/js/components/SourceViewer/helpers/highlight.ts","webpack:///./src/main/js/components/SourceViewer/helpers/lines.ts","webpack:///./src/main/js/components/SourceViewer/SourceViewerHeaderSlim.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineIssuesList.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineCode.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineCoverage.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineDuplicationBlock.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineDuplications.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineIssuesIndicator.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineOptionsPopup.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineNumber.tsx","webpack:///./src/main/js/components/SourceViewer/components/SCMPopup.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineSCM.tsx","webpack:///./src/main/js/components/SourceViewer/components/Line.tsx","webpack:///./src/main/js/components/SourceViewer/components/Line.css?c4c1","webpack:///./src/main/js/components/SourceViewer/components/Line.css","webpack:///./src/main/js/components/SourceViewer/SourceViewerHeaderSlim.css?14cf","webpack:///./src/main/js/components/SourceViewer/SourceViewerHeaderSlim.css","webpack:///./src/main/js/api/favorites.ts","webpack:///./src/main/js/components/controls/Favorite.tsx","webpack:///./src/main/js/components/SourceViewer/helpers/indexing.ts"],"names":["getLinearLocations","textRange","locations","line","startLine","endLine","from","startOffset","to","endOffset","push","getSecondaryIssueLocationsForLine","highlightedLocations","reduce","location","filter","l","map","Object","assign","index","text","msg","__webpack_require__","d","__webpack_exports__","SourceViewerContext","react__WEBPACK_IMPORTED_MODULE_0__","branchLike","file","DuplicationPopup","react__WEBPACK_IMPORTED_MODULE_2__","[object Object]","this","isDifferentComponent","a","b","Boolean","project","subProject","handleFileClick","event","preventDefault","currentTarget","blur","_event$currentTarget$","dataset","key","shouldLink","props","openComponent","Number","undefined","onClose","_helpers_branches__WEBPACK_IMPORTED_MODULE_10__","children","data-key","data-line","href","onClick","title","name","_this$props","_this$props$duplicate","duplicatedFiles","sourceViewerFile","groupedBlocks","lodash_groupBy__WEBPACK_IMPORTED_MODULE_1___default","blocks","duplications","keys","fileRef","lodash_sortBy__WEBPACK_IMPORTED_MODULE_0___default","projectName","subProjectName","sonar_ui_common_components_controls_Dropdown__WEBPACK_IMPORTED_MODULE_4__","placement","sonar_ui_common_components_ui_popups__WEBPACK_IMPORTED_MODULE_7__","RightTop","className","inRemovedComponent","sonar_ui_common_components_ui_Alert__WEBPACK_IMPORTED_MODULE_6__","variant","sonar_ui_common_helpers_l10n__WEBPACK_IMPORTED_MODULE_8__","length","duplication","sonar_ui_common_components_icons_QualifierIcon__WEBPACK_IMPORTED_MODULE_5___default","qualifier","react_router__WEBPACK_IMPORTED_MODULE_3__","_helpers_urls__WEBPACK_IMPORTED_MODULE_11__","renderDuplication","sonar_ui_common_helpers_path__WEBPACK_IMPORTED_MODULE_9__","block","size","filterDuplicationBlocksByLine","foundOne","outOfBounds","shouldDisplay","_ref","isOk","getDuplicationBlocksForIndex","isDuplicationBlockInRemovedComponent","some","ISSUE_LOCATION_CLASS","splitByTokens","code","rootClassName","arguments","container","document","createElement","tokens","innerHTML","forEach","call","childNodes","node","nodeType","fullClassName","innerTokens","concat","nodeValue","markers","highlightSymbol","symbol","symbolRegExp","RegExp","token","test","part","str","acc","substr","highlightIssueLocations","issueLocations","nextTokens","markerAdded","x","s1","e1","s2","e2","Math","max","min","intersect","p1","p2","p3","newClassName","indexOf","lodash_uniq__WEBPACK_IMPORTED_MODULE_0___default","slice","optimizeHighlightedSymbols","symbolsForLine","highlightedSymbols","symbols","lodash_intersection__WEBPACK_IMPORTED_MODULE_0___default","optimizeLocationMessage","highlightedLocationMessage","optimizedSecondaryIssueLocations","optimizeSelectedIssue","selectedIssue","issuesForLine","find","issue","SourceViewerHeaderSlim","classnames__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_1__","react_router__WEBPACK_IMPORTED_MODULE_2__","sonar_ui_common_components_controls_buttons__WEBPACK_IMPORTED_MODULE_3__","sonar_ui_common_components_controls_clipboard__WEBPACK_IMPORTED_MODULE_4__","sonar_ui_common_components_icons_ExpandSnippetIcon__WEBPACK_IMPORTED_MODULE_5__","sonar_ui_common_components_icons_ExpandSnippetIcon__WEBPACK_IMPORTED_MODULE_5___default","n","sonar_ui_common_components_icons_QualifierIcon__WEBPACK_IMPORTED_MODULE_6__","sonar_ui_common_components_icons_QualifierIcon__WEBPACK_IMPORTED_MODULE_6___default","sonar_ui_common_components_ui_DeferredSpinner__WEBPACK_IMPORTED_MODULE_7__","sonar_ui_common_components_ui_DeferredSpinner__WEBPACK_IMPORTED_MODULE_7___default","sonar_ui_common_helpers_urls__WEBPACK_IMPORTED_MODULE_10__","_helpers_branches__WEBPACK_IMPORTED_MODULE_11__","_helpers_urls__WEBPACK_IMPORTED_MODULE_12__","_controls_Favorite__WEBPACK_IMPORTED_MODULE_13__","expandable","loading","onExpand","measures","path","q","copyValue","canMarkAsFavorite","component","favorite","fav","issues","little-spacer-right","fileUuids","uuid","resolved","LineIssuesList","issuePopup","index_js_exposed","Issue","onChange","onIssueChange","onIssueClick","onPopupToggle","onIssuePopupToggle","openPopup","selected","LineCode_LineCode","super","handleSymbolClick","match","onSymbolClick","state","highlight","attachEvents","activeMarkerNode","scroll","nextProps","setState","detachEvents","prevProps","codeNode","querySelectorAll","i","addEventListener","message","leading","onLocationSelect","ref","LocationIndex","LocationMessage","onIssueSelect","padding","secondaryIssueLocations","showIssues","classnames","has-issues","renderedTokens","leadingMarker","displayLocationMarkers","marker","loc","renderMarker","trim","style","paddingBottom","filteredSelectedIssues","data-line-number","LineCoverage","coverageStatus","Tooltip_default","overlay","getStatusTooltip","conditions","l10n","coveredConditions","LineDuplicationBlock_LineDuplicationBlock","handleClick","stopPropagation","handleTogglePopup","open","closePopup","duplicated","popupOpen","source-line-duplicated","data-index","Toggler_default","onRequestClose","renderDuplicationPopup","role","tabIndex","LineDuplications_LineDuplications","cell","LineIssuesIndicator_LineIssuesIndicator","hasIssues","source-line-with-issues","mostImportantIssue","helpers_issues","IssueIcon_default","type","LineOptionsPopup","Consumer","_ref2","Dropdown","popups","es","rel","target","urls","LineNumber_LineNumber","lineNumber","SCMPopup","hasAuthor","scmAuthor","scmDate","spacer-top","DateFormatter","date","scmRevision","LineSCM_LineSCM","previousLine","hasPopup","s","p","changed","isSCMChanged","data-author","LINE_HEIGHT","Line_Line","isPopupOpen","linePopup","handleIssuesIndicatorClick","openIssues","onIssuesClose","onIssueUnselect","onIssuesOpen","_this$props2","displayCoverage","duplicationsCount","source-line-highlighted","highlighted","source-line-filtered","isNew","source-line-filtered-dark","source-line-last","last","bottomPadding","verticalBuffer","onLinePopupToggle","displayIssues","displayAllIssues","displayDuplications","loadDuplications","times_default","includes","content","module","options","hmr","transform","insertInto","locals","exports","addFavorite","request","removeFavorite","Favorite_Favorite","mounted","toggleFavorite","newFavorite","then","handleFavorite","_prevProps","prevState","FavoriteButton_default","issuesByLine","issuesByComponentAndLine","mapping","locationsByLine","_issueLocations__WEBPACK_IMPORTED_MODULE_2__","duplicationsByLine","duplicationIndex","symbolsByLine","sources","_highlight__WEBPACK_IMPORTED_MODULE_1__","lodash_flatten__WEBPACK_IMPORTED_MODULE_0___default"],"mappings":"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","file":"js/15.m.b775ee18.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nexport function getLinearLocations(textRange: T.TextRange | undefined): T.LinearIssueLocation[] {\n  if (!textRange) {\n    return [];\n  }\n  const locations = [];\n\n  // go through all lines of the `textRange`\n  for (let line = textRange.startLine; line <= textRange.endLine; line++) {\n    // TODO fix 999999\n    const from = line === textRange.startLine ? textRange.startOffset : 0;\n    const to = line === textRange.endLine ? textRange.endOffset : 999999;\n    locations.push({ line, from, to });\n  }\n  return locations;\n}\n\nexport function getSecondaryIssueLocationsForLine(\n  line: T.SourceLine,\n  highlightedLocations: (T.FlowLocation | undefined)[] | undefined\n): T.LinearIssueLocation[] {\n  if (!highlightedLocations) {\n    return [];\n  }\n  return highlightedLocations.reduce((locations, location) => {\n    const linearLocations: T.LinearIssueLocation[] = location\n      ? getLinearLocations(location.textRange)\n          .filter(l => l.line === line.line)\n          .map(l => ({\n            ...l,\n            startLine: location.textRange.startLine,\n            index: location.index,\n            text: location.msg\n          }))\n      : [];\n    return [...locations, ...linearLocations];\n  }, []);\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\n\ninterface SourceViewerContextShape {\n  branchLike?: T.BranchLike;\n  file: T.SourceViewerFile;\n}\n\nexport const SourceViewerContext = React.createContext({\n  branchLike: {},\n  file: {}\n}) as React.Context<SourceViewerContextShape>;\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { groupBy, sortBy } from 'lodash';\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { DropdownOverlay } from 'sonar-ui-common/components/controls/Dropdown';\nimport QualifierIcon from 'sonar-ui-common/components/icons/QualifierIcon';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { PopupPlacement } from 'sonar-ui-common/components/ui/popups';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { collapsedDirFromPath, fileFromPath } from 'sonar-ui-common/helpers/path';\nimport { isPullRequest, isShortLivingBranch } from '../../../helpers/branches';\nimport { getProjectUrl } from '../../../helpers/urls';\nimport { WorkspaceContextShape } from '../../workspace/context';\n\ninterface Props {\n  blocks: T.DuplicationBlock[];\n  branchLike: T.BranchLike | undefined;\n  duplicatedFiles?: T.Dict<T.DuplicatedFile>;\n  inRemovedComponent: boolean;\n  onClose: () => void;\n  openComponent: WorkspaceContextShape['openComponent'];\n  sourceViewerFile: T.SourceViewerFile;\n}\n\nexport default class DuplicationPopup extends React.PureComponent<Props> {\n  shouldLink() {\n    const { branchLike } = this.props;\n    return !isShortLivingBranch(branchLike) && !isPullRequest(branchLike);\n  }\n\n  isDifferentComponent = (\n    a: { project: string; subProject?: string },\n    b: { project: string; subProject?: string }\n  ) => {\n    return Boolean(a && b && (a.project !== b.project || a.subProject !== b.subProject));\n  };\n\n  handleFileClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    const { key, line } = event.currentTarget.dataset;\n    if (this.shouldLink() && key) {\n      this.props.openComponent({\n        branchLike: this.props.branchLike,\n        key,\n        line: line ? Number(line) : undefined\n      });\n    }\n    this.props.onClose();\n  };\n\n  renderDuplication(file: T.DuplicatedFile, children: React.ReactNode, line?: number) {\n    return this.shouldLink() ? (\n      <a\n        data-key={file.key}\n        data-line={line}\n        href=\"#\"\n        onClick={this.handleFileClick}\n        title={file.name}>\n        {children}\n      </a>\n    ) : (\n      children\n    );\n  }\n\n  render() {\n    const { duplicatedFiles = {}, sourceViewerFile } = this.props;\n\n    const groupedBlocks = groupBy(this.props.blocks, '_ref');\n    let duplications = Object.keys(groupedBlocks).map(fileRef => {\n      return {\n        blocks: groupedBlocks[fileRef],\n        file: duplicatedFiles[fileRef]\n      };\n    });\n\n    // first duplications in the same file\n    // then duplications in the same sub-project\n    // then duplications in the same project\n    // then duplications in other projects\n    duplications = sortBy(\n      duplications,\n      d => d.file.projectName !== sourceViewerFile.projectName,\n      d => d.file.subProjectName !== sourceViewerFile.subProjectName,\n      d => d.file.key !== sourceViewerFile.key\n    );\n\n    return (\n      <DropdownOverlay placement={PopupPlacement.RightTop}>\n        <div className=\"source-viewer-bubble-popup abs-width-400\">\n          {this.props.inRemovedComponent && (\n            <Alert variant=\"warning\">\n              {translate('duplications.dups_found_on_deleted_resource')}\n            </Alert>\n          )}\n          {duplications.length > 0 && (\n            <>\n              <h6 className=\"spacer-bottom\">\n                {translate('component_viewer.transition.duplication')}\n              </h6>\n              {duplications.map(duplication => (\n                <div className=\"spacer-top text-ellipsis\" key={duplication.file.key}>\n                  <div className=\"component-name\">\n                    {this.isDifferentComponent(duplication.file, this.props.sourceViewerFile) && (\n                      <>\n                        <div className=\"component-name-parent\">\n                          <QualifierIcon className=\"little-spacer-right\" qualifier=\"TRK\" />\n                          <Link to={getProjectUrl(duplication.file.project)}>\n                            {duplication.file.projectName}\n                          </Link>\n                        </div>\n                        {duplication.file.subProject && duplication.file.subProjectName && (\n                          <div className=\"component-name-parent\">\n                            <QualifierIcon className=\"little-spacer-right\" qualifier=\"BRC\" />\n                            {duplication.file.subProjectName}\n                          </div>\n                        )}\n                      </>\n                    )}\n\n                    {duplication.file.key !== this.props.sourceViewerFile.key && (\n                      <div className=\"component-name-path\">\n                        {this.renderDuplication(\n                          duplication.file,\n                          <>\n                            <span>{collapsedDirFromPath(duplication.file.name)}</span>\n                            <span className=\"component-name-file\">\n                              {fileFromPath(duplication.file.name)}\n                            </span>\n                          </>\n                        )}\n                      </div>\n                    )}\n\n                    <div className=\"component-name-path\">\n                      {'Lines: '}\n                      {duplication.blocks.map((block, index) => (\n                        <React.Fragment key={index}>\n                          {this.renderDuplication(\n                            duplication.file,\n                            <>\n                              {block.from}\n                              {' – '}\n                              {block.from + block.size - 1}\n                            </>,\n                            block.from\n                          )}\n                          {index < duplication.blocks.length - 1 && ', '}\n                        </React.Fragment>\n                      ))}\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </>\n          )}\n        </div>\n      </DropdownOverlay>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n\n// TODO Test this function, but I don't get the logic behind it\nexport function filterDuplicationBlocksByLine(blocks: T.DuplicationBlock[], line: number) {\n  /* eslint-disable no-underscore-dangle */\n  let foundOne = false;\n  return blocks.filter(b => {\n    const outOfBounds = b.from > line || b.from + b.size < line;\n    const currentFile = b._ref === '1';\n    const shouldDisplayForCurrentFile = outOfBounds || foundOne;\n    const shouldDisplay = !currentFile || shouldDisplayForCurrentFile;\n    const isOk = b._ref !== undefined && shouldDisplay;\n    if (b._ref === '1' && !outOfBounds) {\n      foundOne = true;\n    }\n    return isOk;\n  });\n  /* eslint-enable no-underscore-dangle */\n}\n\nexport function getDuplicationBlocksForIndex(\n  duplications: T.Duplication[] | undefined,\n  index: number\n) {\n  return (duplications && duplications[index] && duplications[index].blocks) || [];\n}\n\nexport function isDuplicationBlockInRemovedComponent(blocks: T.DuplicationBlock[]) {\n  return blocks.some(b => b._ref === undefined); // eslint-disable-line no-underscore-dangle\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { uniq } from 'lodash';\n\nexport interface Token {\n  className: string;\n  markers: number[];\n  text: string;\n}\n\nconst ISSUE_LOCATION_CLASS = 'source-line-code-issue';\n\nexport function splitByTokens(code: string, rootClassName = ''): Token[] {\n  const container = document.createElement('div');\n  let tokens: Token[] = [];\n  container.innerHTML = code;\n  [].forEach.call(container.childNodes, (node: Element) => {\n    if (node.nodeType === 1) {\n      // ELEMENT NODE\n      const fullClassName = rootClassName ? rootClassName + ' ' + node.className : node.className;\n      const innerTokens = splitByTokens(node.innerHTML, fullClassName);\n      tokens = tokens.concat(innerTokens);\n    }\n    if (node.nodeType === 3 && node.nodeValue) {\n      // TEXT NODE\n      tokens.push({ className: rootClassName, markers: [], text: node.nodeValue });\n    }\n  });\n  return tokens;\n}\n\nexport function highlightSymbol(tokens: Token[], symbol: string): Token[] {\n  const symbolRegExp = new RegExp(`\\\\b${symbol}\\\\b`);\n  return tokens.map(token =>\n    symbolRegExp.test(token.className)\n      ? { ...token, className: `${token.className} highlighted` }\n      : token\n  );\n}\n\n/**\n * Intersect two ranges\n * @param s1 Start position of the first range\n * @param e1 End position of the first range\n * @param s2 Start position of the second range\n * @param e2 End position of the second range\n */\nfunction intersect(s1: number, e1: number, s2: number, e2: number) {\n  return { from: Math.max(s1, s2), to: Math.min(e1, e2) };\n}\n\n/**\n * Get the substring of a string\n * @param str A string\n * @param from \"From\" offset\n * @param to \"To\" offset\n * @param acc Global offset to eliminate\n */\nfunction part(str: string, from: number, to: number, acc: number): string {\n  // we do not want negative number as the first argument of `substr`\n  return from >= acc ? str.substr(from - acc, to - from) : str.substr(0, to - from);\n}\n\n/**\n * Highlight issue locations in the list of tokens\n */\nexport function highlightIssueLocations(\n  tokens: Token[],\n  issueLocations: T.LinearIssueLocation[],\n  rootClassName: string = ISSUE_LOCATION_CLASS\n): Token[] {\n  issueLocations.forEach(location => {\n    const nextTokens: Token[] = [];\n    let acc = 0;\n    let markerAdded = location.line !== location.startLine;\n    tokens.forEach(token => {\n      const x = intersect(acc, acc + token.text.length, location.from, location.to);\n      const p1 = part(token.text, acc, x.from, acc);\n      const p2 = part(token.text, x.from, x.to, acc);\n      const p3 = part(token.text, x.to, acc + token.text.length, acc);\n      if (p1.length) {\n        nextTokens.push({ ...token, text: p1 });\n      }\n      if (p2.length) {\n        const newClassName =\n          token.className.indexOf(rootClassName) === -1\n            ? `${token.className} ${rootClassName}`\n            : token.className;\n        nextTokens.push({\n          className: newClassName,\n          markers:\n            !markerAdded && location.index != null\n              ? uniq([...token.markers, location.index])\n              : token.markers,\n          text: p2\n        });\n        markerAdded = true;\n      }\n      if (p3.length) {\n        nextTokens.push({ ...token, text: p3 });\n      }\n      acc += token.text.length;\n    });\n    tokens = nextTokens.slice();\n  });\n  return tokens;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { intersection } from 'lodash';\n\nexport function optimizeHighlightedSymbols(\n  symbolsForLine: string[] = [],\n  highlightedSymbols: string[] = []\n): string[] | undefined {\n  const symbols = intersection(symbolsForLine, highlightedSymbols);\n\n  return symbols.length ? symbols : undefined;\n}\n\nexport function optimizeLocationMessage(\n  highlightedLocationMessage: { index: number; text: string | undefined } | undefined,\n  optimizedSecondaryIssueLocations: T.LinearIssueLocation[]\n) {\n  return highlightedLocationMessage != null &&\n    optimizedSecondaryIssueLocations.some(\n      location => location.index === highlightedLocationMessage.index\n    )\n    ? highlightedLocationMessage\n    : undefined;\n}\n\nexport function optimizeSelectedIssue(selectedIssue: string | undefined, issuesForLine: T.Issue[]) {\n  return selectedIssue !== undefined && issuesForLine.find(issue => issue.key === selectedIssue)\n    ? selectedIssue\n    : undefined;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { ButtonIcon } from 'sonar-ui-common/components/controls/buttons';\nimport { ClipboardIconButton } from 'sonar-ui-common/components/controls/clipboard';\nimport ExpandSnippetIcon from 'sonar-ui-common/components/icons/ExpandSnippetIcon';\nimport QualifierIcon from 'sonar-ui-common/components/icons/QualifierIcon';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { collapsedDirFromPath, fileFromPath } from 'sonar-ui-common/helpers/path';\nimport { getPathUrlAsString } from 'sonar-ui-common/helpers/urls';\nimport { getBranchLikeQuery, isMainBranch } from '../../helpers/branches';\nimport { getBranchLikeUrl, getComponentIssuesUrl } from '../../helpers/urls';\nimport Favorite from '../controls/Favorite';\nimport './SourceViewerHeaderSlim.css';\n\nexport interface Props {\n  branchLike: T.BranchLike | undefined;\n  expandable?: boolean;\n  loading?: boolean;\n  onExpand?: () => void;\n  sourceViewerFile: T.SourceViewerFile;\n}\n\nexport default function SourceViewerHeaderSlim({\n  branchLike,\n  expandable,\n  loading,\n  onExpand,\n  sourceViewerFile\n}: Props) {\n  const {\n    key,\n    measures,\n    path,\n    project,\n    projectName,\n    q,\n    subProject,\n    subProjectName\n  } = sourceViewerFile;\n\n  return (\n    <div className=\"source-viewer-header-slim display-flex-row display-flex-space-between\">\n      <div className=\"display-flex-center flex-1\">\n        <div>\n          <a\n            className=\"link-with-icon\"\n            href={getPathUrlAsString(getBranchLikeUrl(project, branchLike))}>\n            <QualifierIcon qualifier=\"TRK\" /> <span>{projectName}</span>\n          </a>\n        </div>\n\n        {subProject !== undefined && (\n          <>\n            <QualifierIcon qualifier=\"BRC\" /> <span>{subProjectName}</span>\n          </>\n        )}\n\n        <div className=\"spacer-left\">\n          <QualifierIcon qualifier={q} /> <span>{collapsedDirFromPath(path)}</span>\n          <span className=\"component-name-file\">{fileFromPath(path)}</span>\n        </div>\n\n        <div className=\"spacer-left\">\n          <ClipboardIconButton className=\"button-link link-no-underline\" copyValue={path} />\n        </div>\n\n        {sourceViewerFile.canMarkAsFavorite && (!branchLike || isMainBranch(branchLike)) && (\n          <div className=\"nudged-up spacer-left\">\n            <Favorite\n              className=\"component-name-favorite\"\n              component={key}\n              favorite={sourceViewerFile.fav || false}\n              qualifier={sourceViewerFile.q}\n            />\n          </div>\n        )}\n      </div>\n\n      {measures.issues !== undefined && (\n        <div\n          className={classNames('flex-0 big-spacer-left', {\n            'little-spacer-right': !expandable || loading\n          })}>\n          <Link\n            to={getComponentIssuesUrl(project, {\n              ...getBranchLikeQuery(branchLike),\n              fileUuids: sourceViewerFile.uuid,\n              resolved: 'false'\n            })}>\n            {translate('source_viewer.view_all_issues')}\n          </Link>\n        </div>\n      )}\n\n      {expandable && (\n        <DeferredSpinner className=\"little-spacer-right\" loading={loading}>\n          <div className=\"flex-0 big-spacer-left\">\n            <ButtonIcon className=\"js-actions\" onClick={onExpand}>\n              <ExpandSnippetIcon />\n            </ButtonIcon>\n          </div>\n        </DeferredSpinner>\n      )}\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Issue from '../../issue/Issue';\n\ninterface Props {\n  branchLike: T.BranchLike | undefined;\n  issuePopup: { issue: string; name: string } | undefined;\n  issues: T.Issue[];\n  onIssueChange: (issue: T.Issue) => void;\n  onIssueClick: (issueKey: string) => void;\n  onIssuePopupToggle: (issue: string, popupName: string, open?: boolean) => void;\n  selectedIssue: string | undefined;\n}\n\nexport default function LineIssuesList(props: Props) {\n  const { issuePopup } = props;\n\n  return (\n    <div className=\"issue-list\">\n      {props.issues.map(issue => (\n        <Issue\n          branchLike={props.branchLike}\n          issue={issue}\n          key={issue.key}\n          onChange={props.onIssueChange}\n          onClick={props.onIssueClick}\n          onPopupToggle={props.onIssuePopupToggle}\n          openPopup={issuePopup && issuePopup.issue === issue.key ? issuePopup.name : undefined}\n          selected={props.selectedIssue === issue.key}\n        />\n      ))}\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport LocationIndex from '../../common/LocationIndex';\nimport LocationMessage from '../../common/LocationMessage';\nimport {\n  highlightIssueLocations,\n  highlightSymbol,\n  splitByTokens,\n  Token\n} from '../helpers/highlight';\nimport LineIssuesList from './LineIssuesList';\n\ninterface Props {\n  branchLike: T.BranchLike | undefined;\n  displayLocationMarkers?: boolean;\n  highlightedLocationMessage: { index: number; text: string | undefined } | undefined;\n  highlightedSymbols: string[] | undefined;\n  issueLocations: T.LinearIssueLocation[];\n  issuePopup: { issue: string; name: string } | undefined;\n  issues: T.Issue[];\n  line: T.SourceLine;\n  onIssueChange: (issue: T.Issue) => void;\n  onIssuePopupToggle: (issue: string, popupName: string, open?: boolean) => void;\n  onIssueSelect: (issueKey: string) => void;\n  onLocationSelect: ((index: number) => void) | undefined;\n  onSymbolClick: (symbols: Array<string>) => void;\n  padding?: number;\n  scroll?: (element: HTMLElement) => void;\n  secondaryIssueLocations: T.LinearIssueLocation[];\n  selectedIssue: string | undefined;\n  showIssues?: boolean;\n}\n\ninterface State {\n  tokens: Token[];\n}\n\nexport default class LineCode extends React.PureComponent<Props, State> {\n  activeMarkerNode?: HTMLElement | null;\n  codeNode?: HTMLElement | null;\n  symbols?: NodeListOf<HTMLElement>;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      tokens: splitByTokens(props.line.code || '')\n    };\n  }\n\n  componentDidMount() {\n    this.attachEvents();\n    if (this.props.highlightedLocationMessage && this.activeMarkerNode && this.props.scroll) {\n      this.props.scroll(this.activeMarkerNode);\n    }\n  }\n\n  componentWillReceiveProps(nextProps: Props) {\n    if (nextProps.line.code !== this.props.line.code) {\n      this.setState({\n        tokens: splitByTokens(nextProps.line.code || '')\n      });\n    }\n  }\n\n  componentWillUpdate() {\n    this.detachEvents();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    this.attachEvents();\n    if (\n      this.props.highlightedLocationMessage &&\n      (!prevProps.highlightedLocationMessage ||\n        prevProps.highlightedLocationMessage.index !==\n          this.props.highlightedLocationMessage.index) &&\n      this.activeMarkerNode &&\n      this.props.scroll\n    ) {\n      this.props.scroll(this.activeMarkerNode);\n    }\n  }\n\n  componentWillUnmount() {\n    this.detachEvents();\n  }\n\n  attachEvents() {\n    if (this.codeNode) {\n      this.symbols = this.codeNode.querySelectorAll('.sym');\n      if (this.symbols) {\n        for (let i = 0; i < this.symbols.length; i++) {\n          const symbol = this.symbols[i];\n          symbol.addEventListener('click', this.handleSymbolClick);\n        }\n      }\n    }\n  }\n\n  detachEvents() {\n    if (this.symbols) {\n      for (let i = 0; i < this.symbols.length; i++) {\n        const symbol = this.symbols[i];\n        symbol.addEventListener('click', this.handleSymbolClick);\n      }\n    }\n  }\n\n  handleSymbolClick = (event: MouseEvent) => {\n    event.preventDefault();\n    const keys = (event.currentTarget as HTMLElement).className.match(/sym-\\d+/g);\n    if (keys && keys.length > 0) {\n      this.props.onSymbolClick(keys);\n    }\n  };\n\n  renderMarker(index: number, message: string | undefined, selected: boolean, leading: boolean) {\n    const { onLocationSelect } = this.props;\n    const onClick = onLocationSelect ? () => onLocationSelect(index) : undefined;\n    const ref = selected ? (node: HTMLElement | null) => (this.activeMarkerNode = node) : undefined;\n    return (\n      <LocationIndex\n        key={`marker-${index}`}\n        leading={leading}\n        onClick={onClick}\n        selected={selected}>\n        <span ref={ref}>{index + 1}</span>\n        {message && <LocationMessage selected={true}>{message}</LocationMessage>}\n      </LocationIndex>\n    );\n  }\n\n  render() {\n    const {\n      highlightedLocationMessage,\n      highlightedSymbols,\n      issues,\n      issueLocations,\n      line,\n      onIssueSelect,\n      padding,\n      secondaryIssueLocations,\n      selectedIssue,\n      showIssues\n    } = this.props;\n\n    let tokens = [...this.state.tokens];\n\n    if (highlightedSymbols) {\n      highlightedSymbols.forEach(symbol => {\n        tokens = highlightSymbol(tokens, symbol);\n      });\n    }\n\n    if (issueLocations.length > 0) {\n      tokens = highlightIssueLocations(tokens, issueLocations);\n    }\n\n    if (secondaryIssueLocations) {\n      tokens = highlightIssueLocations(tokens, secondaryIssueLocations, 'issue-location');\n\n      if (highlightedLocationMessage) {\n        const location = secondaryIssueLocations.find(\n          location => location.index === highlightedLocationMessage.index\n        );\n        if (location) {\n          tokens = highlightIssueLocations(tokens, [location], 'selected');\n        }\n      }\n    }\n\n    const className = classNames('source-line-code', 'code', {\n      'has-issues': issues.length > 0\n    });\n\n    const renderedTokens: React.ReactNode[] = [];\n\n    // track if the first marker is displayed before the source code\n    // set `false` for the first token in a row\n    let leadingMarker = false;\n\n    tokens.forEach((token, index) => {\n      if (this.props.displayLocationMarkers && token.markers.length > 0) {\n        token.markers.forEach(marker => {\n          const selected =\n            highlightedLocationMessage !== undefined && highlightedLocationMessage.index === marker;\n          const loc = secondaryIssueLocations.find(loc => loc.index === marker);\n          const message = loc && loc.text;\n          renderedTokens.push(this.renderMarker(marker, message, selected, leadingMarker));\n        });\n      }\n      renderedTokens.push(\n        <span className={token.className} key={index}>\n          {token.text}\n        </span>\n      );\n\n      // keep leadingMarker truthy if previous token has only whitespaces\n      leadingMarker = (index === 0 ? true : leadingMarker) && !token.text.trim().length;\n    });\n\n    const style = padding ? { paddingBottom: `${padding}px` } : undefined;\n    const filteredSelectedIssues = issues.filter(i => i.key === selectedIssue);\n\n    return (\n      <td className={className} data-line-number={line.line} style={style}>\n        <div className=\"source-line-code-inner\">\n          <pre ref={node => (this.codeNode = node)}>{renderedTokens}</pre>\n        </div>\n        {showIssues && issues.length > 0 && (\n          <LineIssuesList\n            branchLike={this.props.branchLike}\n            issuePopup={this.props.issuePopup}\n            issues={issues}\n            onIssueChange={this.props.onIssueChange}\n            onIssueClick={onIssueSelect}\n            onIssuePopupToggle={this.props.onIssuePopupToggle}\n            selectedIssue={selectedIssue}\n          />\n        )}\n        {selectedIssue && !showIssues && (\n          <LineIssuesList\n            branchLike={this.props.branchLike}\n            issuePopup={this.props.issuePopup}\n            issues={filteredSelectedIssues}\n            onIssueChange={this.props.onIssueChange}\n            onIssueClick={onIssueSelect}\n            onIssuePopupToggle={this.props.onIssuePopupToggle}\n            selectedIssue={selectedIssue}\n          />\n        )}\n      </td>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  line: T.SourceLine;\n}\n\nexport default function LineCoverage({ line }: Props) {\n  const className =\n    'source-meta source-line-coverage' +\n    (line.coverageStatus != null ? ` source-line-${line.coverageStatus}` : '');\n  return (\n    <td className={className} data-line-number={line.line}>\n      <Tooltip overlay={getStatusTooltip(line)} placement=\"right\">\n        <div className=\"source-line-bar\" />\n      </Tooltip>\n    </td>\n  );\n}\n\nfunction getStatusTooltip(line: T.SourceLine) {\n  if (line.coverageStatus === 'uncovered') {\n    if (line.conditions) {\n      return translateWithParameters('source_viewer.tooltip.uncovered.conditions', line.conditions);\n    } else {\n      return translate('source_viewer.tooltip.uncovered');\n    }\n  } else if (line.coverageStatus === 'covered') {\n    if (line.conditions) {\n      return translateWithParameters('source_viewer.tooltip.covered.conditions', line.conditions);\n    } else {\n      return translate('source_viewer.tooltip.covered');\n    }\n  } else if (line.coverageStatus === 'partially-covered') {\n    if (line.conditions) {\n      return translateWithParameters(\n        'source_viewer.tooltip.partially-covered.conditions',\n        line.coveredConditions || 0,\n        line.conditions\n      );\n    } else {\n      return translate('source_viewer.tooltip.partially-covered');\n    }\n  }\n  return undefined;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport Toggler from 'sonar-ui-common/components/controls/Toggler';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  duplicated: boolean;\n  index: number;\n  line: T.SourceLine;\n  onPopupToggle: (linePopup: T.LinePopup) => void;\n  popupOpen: boolean;\n  renderDuplicationPopup: (index: number, line: number) => React.ReactNode;\n}\n\nexport default class LineDuplicationBlock extends React.PureComponent<Props> {\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    event.currentTarget.blur();\n    this.props.onPopupToggle({\n      index: this.props.index,\n      line: this.props.line.line,\n      name: 'duplications'\n    });\n  };\n\n  handleTogglePopup = (open: boolean) => {\n    this.props.onPopupToggle({\n      index: this.props.index,\n      line: this.props.line.line,\n      name: 'duplications',\n      open\n    });\n  };\n\n  closePopup = () => {\n    this.handleTogglePopup(false);\n  };\n\n  render() {\n    const { duplicated, index, line, popupOpen } = this.props;\n    const className = classNames('source-meta', 'source-line-duplications-extra', {\n      'source-line-duplicated': duplicated\n    });\n\n    return duplicated ? (\n      <td className={className} data-index={index} data-line-number={line.line}>\n        <Toggler\n          onRequestClose={this.closePopup}\n          open={popupOpen}\n          overlay={this.props.renderDuplicationPopup(index, line.line)}>\n          <Tooltip\n            overlay={popupOpen ? undefined : translate('source_viewer.tooltip.duplicated_block')}\n            placement=\"right\">\n            <div\n              className=\"source-line-bar\"\n              onClick={this.handleClick}\n              role=\"button\"\n              tabIndex={0}\n            />\n          </Tooltip>\n        </Toggler>\n      </td>\n    ) : (\n      <td className={className} data-index={index} data-line-number={line.line}>\n        <div className=\"source-line-bar\" />\n      </td>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  line: T.SourceLine;\n  onClick: (line: T.SourceLine) => void;\n}\n\nexport default class LineDuplications extends React.PureComponent<Props> {\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    this.props.onClick(this.props.line);\n  };\n\n  render() {\n    const { line } = this.props;\n    const className = classNames('source-meta', 'source-line-duplications', {\n      'source-line-duplicated': line.duplicated\n    });\n\n    const cell = (\n      <td\n        className={className}\n        onClick={line.duplicated ? this.handleClick : undefined}\n        role={line.duplicated ? 'button' : undefined}\n        tabIndex={line.duplicated ? 0 : undefined}>\n        <div className=\"source-line-bar\" />\n      </td>\n    );\n\n    return line.duplicated ? (\n      <Tooltip overlay={translate('source_viewer.tooltip.duplicated_line')} placement=\"right\">\n        {cell}\n      </Tooltip>\n    ) : (\n      cell\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport IssueIcon from 'sonar-ui-common/components/icons/IssueIcon';\nimport { sortByType } from '../../../helpers/issues';\n\ninterface Props {\n  issues: T.Issue[];\n  line: T.SourceLine;\n  onClick: () => void;\n}\n\nexport default class LineIssuesIndicator extends React.PureComponent<Props> {\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    this.props.onClick();\n  };\n\n  render() {\n    const { issues, line } = this.props;\n    const hasIssues = issues.length > 0;\n    const className = classNames('source-meta', 'source-line-issues', {\n      'source-line-with-issues': hasIssues\n    });\n    const mostImportantIssue = hasIssues ? sortByType(issues)[0] : null;\n\n    return (\n      <td\n        className={className}\n        data-line-number={line.line}\n        onClick={hasIssues ? this.handleClick : undefined}\n        role={hasIssues ? 'button' : undefined}\n        tabIndex={hasIssues ? 0 : undefined}>\n        {mostImportantIssue != null && <IssueIcon type={mostImportantIssue.type} />}\n        {issues.length > 1 && <span className=\"source-line-issues-counter\">{issues.length}</span>}\n      </td>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { DropdownOverlay } from 'sonar-ui-common/components/controls/Dropdown';\nimport { PopupPlacement } from 'sonar-ui-common/components/ui/popups';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { getCodeUrl } from '../../../helpers/urls';\nimport { SourceViewerContext } from '../SourceViewerContext';\n\ninterface Props {\n  line: T.SourceLine;\n}\n\nexport default function LineOptionsPopup({ line }: Props) {\n  return (\n    <SourceViewerContext.Consumer>\n      {({ branchLike, file }) => (\n        <DropdownOverlay placement={PopupPlacement.RightTop}>\n          <div className=\"source-viewer-bubble-popup nowrap\">\n            <Link\n              className=\"js-get-permalink\"\n              onClick={event => {\n                event.stopPropagation();\n              }}\n              rel=\"noopener noreferrer\"\n              target=\"_blank\"\n              to={getCodeUrl(file.project, branchLike, file.key, line.line)}>\n              {translate('component_viewer.get_permalink')}\n            </Link>\n          </div>\n        </DropdownOverlay>\n      )}\n    </SourceViewerContext.Consumer>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Toggler from 'sonar-ui-common/components/controls/Toggler';\nimport LineOptionsPopup from './LineOptionsPopup';\n\ninterface Props {\n  line: T.SourceLine;\n  onPopupToggle: (linePopup: T.LinePopup) => void;\n  popupOpen: boolean;\n}\n\nexport default class LineNumber extends React.PureComponent<Props> {\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    event.currentTarget.blur();\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'line-number' });\n  };\n\n  handleTogglePopup = (open: boolean) => {\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'line-number', open });\n  };\n\n  closePopup = () => {\n    this.handleTogglePopup(false);\n  };\n\n  render() {\n    const { line, popupOpen } = this.props;\n    const { line: lineNumber } = line;\n    const hasLineNumber = !!lineNumber;\n    return hasLineNumber ? (\n      <td\n        className=\"source-meta source-line-number\"\n        data-line-number={lineNumber}\n        onClick={this.handleClick}\n        // eslint-disable-next-line jsx-a11y/no-noninteractive-element-to-interactive-role\n        role=\"button\"\n        tabIndex={0}>\n        <Toggler\n          onRequestClose={this.closePopup}\n          open={popupOpen}\n          overlay={<LineOptionsPopup line={line} />}\n        />\n      </td>\n    ) : (\n      <td className=\"source-meta source-line-number\" />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport { DropdownOverlay } from 'sonar-ui-common/components/controls/Dropdown';\nimport { PopupPlacement } from 'sonar-ui-common/components/ui/popups';\nimport DateFormatter from '../../intl/DateFormatter';\n\ninterface Props {\n  line: T.SourceLine;\n}\n\nexport default function SCMPopup({ line }: Props) {\n  const hasAuthor = line.scmAuthor !== '';\n  return (\n    <DropdownOverlay placement={PopupPlacement.RightTop}>\n      <div className=\"source-viewer-bubble-popup abs-width-400\">\n        {hasAuthor && <div>{line.scmAuthor}</div>}\n        {line.scmDate && (\n          <div className={classNames({ 'spacer-top': hasAuthor })}>\n            <DateFormatter date={line.scmDate} />\n          </div>\n        )}\n        {line.scmRevision && <div className=\"spacer-top\">{line.scmRevision}</div>}\n      </div>\n    </DropdownOverlay>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Toggler from 'sonar-ui-common/components/controls/Toggler';\nimport SCMPopup from './SCMPopup';\n\ninterface Props {\n  line: T.SourceLine;\n  onPopupToggle: (linePopup: T.LinePopup) => void;\n  popupOpen: boolean;\n  previousLine: T.SourceLine | undefined;\n}\n\nexport default class LineSCM extends React.PureComponent<Props> {\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    event.currentTarget.blur();\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'scm' });\n  };\n\n  handleTogglePopup = (open: boolean) => {\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'scm', open });\n  };\n\n  closePopup = () => {\n    this.handleTogglePopup(false);\n  };\n\n  render() {\n    const { line, popupOpen, previousLine } = this.props;\n    const hasPopup = !!line.line;\n    const cell = isSCMChanged(line, previousLine) && (\n      <div className=\"source-line-scm-inner\" data-author={line.scmAuthor || '…'} />\n    );\n    return hasPopup ? (\n      <td\n        className=\"source-meta source-line-scm\"\n        data-line-number={line.line}\n        onClick={this.handleClick}\n        // eslint-disable-next-line jsx-a11y/no-noninteractive-element-to-interactive-role\n        role=\"button\"\n        tabIndex={0}>\n        <Toggler\n          onRequestClose={this.closePopup}\n          open={popupOpen}\n          overlay={<SCMPopup line={line} />}>\n          {cell}\n        </Toggler>\n      </td>\n    ) : (\n      <td className=\"source-meta source-line-scm\" data-line-number={line.line}>\n        {cell}\n      </td>\n    );\n  }\n}\n\nfunction isSCMChanged(s: T.SourceLine, p: T.SourceLine | undefined) {\n  let changed = true;\n  if (p != null && s.scmRevision != null && p.scmRevision != null) {\n    changed = s.scmRevision !== p.scmRevision || s.scmDate !== p.scmDate;\n  }\n  return changed;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport { times } from 'lodash';\nimport * as React from 'react';\nimport './Line.css';\nimport LineCode from './LineCode';\nimport LineCoverage from './LineCoverage';\nimport LineDuplicationBlock from './LineDuplicationBlock';\nimport LineDuplications from './LineDuplications';\nimport LineIssuesIndicator from './LineIssuesIndicator';\nimport LineNumber from './LineNumber';\nimport LineSCM from './LineSCM';\n\ninterface Props {\n  branchLike: T.BranchLike | undefined;\n  displayAllIssues?: boolean;\n  displayCoverage: boolean;\n  displayDuplications: boolean;\n  displayIssues: boolean;\n  displayLocationMarkers?: boolean;\n  duplications: number[];\n  duplicationsCount: number;\n  highlighted: boolean;\n  highlightedLocationMessage: { index: number; text: string | undefined } | undefined;\n  highlightedSymbols: string[] | undefined;\n  issueLocations: T.LinearIssueLocation[];\n  issuePopup: { issue: string; name: string } | undefined;\n  issues: T.Issue[];\n  last: boolean;\n  line: T.SourceLine;\n  linePopup: T.LinePopup | undefined;\n  loadDuplications: (line: T.SourceLine) => void;\n  onLinePopupToggle: (linePopup: T.LinePopup) => void;\n  onIssueChange: (issue: T.Issue) => void;\n  onIssuePopupToggle: (issueKey: string, popupName: string, open?: boolean) => void;\n  onIssuesClose: (line: T.SourceLine) => void;\n  onIssueSelect: (issueKey: string) => void;\n  onIssuesOpen: (line: T.SourceLine) => void;\n  onIssueUnselect: () => void;\n  onLocationSelect: ((x: number) => void) | undefined;\n  onSymbolClick: (symbols: string[]) => void;\n  openIssues: boolean;\n  previousLine: T.SourceLine | undefined;\n  renderDuplicationPopup: (index: number, line: number) => React.ReactNode;\n  scroll?: (element: HTMLElement) => void;\n  secondaryIssueLocations: T.LinearIssueLocation[];\n  selectedIssue: string | undefined;\n  verticalBuffer?: number;\n}\n\nconst LINE_HEIGHT = 18;\n\nexport default class Line extends React.PureComponent<Props> {\n  isPopupOpen = (name: string, index?: number) => {\n    const { line, linePopup } = this.props;\n    return (\n      linePopup !== undefined &&\n      linePopup.index === index &&\n      linePopup.line === line.line &&\n      linePopup.name === name\n    );\n  };\n\n  handleIssuesIndicatorClick = () => {\n    if (this.props.openIssues) {\n      this.props.onIssuesClose(this.props.line);\n      this.props.onIssueUnselect();\n    } else {\n      this.props.onIssuesOpen(this.props.line);\n\n      const { issues } = this.props;\n      if (issues.length > 0) {\n        this.props.onIssueSelect(issues[0].key);\n      }\n    }\n  };\n\n  render() {\n    const { displayCoverage, duplications, duplicationsCount, issuePopup, line } = this.props;\n    const className = classNames('source-line', {\n      'source-line-highlighted': this.props.highlighted,\n      'source-line-filtered': line.isNew,\n      'source-line-filtered-dark':\n        displayCoverage &&\n        (line.coverageStatus === 'uncovered' || line.coverageStatus === 'partially-covered'),\n      'source-line-last': this.props.last === true\n    });\n\n    const bottomPadding = this.props.verticalBuffer\n      ? this.props.verticalBuffer * LINE_HEIGHT\n      : undefined;\n\n    return (\n      <tr className={className} data-line-number={line.line}>\n        <LineNumber\n          line={line}\n          onPopupToggle={this.props.onLinePopupToggle}\n          popupOpen={this.isPopupOpen('line-number')}\n        />\n\n        <LineSCM\n          line={line}\n          onPopupToggle={this.props.onLinePopupToggle}\n          popupOpen={this.isPopupOpen('scm')}\n          previousLine={this.props.previousLine}\n        />\n\n        {this.props.displayIssues && !this.props.displayAllIssues ? (\n          <LineIssuesIndicator\n            issues={this.props.issues}\n            line={line}\n            onClick={this.handleIssuesIndicatorClick}\n          />\n        ) : (\n          <td className=\"source-meta source-line-issues\" />\n        )}\n\n        {this.props.displayDuplications && (\n          <LineDuplications line={line} onClick={this.props.loadDuplications} />\n        )}\n\n        {times(duplicationsCount, index => (\n          <LineDuplicationBlock\n            duplicated={duplications.includes(index)}\n            index={index}\n            key={index}\n            line={this.props.line}\n            onPopupToggle={this.props.onLinePopupToggle}\n            popupOpen={this.isPopupOpen('duplications', index)}\n            renderDuplicationPopup={this.props.renderDuplicationPopup}\n          />\n        ))}\n\n        {this.props.displayCoverage && <LineCoverage line={line} />}\n\n        <LineCode\n          branchLike={this.props.branchLike}\n          displayLocationMarkers={this.props.displayLocationMarkers}\n          highlightedLocationMessage={this.props.highlightedLocationMessage}\n          highlightedSymbols={this.props.highlightedSymbols}\n          issueLocations={this.props.issueLocations}\n          issuePopup={issuePopup}\n          issues={this.props.issues}\n          line={line}\n          onIssueChange={this.props.onIssueChange}\n          onIssuePopupToggle={this.props.onIssuePopupToggle}\n          onIssueSelect={this.props.onIssueSelect}\n          onLocationSelect={this.props.onLocationSelect}\n          onSymbolClick={this.props.onSymbolClick}\n          padding={bottomPadding}\n          scroll={this.props.scroll}\n          secondaryIssueLocations={this.props.secondaryIssueLocations}\n          selectedIssue={this.props.selectedIssue}\n          showIssues={this.props.openIssues || this.props.displayAllIssues}\n        />\n      </tr>\n    );\n  }\n}\n","\nvar content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../../node_modules/postcss-loader/src/index.js??postcss!./Line.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../../node_modules/postcss-loader/src/index.js??postcss!./Line.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../../node_modules/postcss-loader/src/index.js??postcss!./Line.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \".source-line:hover .source-line-coverage,.source-line:hover .source-line-duplications,.source-line:hover .source-line-duplications-extra,.source-line:hover .source-line-issues,.source-line:hover .source-line-number,.source-line:hover .source-line-scm{border-color:#e9e9e9;background-color:#e9e9e9}.source-line:hover .source-line-code{background-color:#f5f5f5}.source-line-highlighted .source-line-coverage,.source-line-highlighted .source-line-duplications,.source-line-highlighted .source-line-duplications-extra,.source-line-highlighted .source-line-issues,.source-line-highlighted .source-line-number,.source-line-highlighted .source-line-scm,.source-line-highlighted:hover .source-line-coverage,.source-line-highlighted:hover .source-line-duplications,.source-line-highlighted:hover .source-line-duplications-extra,.source-line-highlighted:hover .source-line-issues,.source-line-highlighted:hover .source-line-number,.source-line-highlighted:hover .source-line-scm{border-color:#c4dfec!important;background-color:#c4dfec}.source-line-highlighted .source-line-code,.source-line-highlighted:hover .source-line-code{background-color:#d9edf7}.source-line-filtered .source-line-code{background-color:#fbf3d5!important}.source-line-filtered.source-line-highlighted .source-line-code,.source-line-filtered.source-line-highlighted:hover .source-line-code{background-color:#cdd9c4!important}.source-line-filtered:hover .source-line-code{background-color:#f1e8cb!important}.source-line-filtered.source-line-filtered-dark .source-line-code{background-color:#f9ebb7!important}.source-line-filtered.source-line-filtered-dark:hover .source-line-code{background-color:#eaddb2!important}.source-line-last .source-line-code{padding-bottom:160px}.source-viewer pre{height:18px;padding:0}.source-line-number,.source-line-scm,.source-viewer pre{line-height:18px;font-family:Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px}.source-line-code{position:relative;padding:0 10px}.source-line-code pre{float:left}.source-line-code .issue-list{margin-left:-10px;margin-right:-10px}.source-line-code-inner{min-height:18px}.source-line-code-inner:after,.source-line-code-inner:before{display:table;content:\\\"\\\";line-height:0}.source-line-code-inner:after{clear:both}.source-line-code-issue{display:inline-block;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAGCAYAAAAPDoR2AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1M0M2Rjk4M0M3QUYxMUUzODkzRUREMUM5OTNDMjY4QSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo1M0M2Rjk4NEM3QUYxMUUzODkzRUREMUM5OTNDMjY4QSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjUzQzZGOTgxQzdBRjExRTM4OTNFREQxQzk5M0MyNjhBIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjUzQzZGOTgyQzdBRjExRTM4OTNFREQxQzk5M0MyNjhBIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+bcqJtQAAAEhJREFUeNpi+G+swwDGDAwgbAWlwZiJAQFCgfgwEIfDRaC67ID4NRDnQ2kQnwFZwgFqnANMAQOUYY9sF0wBiCGH5CBkrAgQYACuWi4sSGW8yAAAAABJRU5ErkJggg==);background-repeat:repeat-x;background-size:4px;background-position:bottom}.source-meta{position:relative;vertical-align:top;width:1px;background-clip:padding-box;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.source-meta:focus{outline:none}.source-meta[role=button]{cursor:pointer}.source-meta+.source-meta{border-left:1px solid #f3f3f3}.source-line-number{min-width:18px;padding:0 10px;background-color:#f3f3f3;color:#777;text-align:right}.source-line-number:before{content:attr(data-line-number)}.source-line-issues{position:relative;padding:0 2px;background-color:#f3f3f3;white-space:nowrap}.source-line-with-issues{padding-right:4px}.source-line-issues-counter{position:absolute;left:17px;line-height:8px;font-size:8px;z-index:900}.source-line-coverage,.source-line-duplications,.source-line-duplications-extra{background-color:#f3f3f3}.source-duplications-expanded .source-line-duplications,.source-line-duplications-extra{display:none}.source-duplications-expanded .source-line-duplications-extra{display:table-cell}.source-line-scm{padding:0 5px;background-color:#f3f3f3}.source-line-scm-inner{max-width:40px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.source-line-scm-inner:before{content:attr(data-author)}.source-line-bar{width:5px;height:18px}.source-line-bar[role=button]{cursor:pointer}.source-line-bar:focus{outline:none}.source-line-covered{background-color:#b4dd78!important}.source-line-partially-covered,.source-line-uncovered{background-color:#a4030f!important}.source-line-partially-covered{background-image:repeating-linear-gradient(45deg,hsla(0,0%,100%,.5) 4px,transparent 0,transparent 8px,hsla(0,0%,100%,.5) 0,hsla(0,0%,100%,.5) 12px,transparent 0,transparent 16px,hsla(0,0%,100%,.5) 0,hsla(0,0%,100%,.5) 20px)!important}.source-line-duplicated{background-color:#797979!important}\", \"\"]);\n\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./SourceViewerHeaderSlim.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./SourceViewerHeaderSlim.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./SourceViewerHeaderSlim.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \".source-viewer-header-slim{padding:4px 10px;border-bottom:1px solid #cdcdcd;background-color:#f3f3f3;align-items:center;min-height:25px}\", \"\"]);\n\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { getJSON, post } from 'sonar-ui-common/helpers/request';\n\nexport function getFavorites(): Promise<any> {\n  return getJSON('/api/favorites/search');\n}\n\nexport function addFavorite(component: string): Promise<void> {\n  return post('/api/favorites/add', { component });\n}\n\nexport function removeFavorite(component: string): Promise<void> {\n  return post('/api/favorites/remove', { component });\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport FavoriteButton from 'sonar-ui-common/components/controls/FavoriteButton';\nimport { addFavorite, removeFavorite } from '../../api/favorites';\n\ninterface Props {\n  className?: string;\n  component: string;\n  favorite: boolean;\n  qualifier: string;\n  handleFavorite?: (component: string, isFavorite: boolean) => void;\n}\n\ninterface State {\n  favorite: boolean;\n}\n\nexport default class Favorite extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n\n    this.state = {\n      favorite: props.favorite\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentDidUpdate(_prevProps: Props, prevState: State) {\n    if (prevState.favorite !== this.props.favorite) {\n      this.setState({ favorite: this.props.favorite });\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  toggleFavorite = () => {\n    const newFavorite = !this.state.favorite;\n    const apiMethod = newFavorite ? addFavorite : removeFavorite;\n\n    return apiMethod(this.props.component).then(() => {\n      if (this.mounted) {\n        this.setState({ favorite: newFavorite }, () => {\n          if (this.props.handleFavorite) {\n            this.props.handleFavorite(this.props.component, newFavorite);\n          }\n        });\n      }\n    });\n  };\n\n  render() {\n    const { className, qualifier } = this.props;\n    const { favorite } = this.state;\n\n    return (\n      <FavoriteButton\n        className={className}\n        favorite={favorite}\n        qualifier={qualifier}\n        toggleFavorite={this.toggleFavorite}\n      />\n    );\n  }\n}\n/*  */\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { flatten } from 'lodash';\nimport { splitByTokens } from './highlight';\nimport { getLinearLocations } from './issueLocations';\n\nexport function issuesByLine(issues: T.Issue[]) {\n  const index: { [line: number]: T.Issue[] } = {};\n  issues.forEach(issue => {\n    const line = issue.textRange ? issue.textRange.endLine : 0;\n    if (!(line in index)) {\n      index[line] = [];\n    }\n    index[line].push(issue);\n  });\n  return index;\n}\n\nexport function issuesByComponentAndLine(\n  issues: T.Issue[] = []\n): { [component: string]: { [line: number]: T.Issue[] } } {\n  return issues.reduce((mapping: { [component: string]: { [line: number]: T.Issue[] } }, issue) => {\n    mapping[issue.component] = mapping[issue.component] || {};\n    const line = issue.textRange ? issue.textRange.endLine : 0;\n    mapping[issue.component][line] = mapping[issue.component][line] || [];\n    mapping[issue.component][line].push(issue);\n    return mapping;\n  }, {});\n}\n\nexport function locationsByLine(issues: T.Issue[]) {\n  const index: { [line: number]: T.LinearIssueLocation[] } = {};\n  issues.forEach(issue => {\n    getLinearLocations(issue.textRange).forEach(location => {\n      if (!(location.line in index)) {\n        index[location.line] = [];\n      }\n      index[location.line].push(location);\n    });\n  });\n  return index;\n}\n\nexport function duplicationsByLine(duplications: T.Duplication[] | undefined) {\n  if (duplications == null) {\n    return {};\n  }\n\n  const duplicationsByLine: { [line: number]: number[] } = {};\n\n  duplications.forEach(({ blocks }, duplicationIndex) => {\n    blocks.forEach(block => {\n      // eslint-disable-next-line no-underscore-dangle\n      if (block._ref === '1') {\n        for (let line = block.from; line < block.from + block.size; line++) {\n          if (!(line in duplicationsByLine)) {\n            duplicationsByLine[line] = [];\n          }\n          duplicationsByLine[line].push(duplicationIndex);\n        }\n      }\n    });\n  });\n\n  return duplicationsByLine;\n}\n\nexport function symbolsByLine(sources: T.SourceLine[]) {\n  const index: { [line: number]: string[] } = {};\n  sources.forEach(line => {\n    const tokens = splitByTokens(line.code || '');\n    const symbols = flatten(\n      tokens.map(token => {\n        const keys = token.className.match(/sym-\\d+/g);\n        return keys != null ? keys : [];\n      })\n    );\n    index[line.line] = symbols.filter(key => key);\n  });\n  return index;\n}\n"],"sourceRoot":""}