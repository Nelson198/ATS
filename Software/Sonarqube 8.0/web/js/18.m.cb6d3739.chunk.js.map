{"version":3,"sources":["webpack:///./src/main/js/apps/permission-templates/utils.ts","webpack:///./src/main/js/apps/permission-templates/components/Form.tsx","webpack:///./src/main/js/apps/permission-templates/components/Header.tsx","webpack:///./src/main/js/apps/permission-templates/components/ListHeader.tsx","webpack:///./src/main/js/apps/permission-templates/components/DeleteForm.tsx","webpack:///./src/main/js/apps/permission-templates/components/ActionsCell.tsx","webpack:///./src/main/js/apps/permission-templates/components/Defaults.tsx","webpack:///./src/main/js/apps/permission-templates/components/NameCell.tsx","webpack:///./src/main/js/apps/permission-templates/components/PermissionCell.tsx","webpack:///./src/main/js/apps/permission-templates/components/ListItem.tsx","webpack:///./src/main/js/apps/permission-templates/components/List.tsx","webpack:///./src/main/js/apps/permission-templates/components/Home.tsx","webpack:///./src/main/js/apps/permission-templates/components/TemplateDetails.tsx","webpack:///./src/main/js/apps/permission-templates/components/TemplateHeader.tsx","webpack:///./src/main/js/apps/permission-templates/components/Template.tsx","webpack:///./src/main/js/apps/permission-templates/components/App.tsx","webpack:///./src/main/js/app/components/embed-docs-modal/Suggestions.tsx","webpack:///./src/main/js/apps/permissions/utils.ts","webpack:///./src/main/js/api/permissions.ts","webpack:///./src/main/js/components/common/OrganizationHelmet.tsx","webpack:///./src/main/js/apps/permissions/styles.css?86ec","webpack:///./src/main/js/apps/permissions/styles.css","webpack:///./src/main/js/apps/permissions/shared/components/SearchForm.tsx","webpack:///./src/main/js/apps/permissions/shared/components/PermissionCell.tsx","webpack:///./src/main/js/apps/permissions/shared/components/GroupHolder.tsx","webpack:///./src/main/js/apps/permissions/shared/components/PermissionHeader.tsx","webpack:///./src/main/js/apps/permissions/shared/components/UserHolder.tsx","webpack:///./src/main/js/apps/permissions/shared/components/HoldersList.tsx"],"names":["PERMISSIONS_ORDER","Form_Form","index_js_exposed","[object Object]","props","super","this","mounted","handleSubmit","onSubmit","description","state","name","projectKeyPattern","then","onClose","handleNameChange","event","setState","currentTarget","value","handleDescriptionChange","handleProjectKeyPatternChange","permissionTemplate","SimpleModal_default","a","header","size","_ref","onCloseClick","onFormSubmit","submitting","id","className","htmlFor","Object","l10n","autoFocus","maxLength","onChange","required","type","DeferredSpinner_default","loading","buttons","disabled","confirmButtonText","onClick","components_Header","withRouter","createModal","handleCreateClick","handleCreateModalClose","handleCreateModalSubmit","data","organization","key","api_permissions","assign","response","refresh","pathname","concat","router","push","query","ready","ListHeader_ListHeader","permission","InstanceMessage","message","Alert","variant","cells","permissions","map","HelpTooltip_default","overlay","renderTooltip","DeleteForm","t","_ref2","components_ActionsCell","deleteForm","updateModal","handleUpdateClick","handleCloseUpdateModal","handleSubmitUpdateModal","handleDeleteClick","handleCloseDeleteForm","handleDeleteSubmit","templateId","replace","setDefault","qualifier","topQualifiers","isDefault","difference_default","defaultFor","availableQualifiers","getAvailableQualifiers","length","renderIfSingleTopQualifier","renderIfMultipleTopQualifiers","child","ActionsDropdown","data-qualifier","renderSetDefaultLink","QualifierIcon_default","_this$props","ActionsDropdown_default","renderSetDefaultsControl","fromDetails","to","destructive","Defaults","template","qualifiersToDisplay","qualifiers","sortBy_default","join","NameCell","react_router_es","PermissionCell","p","data-permission","withProjectCreator","system","usersCount","groupsCount","ListItem","data-id","data-name","List","permissionTemplates","Home","Helmet_default","title","TemplateDetails","TemplateHeader","Template_Template","filter","groups","users","requestHolders","realQuery","_this$state","selectedPermission","requests","finalQuery","Promise","resolve","all","responses","handleToggleUser","user","login","handleToggleProjectCreator","hasPermission","includes","handleToggleGroup","group","_this$props2","groupName","handleSearch","handleFilter","handleSelectPermission","undefined","shouldDisplayCreator","creatorPermissions","_this$state2","CREATOR_NAME","isFiltered","matchQuery","toLocaleLowerCase","toLowerCase","matchPermission","utils","allUsers","creator","unshift","HoldersList","onSelectPermission","onToggleGroup","onToggleUser","showPublicProjectsWarning","SearchForm","onFilter","onSearch","__webpack_require__","d","__webpack_exports__","App_App","requestPermissions","r","indexOf","sortPermissions","defaultTemplates","arguments","forEach","defaultTemplate","mergeDefaultsToTemplates","basePermissions","basePermission","projectPermission","find","mergePermissionsToTemplates","location","Suggestions","suggestions","OrganizationHelmet","renderTemplate","renderHome","es","rootReducer","react__WEBPACK_IMPORTED_MODULE_0__","_SuggestionsContext__WEBPACK_IMPORTED_MODULE_1__","Consumer","addSuggestions","removeSuggestions","SuggestionsInner","prevProps","PERMISSIONS_ORDER_FOR_PROJECT_TEMPLATE","PERMISSIONS_ORDER_GLOBAL","PERMISSIONS_ORDER_GLOBAL_GOV","PERMISSIONS_ORDER_BY_QUALIFIER","convertToPermissionDefinitions","isPermissionDefinitionGroup","sonar_ui_common_helpers_l10n__WEBPACK_IMPORTED_MODULE_0__","_helpers_system__WEBPACK_IMPORTED_MODULE_1__","category","PERMISSIONS_ORDER_FOR_VIEW","TRK","VW","SVW","APP","DEV","convertToPermissionDefinition","l10nPrefix","getMessage","messageKey","cloudMessageKey","Boolean","grantPermissionToUser","revokePermissionFromUser","grantPermissionToGroup","revokePermissionFromGroup","getPermissionTemplates","createPermissionTemplate","updatePermissionTemplate","deletePermissionTemplate","setDefaultPermissionTemplate","applyTemplateToProject","bulkApplyTemplate","grantTemplatePermissionToUser","revokeTemplatePermissionFromUser","grantTemplatePermissionToGroup","revokeTemplatePermissionFromGroup","addProjectCreatorToTemplate","removeProjectCreatorFromTemplate","getPermissionsUsersForComponent","getPermissionsGroupsForComponent","getGlobalPermissionsUsers","getGlobalPermissionsGroups","getPermissionTemplateUsers","getPermissionTemplateGroups","changeProjectVisibility","changeProjectDefaultVisibility","sonar_ui_common_helpers_request__WEBPACK_IMPORTED_MODULE_0__","_app_utils_throwGlobalError__WEBPACK_IMPORTED_MODULE_1__","PAGE_SIZE","catch","url","ps","q","project","visibility","projectVisibility","react_helmet__WEBPACK_IMPORTED_MODULE_1__","react_helmet__WEBPACK_IMPORTED_MODULE_1___default","n","defaultTitle","titleTemplate","content","module","i","options","hmr","transform","insertInto","locals","exports","sonar_ui_common_components_controls_RadioToggle__WEBPACK_IMPORTED_MODULE_1__","sonar_ui_common_components_controls_RadioToggle__WEBPACK_IMPORTED_MODULE_1___default","sonar_ui_common_components_controls_SearchBox__WEBPACK_IMPORTED_MODULE_2__","sonar_ui_common_components_controls_SearchBox__WEBPACK_IMPORTED_MODULE_2___default","sonar_ui_common_helpers_l10n__WEBPACK_IMPORTED_MODULE_3__","filterOptions","label","onCheck","minLength","placeholder","PermissionCell_PermissionCell","permissionItem","Checkbox_default","checked","classnames","selected","GroupHolder_GroupHolder","stopLoading","without_default","handleCheck","_checked","onToggle","GroupIcon_default","style","whiteSpace","PermissionHeader_PermissionHeader","handlePermissionClick","preventDefault","blur","getTooltipOverlay","Tooltip_default","href","UserHolder_UserHolder","permissionCells","Avatar","hash","avatar","email","HoldersList_HoldersList","initialPermissionsCount","handleGroupToggle","handleUserToggle","getItemInitialPermissionsCount","item","isPermissionUser","columns","colSpan","items","_partition3","_slicedToArray","partition_default","itemWithPermissions","itemWithoutPermissions","children","renderEmpty","renderItem"],"mappings":"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","file":"js/18.m.cb6d3739.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { sortBy } from 'lodash';\n\nexport const PERMISSIONS_ORDER = [\n  'user',\n  'codeviewer',\n  'issueadmin',\n  'securityhotspotadmin',\n  'admin',\n  'scan'\n];\n\nexport function sortPermissions(permissions: T.Permission[]) {\n  return sortBy(permissions, p => PERMISSIONS_ORDER.indexOf(p.key));\n}\n\nexport function mergePermissionsToTemplates(\n  permissionTemplates: T.PermissionTemplate[],\n  basePermissions: T.Permission[]\n): T.PermissionTemplate[] {\n  return permissionTemplates.map(permissionTemplate => {\n    // it's important to keep the order of the permission template's permissions\n    // the same as the order of base permissions\n    const permissions = basePermissions.map(basePermission => {\n      const projectPermission = permissionTemplate.permissions.find(\n        p => p.key === basePermission.key\n      );\n      return { usersCount: 0, groupsCount: 0, ...basePermission, ...projectPermission };\n    });\n\n    return { ...permissionTemplate, permissions };\n  });\n}\n\nexport function mergeDefaultsToTemplates(\n  permissionTemplates: T.PermissionTemplate[],\n  defaultTemplates: Array<{ templateId: string; qualifier: string }> = []\n): T.PermissionTemplate[] {\n  return permissionTemplates.map(permissionTemplate => {\n    const defaultFor: string[] = [];\n\n    defaultTemplates.forEach(defaultTemplate => {\n      if (defaultTemplate.templateId === permissionTemplate.id) {\n        defaultFor.push(defaultTemplate.qualifier);\n      }\n    });\n\n    return { ...permissionTemplate, defaultFor };\n  });\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { ResetButtonLink, SubmitButton } from 'sonar-ui-common/components/controls/buttons';\nimport SimpleModal from 'sonar-ui-common/components/controls/SimpleModal';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  confirmButtonText: string;\n  header: string;\n  onClose: () => void;\n  onSubmit: (data: {\n    description: string;\n    name: string;\n    projectKeyPattern: string;\n  }) => Promise<void>;\n  permissionTemplate?: { description?: string; name: string; projectKeyPattern?: string };\n}\n\ninterface State {\n  description: string;\n  name: string;\n  projectKeyPattern: string;\n}\n\nexport default class Form extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      description: (props.permissionTemplate && props.permissionTemplate.description) || '',\n      name: (props.permissionTemplate && props.permissionTemplate.name) || '',\n      projectKeyPattern:\n        (props.permissionTemplate && props.permissionTemplate.projectKeyPattern) || ''\n    };\n  }\n\n  handleSubmit = () => {\n    return this.props\n      .onSubmit({\n        description: this.state.description,\n        name: this.state.name,\n        projectKeyPattern: this.state.projectKeyPattern\n      })\n      .then(this.props.onClose);\n  };\n\n  handleNameChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({ name: event.currentTarget.value });\n  };\n\n  handleDescriptionChange = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    this.setState({ description: event.currentTarget.value });\n  };\n\n  handleProjectKeyPatternChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({ projectKeyPattern: event.currentTarget.value });\n  };\n\n  render() {\n    return (\n      <SimpleModal\n        header={this.props.header}\n        onClose={this.props.onClose}\n        onSubmit={this.handleSubmit}\n        size=\"small\">\n        {({ onCloseClick, onFormSubmit, submitting }) => (\n          <form id=\"permission-template-form\" onSubmit={onFormSubmit}>\n            <header className=\"modal-head\">\n              <h2>{this.props.header}</h2>\n            </header>\n\n            <div className=\"modal-body\">\n              <div className=\"modal-field\">\n                <label htmlFor=\"permission-template-name\">\n                  {translate('name')}\n                  <em className=\"mandatory\">*</em>\n                </label>\n                <input\n                  autoFocus={true}\n                  id=\"permission-template-name\"\n                  maxLength={256}\n                  name=\"name\"\n                  onChange={this.handleNameChange}\n                  required={true}\n                  type=\"text\"\n                  value={this.state.name}\n                />\n                <div className=\"modal-field-description\">{translate('should_be_unique')}</div>\n              </div>\n\n              <div className=\"modal-field\">\n                <label htmlFor=\"permission-template-description\">{translate('description')}</label>\n                <textarea\n                  id=\"permission-template-description\"\n                  name=\"description\"\n                  onChange={this.handleDescriptionChange}\n                  value={this.state.description}\n                />\n              </div>\n\n              <div className=\"modal-field\">\n                <label htmlFor=\"permission-template-project-key-pattern\">\n                  {translate('permission_template.key_pattern')}\n                </label>\n                <input\n                  id=\"permission-template-project-key-pattern\"\n                  maxLength={500}\n                  name=\"projectKeyPattern\"\n                  onChange={this.handleProjectKeyPatternChange}\n                  type=\"text\"\n                  value={this.state.projectKeyPattern}\n                />\n                <div className=\"modal-field-description\">\n                  {translate('permission_template.key_pattern.description')}\n                </div>\n              </div>\n            </div>\n\n            <footer className=\"modal-foot\">\n              <DeferredSpinner className=\"spacer-right\" loading={submitting} />\n              <SubmitButton disabled={submitting} id=\"permission-template-submit\">\n                {this.props.confirmButtonText}\n              </SubmitButton>\n              <ResetButtonLink\n                disabled={submitting}\n                id=\"permission-template-cancel\"\n                onClick={onCloseClick}>\n                {translate('cancel')}\n              </ResetButtonLink>\n            </footer>\n          </form>\n        )}\n      </SimpleModal>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { createPermissionTemplate } from '../../../api/permissions';\nimport { Router, withRouter } from '../../../components/hoc/withRouter';\nimport Form from './Form';\n\ninterface Props {\n  organization?: { key: string };\n  ready?: boolean;\n  refresh: () => Promise<void>;\n  router: Pick<Router, 'push'>;\n}\n\ninterface State {\n  createModal: boolean;\n}\n\nclass Header extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { createModal: false };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleCreateClick = () => {\n    this.setState({ createModal: true });\n  };\n\n  handleCreateModalClose = () => {\n    if (this.mounted) {\n      this.setState({ createModal: false });\n    }\n  };\n\n  handleCreateModalSubmit = (data: {\n    description: string;\n    name: string;\n    projectKeyPattern: string;\n  }) => {\n    const organization = this.props.organization && this.props.organization.key;\n    return createPermissionTemplate({ ...data, organization }).then(response => {\n      this.props.refresh().then(() => {\n        const pathname = organization\n          ? `/organizations/${organization}/permission_templates`\n          : '/permission_templates';\n        this.props.router.push({ pathname, query: { id: response.permissionTemplate.id } });\n      });\n    });\n  };\n\n  render() {\n    return (\n      <header className=\"page-header\" id=\"project-permissions-header\">\n        <h1 className=\"page-title\">{translate('permission_templates.page')}</h1>\n\n        {!this.props.ready && <i className=\"spinner\" />}\n\n        <div className=\"page-actions\">\n          <Button onClick={this.handleCreateClick}>{translate('create')}</Button>\n\n          {this.state.createModal && (\n            <Form\n              confirmButtonText={translate('create')}\n              header={translate('permission_template.new_template')}\n              onClose={this.handleCreateModalClose}\n              onSubmit={this.handleCreateModalSubmit}\n            />\n          )}\n        </div>\n\n        <p className=\"page-description\">{translate('permission_templates.page.description')}</p>\n      </header>\n    );\n  }\n}\n\nexport default withRouter(Header);\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport HelpTooltip from 'sonar-ui-common/components/controls/HelpTooltip';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport InstanceMessage from '../../../components/common/InstanceMessage';\n\ninterface Props {\n  organization: T.Organization | undefined;\n  permissions: T.Permission[];\n}\n\nexport default class ListHeader extends React.PureComponent<Props> {\n  renderTooltip(permission: T.Permission) {\n    return permission.key === 'user' || permission.key === 'codeviewer' ? (\n      <div>\n        <InstanceMessage message={translate('projects_role', permission.key, 'desc')} />\n        <Alert className=\"spacer-top\" variant=\"warning\">\n          {translate('projects_role.public_projects_warning')}\n        </Alert>\n      </div>\n    ) : (\n      <InstanceMessage message={translate('projects_role', permission.key, 'desc')} />\n    );\n  }\n\n  render() {\n    const cells = this.props.permissions.map(permission => (\n      <th className=\"permission-column\" key={permission.key}>\n        <div className=\"permission-column-inner\">\n          <span className=\"text-middle\">{translate('projects_role', permission.key)}</span>\n          <HelpTooltip className=\"spacer-left\" overlay={this.renderTooltip(permission)} />\n        </div>\n      </th>\n    ));\n\n    return (\n      <thead>\n        <tr>\n          <th>&nbsp;</th>\n          {cells}\n          <th className=\"thin nowrap text-right\">&nbsp;</th>\n        </tr>\n      </thead>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { ResetButtonLink, SubmitButton } from 'sonar-ui-common/components/controls/buttons';\nimport SimpleModal from 'sonar-ui-common/components/controls/SimpleModal';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  onClose: () => void;\n  onSubmit: () => Promise<void>;\n  permissionTemplate: T.PermissionTemplate;\n}\n\nexport default function DeleteForm({ onClose, onSubmit, permissionTemplate: t }: Props) {\n  const header = translate('permission_template.delete_confirm_title');\n\n  return (\n    <SimpleModal header={header} onClose={onClose} onSubmit={onSubmit}>\n      {({ onCloseClick, onFormSubmit, submitting }) => (\n        <form onSubmit={onFormSubmit}>\n          <header className=\"modal-head\">\n            <h2>{header}</h2>\n          </header>\n\n          <div className=\"modal-body\">\n            {translateWithParameters(\n              'permission_template.do_you_want_to_delete_template_xxx',\n              t.name\n            )}\n          </div>\n\n          <footer className=\"modal-foot\">\n            <DeferredSpinner className=\"spacer-right\" loading={submitting} />\n            <SubmitButton className=\"button-red\" disabled={submitting}>\n              {translate('delete')}\n            </SubmitButton>\n            <ResetButtonLink disabled={submitting} onClick={onCloseClick}>\n              {translate('cancel')}\n            </ResetButtonLink>\n          </footer>\n        </form>\n      )}\n    </SimpleModal>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { difference } from 'lodash';\nimport * as React from 'react';\nimport ActionsDropdown, {\n  ActionsDropdownItem\n} from 'sonar-ui-common/components/controls/ActionsDropdown';\nimport QualifierIcon from 'sonar-ui-common/components/icons/QualifierIcon';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport {\n  deletePermissionTemplate,\n  setDefaultPermissionTemplate,\n  updatePermissionTemplate\n} from '../../../api/permissions';\nimport { Router, withRouter } from '../../../components/hoc/withRouter';\nimport DeleteForm from './DeleteForm';\nimport Form from './Form';\n\ninterface Props {\n  fromDetails?: boolean;\n  organization?: { isDefault?: boolean; key: string };\n  permissionTemplate: T.PermissionTemplate;\n  refresh: () => void;\n  router: Pick<Router, 'replace'>;\n  topQualifiers: string[];\n}\n\ninterface State {\n  deleteForm: boolean;\n  updateModal: boolean;\n}\n\nexport class ActionsCell extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { deleteForm: false, updateModal: false };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleUpdateClick = () => {\n    this.setState({ updateModal: true });\n  };\n\n  handleCloseUpdateModal = () => {\n    if (this.mounted) {\n      this.setState({ updateModal: false });\n    }\n  };\n\n  handleSubmitUpdateModal = (data: {\n    description: string;\n    name: string;\n    projectKeyPattern: string;\n  }) => {\n    return updatePermissionTemplate({ id: this.props.permissionTemplate.id, ...data }).then(\n      this.props.refresh\n    );\n  };\n\n  handleDeleteClick = () => {\n    this.setState({ deleteForm: true });\n  };\n\n  handleCloseDeleteForm = () => {\n    if (this.mounted) {\n      this.setState({ deleteForm: false });\n    }\n  };\n\n  handleDeleteSubmit = () => {\n    return deletePermissionTemplate({ templateId: this.props.permissionTemplate.id }).then(() => {\n      const pathname = this.props.organization\n        ? `/organizations/${this.props.organization.key}/permission_templates`\n        : '/permission_templates';\n      this.props.router.replace(pathname);\n      this.props.refresh();\n    });\n  };\n\n  setDefault = (qualifier: string) => () => {\n    setDefaultPermissionTemplate(this.props.permissionTemplate.id, qualifier).then(\n      this.props.refresh,\n      () => {}\n    );\n  };\n\n  getAvailableQualifiers() {\n    const topQualifiers =\n      this.props.organization && !this.props.organization.isDefault\n        ? ['TRK']\n        : this.props.topQualifiers;\n    return difference(topQualifiers, this.props.permissionTemplate.defaultFor);\n  }\n\n  renderSetDefaultsControl() {\n    const availableQualifiers = this.getAvailableQualifiers();\n\n    if (availableQualifiers.length === 0) {\n      return null;\n    }\n\n    return this.props.topQualifiers.length === 1\n      ? this.renderIfSingleTopQualifier(availableQualifiers)\n      : this.renderIfMultipleTopQualifiers(availableQualifiers);\n  }\n\n  renderSetDefaultLink(qualifier: string, child: React.ReactNode) {\n    return (\n      <ActionsDropdownItem\n        className=\"js-set-default\"\n        data-qualifier={qualifier}\n        key={qualifier}\n        onClick={this.setDefault(qualifier)}>\n        {child}\n      </ActionsDropdownItem>\n    );\n  }\n\n  renderIfSingleTopQualifier(availableQualifiers: string[]) {\n    return availableQualifiers.map(qualifier =>\n      this.renderSetDefaultLink(\n        qualifier,\n        <span>{translate('permission_templates.set_default')}</span>\n      )\n    );\n  }\n\n  renderIfMultipleTopQualifiers(availableQualifiers: string[]) {\n    return availableQualifiers.map(qualifier =>\n      this.renderSetDefaultLink(\n        qualifier,\n        <span>\n          {translate('permission_templates.set_default_for')}{' '}\n          <QualifierIcon qualifier={qualifier} /> {translate('qualifiers', qualifier)}\n        </span>\n      )\n    );\n  }\n\n  render() {\n    const { permissionTemplate: t, organization } = this.props;\n\n    const pathname = organization\n      ? `/organizations/${organization.key}/permission_templates`\n      : '/permission_templates';\n\n    return (\n      <>\n        <ActionsDropdown>\n          {this.renderSetDefaultsControl()}\n\n          {!this.props.fromDetails && (\n            <ActionsDropdownItem to={{ pathname, query: { id: t.id } }}>\n              {translate('edit_permissions')}\n            </ActionsDropdownItem>\n          )}\n\n          <ActionsDropdownItem className=\"js-update\" onClick={this.handleUpdateClick}>\n            {translate('update_details')}\n          </ActionsDropdownItem>\n\n          {t.defaultFor.length === 0 && (\n            <ActionsDropdownItem\n              className=\"js-delete\"\n              destructive={true}\n              onClick={this.handleDeleteClick}>\n              {translate('delete')}\n            </ActionsDropdownItem>\n          )}\n        </ActionsDropdown>\n\n        {this.state.updateModal && (\n          <Form\n            confirmButtonText={translate('update_verb')}\n            header={translate('permission_template.edit_template')}\n            onClose={this.handleCloseUpdateModal}\n            onSubmit={this.handleSubmitUpdateModal}\n            permissionTemplate={t}\n          />\n        )}\n\n        {this.state.deleteForm && (\n          <DeleteForm\n            onClose={this.handleCloseDeleteForm}\n            onSubmit={this.handleDeleteSubmit}\n            permissionTemplate={t}\n          />\n        )}\n      </>\n    );\n  }\n}\n\nexport default withRouter(ActionsCell);\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { sortBy } from 'lodash';\nimport * as React from 'react';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  organization: T.Organization | undefined;\n  template: T.PermissionTemplate;\n}\n\nexport default function Defaults({ organization, template }: Props) {\n  const qualifiersToDisplay =\n    organization && !organization.isDefault ? ['TRK'] : template.defaultFor;\n\n  const qualifiers = sortBy(qualifiersToDisplay)\n    .map(qualifier => translate('qualifiers', qualifier))\n    .join(', ');\n\n  return (\n    <div>\n      <span className=\"badge spacer-right\">\n        {translateWithParameters('permission_template.default_for', qualifiers)}\n      </span>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport Defaults from './Defaults';\n\ninterface Props {\n  organization: T.Organization | undefined;\n  template: T.PermissionTemplate;\n}\n\nexport default function NameCell({ template, organization }: Props) {\n  const pathname = organization\n    ? `/organizations/${organization.key}/permission_templates`\n    : '/permission_templates';\n\n  return (\n    <td>\n      <Link to={{ pathname, query: { id: template.id } }}>\n        <strong className=\"js-name\">{template.name}</strong>\n      </Link>\n\n      {template.defaultFor.length > 0 && (\n        <div className=\"spacer-top js-defaults\">\n          <Defaults organization={organization} template={template} />\n        </div>\n      )}\n\n      {!!template.description && (\n        <div className=\"spacer-top js-description\">{template.description}</div>\n      )}\n\n      {!!template.projectKeyPattern && (\n        <div className=\"spacer-top js-project-key-pattern\">\n          Project Key Pattern: <code>{template.projectKeyPattern}</code>\n        </div>\n      )}\n    </td>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport HelpTooltip from 'sonar-ui-common/components/controls/HelpTooltip';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { isSonarCloud } from '../../../helpers/system';\n\ninterface Props {\n  permission: {\n    key: string;\n    usersCount: number;\n    groupsCount: number;\n    withProjectCreator?: boolean;\n  };\n}\n\nexport default function PermissionCell({ permission: p }: Props) {\n  return (\n    <td className=\"permission-column\" data-permission={p.key}>\n      <div className=\"permission-column-inner\">\n        <ul>\n          {p.withProjectCreator && (\n            <li className=\"little-spacer-bottom display-flex-center\">\n              {translate('permission_templates.project_creators')}\n              <HelpTooltip\n                className=\"little-spacer-left\"\n                overlay={translate(\n                  isSonarCloud()\n                    ? 'permission_templates.project_creators.explanation.sonarcloud'\n                    : 'permission_templates.project_creators.explanation'\n                )}\n              />\n            </li>\n          )}\n          <li className=\"little-spacer-bottom\">\n            <strong>{p.usersCount}</strong>\n            {'  user(s)'}\n          </li>\n          <li>\n            <strong>{p.groupsCount}</strong>\n            {' group(s)'}\n          </li>\n        </ul>\n      </div>\n    </td>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport ActionsCell from './ActionsCell';\nimport NameCell from './NameCell';\nimport PermissionCell from './PermissionCell';\n\ninterface Props {\n  organization: T.Organization | undefined;\n  refresh: () => Promise<void>;\n  template: T.PermissionTemplate;\n  topQualifiers: string[];\n}\n\nexport default function ListItem(props: Props) {\n  const permissions = props.template.permissions.map(p => (\n    <PermissionCell key={p.key} permission={p} />\n  ));\n\n  return (\n    <tr data-id={props.template.id} data-name={props.template.name}>\n      <NameCell organization={props.organization} template={props.template} />\n\n      {permissions}\n\n      <td className=\"nowrap thin text-right\">\n        <ActionsCell\n          organization={props.organization}\n          permissionTemplate={props.template}\n          refresh={props.refresh}\n          topQualifiers={props.topQualifiers}\n        />\n      </td>\n    </tr>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport ListHeader from './ListHeader';\nimport ListItem from './ListItem';\n\ninterface Props {\n  organization: T.Organization | undefined;\n  permissionTemplates: T.PermissionTemplate[];\n  permissions: T.Permission[];\n  refresh: () => Promise<void>;\n  topQualifiers: string[];\n}\n\nexport default function List(props: Props) {\n  const permissionTemplates = props.permissionTemplates.map(p => (\n    <ListItem\n      key={p.id}\n      organization={props.organization}\n      refresh={props.refresh}\n      template={p}\n      topQualifiers={props.topQualifiers}\n    />\n  ));\n\n  return (\n    <div className=\"boxed-group boxed-group-inner\">\n      <table className=\"data zebra permissions-table\" id=\"permission-templates\">\n        <ListHeader organization={props.organization} permissions={props.permissions} />\n        <tbody>{permissionTemplates}</tbody>\n      </table>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Helmet from 'react-helmet';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport Header from './Header';\nimport List from './List';\n\ninterface Props {\n  organization: T.Organization | undefined;\n  permissionTemplates: T.PermissionTemplate[];\n  permissions: T.Permission[];\n  ready: boolean;\n  refresh: () => Promise<void>;\n  topQualifiers: string[];\n}\n\nexport default function Home(props: Props) {\n  return (\n    <div className=\"page page-limited\">\n      <Helmet title={translate('permission_templates.page')} />\n\n      <Header organization={props.organization} ready={props.ready} refresh={props.refresh} />\n\n      <List\n        organization={props.organization}\n        permissionTemplates={props.permissionTemplates}\n        permissions={props.permissions}\n        refresh={props.refresh}\n        topQualifiers={props.topQualifiers}\n      />\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Defaults from './Defaults';\n\ninterface Props {\n  organization: T.Organization | undefined;\n  template: T.PermissionTemplate;\n}\n\nexport default function TemplateDetails({ organization, template }: Props) {\n  return (\n    <div className=\"big-spacer-bottom\">\n      {template.defaultFor.length > 0 && (\n        <div className=\"spacer-top js-defaults\">\n          <Defaults organization={organization} template={template} />\n        </div>\n      )}\n\n      {!!template.description && (\n        <div className=\"spacer-top js-description\">{template.description}</div>\n      )}\n\n      {!!template.projectKeyPattern && (\n        <div className=\"spacer-top js-project-key-pattern\">\n          Project Key Pattern: <code>{template.projectKeyPattern}</code>\n        </div>\n      )}\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport ActionsCell from './ActionsCell';\n\ninterface Props {\n  loading: boolean;\n  organization: T.Organization | undefined;\n  refresh: () => void;\n  template: T.PermissionTemplate;\n  topQualifiers: string[];\n}\n\nexport default function TemplateHeader(props: Props) {\n  const { template, organization } = props;\n\n  const pathname = organization\n    ? `/organizations/${organization.key}/permission_templates`\n    : '/permission_templates';\n\n  return (\n    <header className=\"page-header\" id=\"project-permissions-header\">\n      <div className=\"note spacer-bottom\">\n        <Link className=\"text-muted\" to={pathname}>\n          {translate('permission_templates.page')}\n        </Link>\n      </div>\n\n      <h1 className=\"page-title\">{template.name}</h1>\n\n      {props.loading && <i className=\"spinner\" />}\n\n      <div className=\"pull-right\">\n        <ActionsCell\n          fromDetails={true}\n          organization={organization}\n          permissionTemplate={template}\n          refresh={props.refresh}\n          topQualifiers={props.topQualifiers}\n        />\n      </div>\n    </header>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Helmet from 'react-helmet';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport * as api from '../../../api/permissions';\nimport HoldersList from '../../permissions/shared/components/HoldersList';\nimport SearchForm from '../../permissions/shared/components/SearchForm';\nimport {\n  convertToPermissionDefinitions,\n  PERMISSIONS_ORDER_FOR_PROJECT_TEMPLATE\n} from '../../permissions/utils';\nimport TemplateDetails from './TemplateDetails';\nimport TemplateHeader from './TemplateHeader';\n\ninterface Props {\n  organization: T.Organization | undefined;\n  refresh: () => void;\n  template: T.PermissionTemplate;\n  topQualifiers: string[];\n}\n\ninterface State {\n  filter: string;\n  groups: T.PermissionGroup[];\n  loading: boolean;\n  query: string;\n  selectedPermission?: string;\n  users: T.PermissionUser[];\n}\n\nexport default class Template extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = {\n    filter: 'all',\n    groups: [],\n    loading: false,\n    query: '',\n    users: []\n  };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.requestHolders();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  requestHolders = (realQuery?: string) => {\n    this.setState({ loading: true });\n\n    const { template } = this.props;\n    const { query, filter, selectedPermission } = this.state;\n    const requests = [];\n\n    const finalQuery = realQuery != null ? realQuery : query;\n\n    if (filter !== 'groups') {\n      requests.push(api.getPermissionTemplateUsers(template.id, finalQuery, selectedPermission));\n    } else {\n      requests.push(Promise.resolve([]));\n    }\n\n    if (filter !== 'users') {\n      requests.push(api.getPermissionTemplateGroups(template.id, finalQuery, selectedPermission));\n    } else {\n      requests.push(Promise.resolve([]));\n    }\n\n    return Promise.all(requests).then(responses => {\n      if (this.mounted) {\n        this.setState({\n          users: responses[0],\n          groups: responses[1],\n          loading: false\n        });\n      }\n    });\n  };\n\n  handleToggleUser = (user: T.PermissionUser, permission: string) => {\n    if (user.login === '<creator>') {\n      return this.handleToggleProjectCreator(user, permission);\n    }\n    const { template, organization } = this.props;\n    const hasPermission = user.permissions.includes(permission);\n    const data: { templateId: string; login: string; permission: string; organization?: string } = {\n      templateId: template.id,\n      login: user.login,\n      permission\n    };\n    if (organization) {\n      data.organization = organization.key;\n    }\n    const request = hasPermission\n      ? api.revokeTemplatePermissionFromUser(data)\n      : api.grantTemplatePermissionToUser(data);\n    return request.then(() => this.requestHolders()).then(this.props.refresh);\n  };\n\n  handleToggleProjectCreator = (user: T.PermissionUser, permission: string) => {\n    const { template } = this.props;\n    const hasPermission = user.permissions.includes(permission);\n    const request = hasPermission\n      ? api.removeProjectCreatorFromTemplate(template.id, permission)\n      : api.addProjectCreatorToTemplate(template.id, permission);\n    return request.then(() => this.requestHolders()).then(this.props.refresh);\n  };\n\n  handleToggleGroup = (group: T.PermissionGroup, permission: string) => {\n    const { template, organization } = this.props;\n    const hasPermission = group.permissions.includes(permission);\n    const data = {\n      templateId: template.id,\n      groupName: group.name,\n      permission\n    };\n    if (organization) {\n      Object.assign(data, { organization: organization.key });\n    }\n    const request = hasPermission\n      ? api.revokeTemplatePermissionFromGroup(data)\n      : api.grantTemplatePermissionToGroup(data);\n    return request.then(() => this.requestHolders()).then(this.props.refresh);\n  };\n\n  handleSearch = (query: string) => {\n    this.setState({ query });\n    this.requestHolders(query);\n  };\n\n  handleFilter = (filter: string) => {\n    this.setState({ filter }, this.requestHolders);\n  };\n\n  handleSelectPermission = (selectedPermission: string) => {\n    if (selectedPermission === this.state.selectedPermission) {\n      this.setState({ selectedPermission: undefined }, this.requestHolders);\n    } else {\n      this.setState({ selectedPermission }, this.requestHolders);\n    }\n  };\n\n  shouldDisplayCreator = (creatorPermissions: string[]) => {\n    const { filter, query, selectedPermission } = this.state;\n    const CREATOR_NAME = translate('permission_templates.project_creators');\n\n    const isFiltered = filter !== 'all';\n\n    const matchQuery = !query || CREATOR_NAME.toLocaleLowerCase().includes(query.toLowerCase());\n\n    const matchPermission =\n      selectedPermission === undefined || creatorPermissions.includes(selectedPermission);\n\n    return !isFiltered && matchQuery && matchPermission;\n  };\n\n  render() {\n    const permissions = convertToPermissionDefinitions(\n      PERMISSIONS_ORDER_FOR_PROJECT_TEMPLATE,\n      'projects_role'\n    );\n\n    const allUsers = [...this.state.users];\n\n    const creatorPermissions = this.props.template.permissions\n      .filter(p => p.withProjectCreator)\n      .map(p => p.key);\n\n    if (this.shouldDisplayCreator(creatorPermissions)) {\n      const creator = {\n        login: '<creator>',\n        name: translate('permission_templates.project_creators'),\n        permissions: creatorPermissions\n      };\n\n      allUsers.unshift(creator);\n    }\n\n    return (\n      <div className=\"page page-limited\">\n        <Helmet title={this.props.template.name} />\n\n        <TemplateHeader\n          loading={this.state.loading}\n          organization={this.props.organization}\n          refresh={this.props.refresh}\n          template={this.props.template}\n          topQualifiers={this.props.topQualifiers}\n        />\n\n        <TemplateDetails organization={this.props.organization} template={this.props.template} />\n\n        <HoldersList\n          groups={this.state.groups}\n          onSelectPermission={this.handleSelectPermission}\n          onToggleGroup={this.handleToggleGroup}\n          onToggleUser={this.handleToggleUser}\n          permissions={permissions}\n          selectedPermission={this.state.selectedPermission}\n          showPublicProjectsWarning={true}\n          users={allUsers}>\n          <SearchForm\n            filter={this.state.filter}\n            onFilter={this.handleFilter}\n            onSearch={this.handleSearch}\n            query={this.state.query}\n          />\n        </HoldersList>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { Location } from 'history';\nimport * as React from 'react';\nimport { connect } from 'react-redux';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { getPermissionTemplates } from '../../../api/permissions';\nimport Suggestions from '../../../app/components/embed-docs-modal/Suggestions';\nimport OrganizationHelmet from '../../../components/common/OrganizationHelmet';\nimport { getAppState, Store } from '../../../store/rootReducer';\nimport '../../permissions/styles.css';\nimport { mergeDefaultsToTemplates, mergePermissionsToTemplates, sortPermissions } from '../utils';\nimport Home from './Home';\nimport Template from './Template';\n\ninterface Props {\n  location: Location;\n  organization: T.Organization | undefined;\n  topQualifiers: string[];\n}\n\ninterface State {\n  ready: boolean;\n  permissions: T.Permission[];\n  permissionTemplates: T.PermissionTemplate[];\n}\n\nexport class App extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = {\n    ready: false,\n    permissions: [],\n    permissionTemplates: []\n  };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.requestPermissions();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  requestPermissions = () => {\n    const { organization } = this.props;\n    const request = organization\n      ? getPermissionTemplates(organization.key)\n      : getPermissionTemplates();\n    return request.then(r => {\n      if (this.mounted) {\n        const permissions = sortPermissions(r.permissions);\n        const permissionTemplates = mergeDefaultsToTemplates(\n          mergePermissionsToTemplates(r.permissionTemplates, permissions),\n          r.defaultTemplates\n        );\n        this.setState({ ready: true, permissionTemplates, permissions });\n      }\n    });\n  };\n\n  renderTemplate(id: string) {\n    if (!this.state.ready) {\n      return null;\n    }\n\n    const template = this.state.permissionTemplates.find(t => t.id === id);\n    if (!template) {\n      return null;\n    }\n\n    return (\n      <Template\n        organization={this.props.organization}\n        refresh={this.requestPermissions}\n        template={template}\n        topQualifiers={this.props.topQualifiers}\n      />\n    );\n  }\n\n  renderHome() {\n    return (\n      <Home\n        organization={this.props.organization}\n        permissionTemplates={this.state.permissionTemplates}\n        permissions={this.state.permissions}\n        ready={this.state.ready}\n        refresh={this.requestPermissions}\n        topQualifiers={this.props.topQualifiers}\n      />\n    );\n  }\n\n  render() {\n    const { id } = this.props.location.query;\n    return (\n      <div>\n        <Suggestions suggestions=\"permission_templates\" />\n        <OrganizationHelmet\n          organization={this.props.organization}\n          title={translate('permission_templates.page')}\n        />\n\n        {id && this.renderTemplate(id)}\n        {!id && this.renderHome()}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state: Store) => ({ topQualifiers: getAppState(state).qualifiers });\n\nexport default connect(mapStateToProps)(App);\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { SuggestionsContext } from './SuggestionsContext';\n\ninterface Props {\n  suggestions: string;\n}\n\nexport default function Suggestions({ suggestions }: Props) {\n  return (\n    <SuggestionsContext.Consumer>\n      {({ addSuggestions, removeSuggestions }) => (\n        <SuggestionsInner\n          addSuggestions={addSuggestions}\n          removeSuggestions={removeSuggestions}\n          suggestions={suggestions}\n        />\n      )}\n    </SuggestionsContext.Consumer>\n  );\n}\n\ninterface SuggestionsInnerProps {\n  addSuggestions: (key: string) => void;\n  removeSuggestions: (key: string) => void;\n  suggestions: string;\n}\n\nclass SuggestionsInner extends React.PureComponent<SuggestionsInnerProps> {\n  componentDidMount() {\n    this.props.addSuggestions(this.props.suggestions);\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.suggestions !== this.props.suggestions) {\n      this.props.removeSuggestions(this.props.suggestions);\n      this.props.addSuggestions(prevProps.suggestions);\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.removeSuggestions(this.props.suggestions);\n  }\n\n  render() {\n    return null;\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { hasMessage, translate } from 'sonar-ui-common/helpers/l10n';\nimport { isSonarCloud } from '../../helpers/system';\n\nexport const PERMISSIONS_ORDER_FOR_PROJECT_TEMPLATE = [\n  'user',\n  'codeviewer',\n  'issueadmin',\n  'securityhotspotadmin',\n  'admin',\n  'scan'\n];\n\nexport const PERMISSIONS_ORDER_GLOBAL = [\n  'admin',\n  { category: 'administer', permissions: ['gateadmin', 'profileadmin'] },\n  'scan',\n  { category: 'creator', permissions: ['provisioning'] }\n];\n\nexport const PERMISSIONS_ORDER_GLOBAL_GOV = [\n  'admin',\n  { category: 'administer', permissions: ['gateadmin', 'profileadmin'] },\n  'scan',\n  { category: 'creator', permissions: ['provisioning', 'applicationcreator', 'portfoliocreator'] }\n];\n\nexport const PERMISSIONS_ORDER_FOR_VIEW = ['user', 'admin'];\n\nexport const PERMISSIONS_ORDER_FOR_DEV = ['user', 'admin'];\n\nexport const PERMISSIONS_ORDER_BY_QUALIFIER: T.Dict<string[]> = {\n  TRK: PERMISSIONS_ORDER_FOR_PROJECT_TEMPLATE,\n  VW: PERMISSIONS_ORDER_FOR_VIEW,\n  SVW: PERMISSIONS_ORDER_FOR_VIEW,\n  APP: PERMISSIONS_ORDER_FOR_VIEW,\n  DEV: PERMISSIONS_ORDER_FOR_DEV\n};\n\nfunction convertToPermissionDefinition(permission: string, l10nPrefix: string) {\n  const getMessage = (messageKey: string) => {\n    const cloudMessageKey = `${messageKey}.sonarcloud`;\n    return isSonarCloud() && hasMessage(cloudMessageKey)\n      ? translate(cloudMessageKey)\n      : translate(messageKey);\n  };\n\n  const name = getMessage(`${l10nPrefix}.${permission}`);\n  const description = getMessage(`${l10nPrefix}.${permission}.desc`);\n\n  return {\n    key: permission,\n    name,\n    description\n  };\n}\n\nexport function convertToPermissionDefinitions(\n  permissions: Array<string | { category: string; permissions: string[] }>,\n  l10nPrefix: string\n): Array<T.PermissionDefinition | T.PermissionDefinitionGroup> {\n  return permissions.map(permission => {\n    if (typeof permission === 'object') {\n      return {\n        category: permission.category,\n        permissions: permission.permissions.map(permission =>\n          convertToPermissionDefinition(permission, l10nPrefix)\n        )\n      };\n    }\n    return convertToPermissionDefinition(permission, l10nPrefix);\n  });\n}\n\nexport function isPermissionDefinitionGroup(\n  permission?: T.PermissionDefinition | T.PermissionDefinitionGroup\n): permission is T.PermissionDefinitionGroup {\n  return Boolean(permission && (permission as T.PermissionDefinitionGroup).category);\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { getJSON, post, postJSON, RequestData } from 'sonar-ui-common/helpers/request';\nimport throwGlobalError from '../app/utils/throwGlobalError';\nimport { BaseSearchProjectsParameters } from './components';\n\nconst PAGE_SIZE = 100;\n\nexport function grantPermissionToUser(data: {\n  projectKey?: string;\n  login: string;\n  permission: string;\n  organization?: string;\n}) {\n  return post('/api/permissions/add_user', data).catch(throwGlobalError);\n}\n\nexport function revokePermissionFromUser(data: {\n  projectKey?: string;\n  login: string;\n  permission: string;\n  organization?: string;\n}) {\n  return post('/api/permissions/remove_user', data).catch(throwGlobalError);\n}\n\nexport function grantPermissionToGroup(data: {\n  projectKey?: string;\n  groupName: string;\n  permission: string;\n  organization?: string;\n}) {\n  return post('/api/permissions/add_group', data).catch(throwGlobalError);\n}\n\nexport function revokePermissionFromGroup(data: {\n  projectKey?: string;\n  groupName: string;\n  permission: string;\n  organization?: string;\n}) {\n  return post('/api/permissions/remove_group', data).catch(throwGlobalError);\n}\n\ninterface GetPermissionTemplatesResponse {\n  permissionTemplates: T.PermissionTemplate[];\n  defaultTemplates: Array<{ templateId: string; qualifier: string }>;\n  permissions: Array<{ key: string; name: string; description: string }>;\n}\n\nexport function getPermissionTemplates(\n  organization?: string\n): Promise<GetPermissionTemplatesResponse> {\n  const url = '/api/permissions/search_templates';\n  return organization ? getJSON(url, { organization }) : getJSON(url);\n}\n\nexport function createPermissionTemplate(data: RequestData) {\n  return postJSON('/api/permissions/create_template', data);\n}\n\nexport function updatePermissionTemplate(data: RequestData): Promise<void> {\n  return post('/api/permissions/update_template', data);\n}\n\nexport function deletePermissionTemplate(data: RequestData) {\n  return post('/api/permissions/delete_template', data).catch(throwGlobalError);\n}\n\n/**\n * Set default permission template for a given qualifier\n */\nexport function setDefaultPermissionTemplate(templateId: string, qualifier: string): Promise<void> {\n  return post('/api/permissions/set_default_template', { templateId, qualifier });\n}\n\nexport function applyTemplateToProject(data: RequestData) {\n  return post('/api/permissions/apply_template', data).catch(throwGlobalError);\n}\n\nexport function bulkApplyTemplate(data: BaseSearchProjectsParameters): Promise<void> {\n  return post('/api/permissions/bulk_apply_template', data);\n}\n\nexport function grantTemplatePermissionToUser(data: {\n  templateId: string;\n  login: string;\n  permission: string;\n  organization?: string;\n}): Promise<void> {\n  return post('/api/permissions/add_user_to_template', data);\n}\n\nexport function revokeTemplatePermissionFromUser(data: {\n  templateId: string;\n  login: string;\n  permission: string;\n  organization?: string;\n}): Promise<void> {\n  return post('/api/permissions/remove_user_from_template', data);\n}\n\nexport function grantTemplatePermissionToGroup(data: RequestData): Promise<void> {\n  return post('/api/permissions/add_group_to_template', data);\n}\n\nexport function revokeTemplatePermissionFromGroup(data: RequestData): Promise<void> {\n  return post('/api/permissions/remove_group_from_template', data);\n}\n\nexport function addProjectCreatorToTemplate(templateId: string, permission: string): Promise<void> {\n  return post('/api/permissions/add_project_creator_to_template', { templateId, permission });\n}\n\nexport function removeProjectCreatorFromTemplate(\n  templateId: string,\n  permission: string\n): Promise<void> {\n  return post('/api/permissions/remove_project_creator_from_template', { templateId, permission });\n}\n\nexport function getPermissionsUsersForComponent(data: {\n  projectKey: string;\n  q?: string;\n  permission?: string;\n  organization?: string;\n  p?: number;\n  ps?: number;\n}): Promise<{ paging: T.Paging; users: T.PermissionUser[] }> {\n  if (!data.ps) {\n    data.ps = PAGE_SIZE;\n  }\n  return getJSON('/api/permissions/users', data).catch(throwGlobalError);\n}\n\nexport function getPermissionsGroupsForComponent(data: {\n  projectKey: string;\n  q?: string;\n  permission?: string;\n  organization?: string;\n  p?: number;\n  ps?: number;\n}): Promise<{ paging: T.Paging; groups: T.PermissionGroup[] }> {\n  if (!data.ps) {\n    data.ps = PAGE_SIZE;\n  }\n  return getJSON('/api/permissions/groups', data).catch(throwGlobalError);\n}\n\nexport function getGlobalPermissionsUsers(data: {\n  q?: string;\n  permission?: string;\n  organization?: string;\n  p?: number;\n  ps?: number;\n}): Promise<{ paging: T.Paging; users: T.PermissionUser[] }> {\n  if (!data.ps) {\n    data.ps = PAGE_SIZE;\n  }\n  return getJSON('/api/permissions/users', data);\n}\n\nexport function getGlobalPermissionsGroups(data: {\n  q?: string;\n  permission?: string;\n  organization?: string;\n  p?: number;\n  ps?: number;\n}): Promise<{ paging: T.Paging; groups: T.PermissionGroup[] }> {\n  if (!data.ps) {\n    data.ps = PAGE_SIZE;\n  }\n  return getJSON('/api/permissions/groups', data);\n}\n\nexport function getPermissionTemplateUsers(\n  templateId: string,\n  query?: string,\n  permission?: string,\n  organization?: string\n): Promise<any> {\n  const data: RequestData = { templateId, ps: PAGE_SIZE };\n  if (query) {\n    data.q = query;\n  }\n  if (permission) {\n    data.permission = permission;\n  }\n  if (organization) {\n    Object.assign(data, { organization });\n  }\n  return getJSON('/api/permissions/template_users', data).then(r => r.users);\n}\n\nexport function getPermissionTemplateGroups(\n  templateId: string,\n  query?: string,\n  permission?: string,\n  organization?: string\n): Promise<any> {\n  const data: RequestData = { templateId, ps: PAGE_SIZE };\n  if (query) {\n    data.q = query;\n  }\n  if (permission) {\n    data.permission = permission;\n  }\n  if (organization) {\n    Object.assign(data, { organization });\n  }\n  return getJSON('/api/permissions/template_groups', data).then(r => r.groups);\n}\n\nexport function changeProjectVisibility(\n  project: string,\n  visibility: T.Visibility\n): Promise<void | Response> {\n  return post('/api/projects/update_visibility', { project, visibility }).catch(throwGlobalError);\n}\n\nexport function changeProjectDefaultVisibility(\n  organization: string,\n  projectVisibility: T.Visibility\n): Promise<void | Response> {\n  return post('/api/projects/update_default_visibility', { organization, projectVisibility }).catch(\n    throwGlobalError\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Helmet from 'react-helmet';\n\ninterface Props {\n  organization?: { name: string };\n  title: string;\n}\n\nexport default function OrganizationHelmet({ title, organization }: Props) {\n  const defaultTitle = title + (organization ? ' - ' + organization.name : '');\n  return <Helmet defaultTitle={defaultTitle} titleTemplate={'%s - ' + defaultTitle} />;\n}\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./styles.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./styles.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./styles.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \".permissions-table .permission-column.selected{background-color:#d9edf7}.permissions-table .permission-column-inner{display:inline-block;width:100px}.permissions-table .divider{background:#fff;padding:16px 0}.permissions-table .divider:after{display:block;content:\\\"\\\";background:#e6e6e6;height:1px;width:100%}\", \"\"]);\n\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport RadioToggle from 'sonar-ui-common/components/controls/RadioToggle';\nimport SearchBox from 'sonar-ui-common/components/controls/SearchBox';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  filter: string;\n  onFilter: (value: string) => void;\n  onSearch: (value: string) => void;\n  query: string;\n}\n\nexport default function SearchForm(props: Props) {\n  const filterOptions = [\n    { value: 'all', label: translate('all') },\n    { value: 'users', label: translate('users.page') },\n    { value: 'groups', label: translate('user_groups.page') }\n  ];\n\n  return (\n    <div className=\"display-flex-row\">\n      <RadioToggle\n        name=\"users-or-groups\"\n        onCheck={props.onFilter}\n        options={filterOptions}\n        value={props.filter}\n      />\n\n      <div className=\"flex-1 spacer-left\">\n        <SearchBox\n          minLength={3}\n          onChange={props.onSearch}\n          placeholder={translate('search.search_for_users_or_groups')}\n          value={props.query}\n        />\n      </div>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport Checkbox from 'sonar-ui-common/components/controls/Checkbox';\nimport { isPermissionDefinitionGroup } from '../../utils';\n\ninterface Props {\n  loading: string[];\n  onCheck: (checked: boolean, permission?: string) => void;\n  permission: T.PermissionDefinition | T.PermissionDefinitionGroup;\n  permissionItem: T.PermissionGroup | T.PermissionUser;\n  selectedPermission?: string;\n}\n\nexport default class PermissionCell extends React.PureComponent<Props> {\n  render() {\n    const { loading, onCheck, permission, permissionItem, selectedPermission } = this.props;\n    if (isPermissionDefinitionGroup(permission)) {\n      return (\n        <td className=\"text-middle\">\n          {permission.permissions.map(permission => (\n            <div key={permission.key}>\n              <Checkbox\n                checked={permissionItem.permissions.includes(permission.key)}\n                disabled={loading.includes(permission.key)}\n                id={permission.key}\n                onCheck={onCheck}>\n                <span className=\"little-spacer-left\">{permission.name}</span>\n              </Checkbox>\n            </div>\n          ))}\n        </td>\n      );\n    } else {\n      return (\n        <td\n          className={classNames('permission-column text-center text-middle', {\n            selected: permission.key === selectedPermission\n          })}>\n          <Checkbox\n            checked={permissionItem.permissions.includes(permission.key)}\n            disabled={loading.includes(permission.key)}\n            id={permission.key}\n            onCheck={onCheck}\n          />\n        </td>\n      );\n    }\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { without } from 'lodash';\nimport * as React from 'react';\nimport GroupIcon from 'sonar-ui-common/components/icons/GroupIcon';\nimport { isPermissionDefinitionGroup } from '../../utils';\nimport PermissionCell from './PermissionCell';\n\ninterface Props {\n  group: T.PermissionGroup;\n  onToggle: (group: T.PermissionGroup, permission: string) => Promise<void>;\n  permissions: T.PermissionDefinitions;\n  selectedPermission?: string;\n}\n\ninterface State {\n  loading: string[];\n}\n\nexport default class GroupHolder extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { loading: [] };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  stopLoading = (permission: string) => {\n    if (this.mounted) {\n      this.setState(state => ({ loading: without(state.loading, permission) }));\n    }\n  };\n\n  handleCheck = (_checked: boolean, permission?: string) => {\n    if (permission !== undefined) {\n      this.setState(state => ({ loading: [...state.loading, permission] }));\n      this.props\n        .onToggle(this.props.group, permission)\n        .then(() => this.stopLoading(permission), () => this.stopLoading(permission));\n    }\n  };\n\n  render() {\n    const { group } = this.props;\n\n    return (\n      <tr>\n        <td className=\"nowrap text-middle\">\n          <div className=\"display-inline-block text-middle big-spacer-right\">\n            <GroupIcon />\n          </div>\n          <div className=\"display-inline-block text-middle\">\n            <div>\n              <strong>{group.name}</strong>\n            </div>\n            <div className=\"little-spacer-top\" style={{ whiteSpace: 'normal' }}>\n              {group.description}\n            </div>\n          </div>\n        </td>\n        {this.props.permissions.map(permission => (\n          <PermissionCell\n            key={isPermissionDefinitionGroup(permission) ? permission.category : permission.key}\n            loading={this.state.loading}\n            onCheck={this.handleCheck}\n            permission={permission}\n            permissionItem={group}\n            selectedPermission={this.props.selectedPermission}\n          />\n        ))}\n      </tr>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport HelpTooltip from 'sonar-ui-common/components/controls/HelpTooltip';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport InstanceMessage from '../../../../components/common/InstanceMessage';\nimport { isPermissionDefinitionGroup } from '../../utils';\n\ninterface Props {\n  onSelectPermission?: (permission: string) => void;\n  permission: T.PermissionDefinition | T.PermissionDefinitionGroup;\n  selectedPermission?: string;\n  showPublicProjectsWarning?: boolean;\n}\n\nexport default class PermissionHeader extends React.PureComponent<Props> {\n  handlePermissionClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    const { permission } = this.props;\n    if (this.props.onSelectPermission && !isPermissionDefinitionGroup(permission)) {\n      this.props.onSelectPermission(permission.key);\n    }\n  };\n\n  getTooltipOverlay = () => {\n    const { permission } = this.props;\n\n    if (isPermissionDefinitionGroup(permission)) {\n      return permission.permissions.map(permission => (\n        <React.Fragment key={permission.key}>\n          <b className=\"little-spacer-right\">{permission.name}:</b>\n          <InstanceMessage key={permission.key} message={permission.description} />\n          <br />\n        </React.Fragment>\n      ));\n    } else {\n      if (this.props.showPublicProjectsWarning && ['user', 'codeviewer'].includes(permission.key)) {\n        return (\n          <div>\n            <InstanceMessage message={permission.description} />\n            <Alert className=\"spacer-top\" variant=\"warning\">\n              {translate('projects_role.public_projects_warning')}\n            </Alert>\n          </div>\n        );\n      }\n      return <InstanceMessage message={permission.description} />;\n    }\n  };\n\n  render() {\n    const { onSelectPermission, permission } = this.props;\n    let name;\n    if (isPermissionDefinitionGroup(permission)) {\n      name = translate('global_permissions', permission.category);\n    } else {\n      name = onSelectPermission ? (\n        <Tooltip\n          overlay={translateWithParameters(\n            'global_permissions.filter_by_x_permission',\n            permission.name\n          )}>\n          <a href=\"#\" onClick={this.handlePermissionClick}>\n            {permission.name}\n          </a>\n        </Tooltip>\n      ) : (\n        permission.name\n      );\n    }\n    return (\n      <th\n        className={classNames('permission-column text-center text-middle', {\n          selected:\n            !isPermissionDefinitionGroup(permission) &&\n            permission.key === this.props.selectedPermission\n        })}>\n        <div className=\"permission-column-inner\">\n          {name}\n          <HelpTooltip className=\"spacer-left\" overlay={this.getTooltipOverlay()} />\n        </div>\n      </th>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { without } from 'lodash';\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport Avatar from '../../../../components/ui/Avatar';\nimport { isSonarCloud } from '../../../../helpers/system';\nimport { isPermissionDefinitionGroup } from '../../utils';\nimport PermissionCell from './PermissionCell';\n\ninterface Props {\n  onToggle: (user: T.PermissionUser, permission: string) => Promise<void>;\n  permissions: T.PermissionDefinitions;\n  selectedPermission?: string;\n  user: T.PermissionUser;\n}\n\ninterface State {\n  loading: string[];\n}\n\nexport default class UserHolder extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { loading: [] };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  stopLoading = (permission: string) => {\n    if (this.mounted) {\n      this.setState(state => ({ loading: without(state.loading, permission) }));\n    }\n  };\n\n  handleCheck = (_checked: boolean, permission?: string) => {\n    if (permission !== undefined) {\n      this.setState(state => ({ loading: [...state.loading, permission] }));\n      this.props\n        .onToggle(this.props.user, permission)\n        .then(() => this.stopLoading(permission), () => this.stopLoading(permission));\n    }\n  };\n\n  render() {\n    const { user } = this.props;\n    const permissionCells = this.props.permissions.map(permission => (\n      <PermissionCell\n        key={isPermissionDefinitionGroup(permission) ? permission.category : permission.key}\n        loading={this.state.loading}\n        onCheck={this.handleCheck}\n        permission={permission}\n        permissionItem={user}\n        selectedPermission={this.props.selectedPermission}\n      />\n    ));\n\n    if (user.login === '<creator>') {\n      return (\n        <tr>\n          <td className=\"nowrap text-middle\">\n            <div className=\"display-inline-block text-middle\">\n              <div>\n                <strong>{user.name}</strong>\n              </div>\n              <div className=\"little-spacer-top\" style={{ whiteSpace: 'normal' }}>\n                {translate(\n                  isSonarCloud()\n                    ? 'permission_templates.project_creators.explanation.sonarcloud'\n                    : 'permission_templates.project_creators.explanation'\n                )}\n              </div>\n            </div>\n          </td>\n          {permissionCells}\n        </tr>\n      );\n    }\n\n    return (\n      <tr>\n        <td className=\"nowrap text-middle\">\n          <Avatar\n            className=\"text-middle big-spacer-right\"\n            hash={user.avatar}\n            name={user.name}\n            size={36}\n          />\n          <div className=\"display-inline-block text-middle\">\n            {isSonarCloud() ? (\n              <>\n                <div>\n                  <strong>{user.name}</strong>\n                </div>\n                <div className=\"note little-spacer-top\">{user.login}</div>\n              </>\n            ) : (\n              <>\n                <div>\n                  <strong>{user.name}</strong>\n                  <span className=\"note spacer-left\">{user.login}</span>\n                </div>\n                <div className=\"little-spacer-top\">{user.email}</div>\n              </>\n            )}\n          </div>\n        </td>\n        {permissionCells}\n      </tr>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { partition, sortBy } from 'lodash';\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { isPermissionDefinitionGroup } from '../../utils';\nimport GroupHolder from './GroupHolder';\nimport PermissionHeader from './PermissionHeader';\nimport UserHolder from './UserHolder';\n\ninterface Props {\n  filter?: string;\n  groups: T.PermissionGroup[];\n  loading?: boolean;\n  onSelectPermission?: (permission: string) => void;\n  onToggleGroup: (group: T.PermissionGroup, permission: string) => Promise<void>;\n  onToggleUser: (user: T.PermissionUser, permission: string) => Promise<void>;\n  permissions: T.PermissionDefinitions;\n  query?: string;\n  selectedPermission?: string;\n  showPublicProjectsWarning?: boolean;\n  users: T.PermissionUser[];\n}\n\ninterface State {\n  initialPermissionsCount: T.Dict<number>;\n}\nexport default class HoldersList extends React.PureComponent<Props, State> {\n  state: State = { initialPermissionsCount: {} };\n  componentDidUpdate(prevProps: Props) {\n    if (this.props.filter !== prevProps.filter || this.props.query !== prevProps.query) {\n      this.setState({ initialPermissionsCount: {} });\n    }\n  }\n\n  isPermissionUser(item: T.PermissionGroup | T.PermissionUser): item is T.PermissionUser {\n    return (item as T.PermissionUser).login !== undefined;\n  }\n\n  handleGroupToggle = (group: T.PermissionGroup, permission: string) => {\n    const key = group.id || group.name;\n    if (this.state.initialPermissionsCount[key] === undefined) {\n      this.setState(state => ({\n        initialPermissionsCount: {\n          ...state.initialPermissionsCount,\n          [key]: group.permissions.length\n        }\n      }));\n    }\n    return this.props.onToggleGroup(group, permission);\n  };\n\n  handleUserToggle = (user: T.PermissionUser, permission: string) => {\n    if (this.state.initialPermissionsCount[user.login] === undefined) {\n      this.setState(state => ({\n        initialPermissionsCount: {\n          ...state.initialPermissionsCount,\n          [user.login]: user.permissions.length\n        }\n      }));\n    }\n    return this.props.onToggleUser(user, permission);\n  };\n\n  getItemInitialPermissionsCount = (item: T.PermissionGroup | T.PermissionUser) => {\n    const key = this.isPermissionUser(item) ? item.login : item.id || item.name;\n    return this.state.initialPermissionsCount[key] !== undefined\n      ? this.state.initialPermissionsCount[key]\n      : item.permissions.length;\n  };\n\n  renderEmpty() {\n    const columns = this.props.permissions.length + 1;\n    return (\n      <tr>\n        <td colSpan={columns}>{translate('no_results_search')}</td>\n      </tr>\n    );\n  }\n\n  renderItem(item: T.PermissionUser | T.PermissionGroup, permissions: T.PermissionDefinitions) {\n    return this.isPermissionUser(item) ? (\n      <UserHolder\n        key={`user-${item.login}`}\n        onToggle={this.handleUserToggle}\n        permissions={permissions}\n        selectedPermission={this.props.selectedPermission}\n        user={item}\n      />\n    ) : (\n      <GroupHolder\n        group={item}\n        key={`group-${item.id || item.name}`}\n        onToggle={this.handleGroupToggle}\n        permissions={permissions}\n        selectedPermission={this.props.selectedPermission}\n      />\n    );\n  }\n\n  render() {\n    const { permissions } = this.props;\n    const items = sortBy([...this.props.users, ...this.props.groups], item => {\n      if (this.isPermissionUser(item) && item.login === '<creator>') {\n        return 0;\n      }\n      return item.name;\n    });\n    const [itemWithPermissions, itemWithoutPermissions] = partition(items, item =>\n      this.getItemInitialPermissionsCount(item)\n    );\n    return (\n      <div className=\"boxed-group boxed-group-inner\">\n        <table className=\"data zebra permissions-table\">\n          <thead>\n            <tr>\n              <td className=\"nowrap bordered-bottom\">{this.props.children}</td>\n              {permissions.map(permission => (\n                <PermissionHeader\n                  key={\n                    isPermissionDefinitionGroup(permission) ? permission.category : permission.key\n                  }\n                  onSelectPermission={this.props.onSelectPermission}\n                  permission={permission}\n                  selectedPermission={this.props.selectedPermission}\n                  showPublicProjectsWarning={this.props.showPublicProjectsWarning}\n                />\n              ))}\n            </tr>\n          </thead>\n          <tbody>\n            {items.length === 0 && !this.props.loading && this.renderEmpty()}\n            {itemWithPermissions.map(item => this.renderItem(item, permissions))}\n            {itemWithPermissions.length > 0 && itemWithoutPermissions.length > 0 && (\n              <>\n                <tr>\n                  <td className=\"divider\" colSpan={20} />\n                </tr>\n                <tr />\n                {/* Keep correct zebra colors in the table */}\n              </>\n            )}\n            {itemWithoutPermissions.map(item => this.renderItem(item, permissions))}\n          </tbody>\n        </table>\n      </div>\n    );\n  }\n}\n"],"sourceRoot":""}