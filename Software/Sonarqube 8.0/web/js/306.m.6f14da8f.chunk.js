(window.webpackJsonp=window.webpackJsonp||[]).push([[306],{1775:function(e,t,n){"use strict";n.r(t);var a=n(789),i=n.n(a),r=n(309),o=n(690),s=n(2),l=n(325),c=n(316),d=n(28),p=n(850),m=n.n(p),u=n(315),h=n.n(u),g=n(5),b=n(345),O=n(30),f=n(512),v=n(548),z=n(564),j=n(418),_=n(343),E=n(421),y=n(480),S=n(565),N=n(350),k=n(319),C=n(461),x=n(790),P=(n(549),n(591)),I=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&(n[a[i]]=e[a[i]])}return n};function A(e){let t=e.almKey;return s.createElement(h.a,{customSpinner:s.createElement("div",{className:"sonarcloud page page-limited"},s.createElement("div",{className:"huge-spacer-top text-center"},s.createElement("i",{className:"spinner"}),s.createElement("p",{className:"big-spacer-top"},Object(g.translateWithParameters)("onboarding.import_organization.installing",t?Object(g.translate)(Object(N.g)(t)):"ALM"))))})}var U=n(304),F=n(310),w=n(440),D=n.n(w),B=n(326),K=n(322),L=n(853);class M extends s.PureComponent{constructor(e){super(e),this.mounted=!1,this.handleChange=e=>{let t=e.key;this.setState({organization:t})},this.handleSubmit=e=>{e.preventDefault();const t=this.state.organization;t&&(this.setState({submitting:!0}),this.props.onBindOrganization(t).then(this.stopSubmitting,this.stopSubmitting))},this.stopSubmitting=()=>{this.mounted&&this.setState({submitting:!1})},this.state={organization:this.getInitialSelectedOrganization(e),submitting:!1}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}getInitialSelectedOrganization(e){return 1===e.unboundOrganizations.length?e.unboundOrganizations[0].key:""}render(){const e=this.props.almKey,t=this.state,n=t.organization,a=t.submitting;return s.createElement("form",{id:"bind-organization-form",onSubmit:this.handleSubmit},s.createElement(L.a,{onChange:this.handleChange,organization:n,organizations:this.props.unboundOrganizations}),Object(N.e)(e)&&s.createElement(B.Alert,{className:"abs-width-400 big-spacer-top",display:"block",variant:"info"},Object(g.translateWithParameters)("onboarding.import_organization.bind_members_not_sync_info_x",Object(g.translate)("organization",e)),s.createElement(d.Link,{className:"spacer-left",target:"_blank",to:{pathname:"/documentation/organizations/manage-team/"}},Object(g.translate)("learn_more"))),s.createElement("div",{className:"display-flex-center big-spacer-top"},s.createElement(F.SubmitButton,{disabled:a||!n},Object(g.translate)("onboarding.import_organization.bind")),a&&s.createElement(h.a,{className:"spacer-left"})))}}var T=n(333),R=n.n(T),W=n(567),V=n.n(W),q=n(550),J=n(547);class H extends s.PureComponent{constructor(){super(...arguments),this.state={error:void 0,editing:!1,touched:!1,value:""},this.handleChange=e=>{const t=e.currentTarget.value.trim(),n=this.validateUrl(t);this.setState({error:n,touched:!0,value:t}),this.props.onChange(void 0===n?t:void 0)},this.handleBlur=()=>{this.setState({editing:!1})},this.handleFocus=()=>{this.setState({editing:!0})}}componentDidMount(){if(this.props.initialValue){const e=this.props.initialValue,t=this.validateUrl(e);this.setState({error:t,touched:Boolean(t),value:e})}}validateUrl(e){if(e.length>0&&!Object(q.isWebUri)(e))return Object(g.translate)("onboarding.create_organization.url.error")}render(){const e=this.state.touched&&!this.state.editing&&void 0!==this.state.error,t=void 0===this.state.error&&""!==this.state.value,n=this.state.touched&&t;return s.createElement(V.a,{description:Object(g.translate)("onboarding.create_organization.avatar.description"),error:this.state.error,id:"organization-avatar",isInvalid:e,isValid:n,label:Object(g.translate)("onboarding.create_organization.avatar")},s.createElement(s.Fragment,null,(t||this.props.name)&&s.createElement(J.a,{className:"display-block spacer-bottom",organization:{avatar:t?this.state.value:void 0,name:this.props.name||""}}),s.createElement("input",{className:r("input-super-large","text-middle",{"is-invalid":e,"is-valid":n}),id:"organization-avatar",onBlur:this.handleBlur,onChange:this.handleChange,onFocus:this.handleFocus,placeholder:Object(g.translate)("onboarding.create_organization.avatar.placeholder"),type:"text",value:this.state.value})))}}var $=n(362),Q=n.n($);class G extends s.PureComponent{constructor(e){super(e),this.mounted=!1,this.checkFreeKey=e=>(this.setState({validating:!0}),Object(j.d)(e).then(t=>{this.mounted&&(void 0===t?(this.setState({error:void 0,validating:!1}),this.props.onChange(e)):(this.setState({error:Object(g.translate)("onboarding.create_organization.organization_name.taken"),touched:!0,validating:!1}),this.props.onChange(void 0)))}).catch(()=>{this.mounted&&(this.setState({error:void 0,validating:!1}),this.props.onChange(e))})),this.handleChange=e=>{const t=e.currentTarget.value;this.setState({touched:!0,value:t}),this.validateKey(t)},this.state={error:void 0,touched:!1,validating:!1,value:""},this.checkFreeKey=Q()(this.checkFreeKey,250)}componentDidMount(){this.mounted=!0,void 0!==this.props.initialValue&&(this.setState({value:this.props.initialValue}),this.validateKey(this.props.initialValue))}componentWillUnmount(){this.mounted=!1}validateKey(e){e.length>255||!/^[a-z0-9][a-z0-9-]*[a-z0-9]?$/.test(e)?(this.setState({error:Object(g.translate)("onboarding.create_organization.organization_name.error"),touched:!0}),this.props.onChange(void 0)):this.checkFreeKey(e)}render(){const e=this.state.touched&&void 0!==this.state.error,t=this.state.touched&&!this.state.validating&&void 0===this.state.error;return s.createElement(V.a,{error:this.state.error,id:"organization-key",isInvalid:e,isValid:t,label:Object(g.translate)("onboarding.create_organization.organization_name"),required:!0},s.createElement("div",{className:"display-inline-flex-baseline"},s.createElement("span",{className:"little-spacer-right"},Object(K.getHostUrl)().replace(/https*:\/\//,"")+"/organizations/"),s.createElement("input",{autoFocus:!0,className:r("input-super-large",{"is-invalid":e,"is-valid":t}),id:"organization-key",maxLength:255,onChange:this.handleChange,type:"text",value:this.state.value})))}}class X extends s.PureComponent{constructor(){super(...arguments),this.state={error:void 0,editing:!1,touched:!1,value:""},this.handleChange=e=>{const t=e.currentTarget.value.trim(),n=this.validateUrl(t);this.setState({error:n,touched:!0,value:t}),this.props.onChange(void 0===n?t:void 0)},this.handleBlur=()=>{this.setState({editing:!1})},this.handleFocus=()=>{this.setState({editing:!0})}}componentDidMount(){if(this.props.initialValue){const e=this.props.initialValue,t=this.validateUrl(e);this.setState({error:t,touched:Boolean(t),value:e})}}validateUrl(e){if(e.length>0&&!Object(q.isWebUri)(e))return Object(g.translate)("onboarding.create_organization.url.error")}render(){const e=this.state.touched&&!this.state.editing&&void 0!==this.state.error,t=this.state.touched&&void 0===this.state.error&&""!==this.state.value;return s.createElement(V.a,{error:this.state.error,id:"organization-url",isInvalid:e,isValid:t,label:Object(g.translate)("onboarding.create_organization.url")},s.createElement("input",{className:r("input-super-large","text-middle",{"is-invalid":e,"is-valid":t}),id:"organization-url",onBlur:this.handleBlur,onChange:this.handleChange,onFocus:this.handleFocus,type:"text",value:this.state.value}))}}class Y extends s.PureComponent{constructor(e){super(e),this.mounted=!1,this.handleAdditionalClick=()=>{this.setState(e=>({additional:!e.additional}))},this.handleAvatarUpdate=e=>{this.setState({avatar:e})},this.handleDescriptionUpdate=e=>{this.setState({description:e.currentTarget.value})},this.handleKeyUpdate=e=>{this.setState({key:e})},this.handleNameUpdate=e=>{this.setState({name:e.currentTarget.value})},this.handleUrlUpdate=e=>{this.setState({url:e})},this.handleSubmit=e=>{e.preventDefault();const t=this.state;this.canSubmit(t)&&(this.setState({submitting:!0}),this.props.onContinue({avatar:t.avatar,description:t.description,key:t.key,name:t.name,url:t.url}).then(this.stopSubmitting,this.stopSubmitting))},this.stopSubmitting=()=>{this.mounted&&this.setState({submitting:!1})};const t=e.organization;this.state={additional:!1,avatar:t&&t.avatar||"",description:t&&t.description||"",key:t&&t.key||void 0,name:t&&t.name||"",submitting:!1,url:t&&t.url||""}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}canSubmit(e){return Boolean(void 0!==e.key&&void 0!==e.name&&void 0!==e.description&&void 0!==e.avatar&&void 0!==e.url)}render(){const e=this.state.submitting,t=this.props.infoBlock;return s.createElement("form",{id:"organization-form",onSubmit:this.handleSubmit},s.createElement(G,{initialValue:this.state.key,onChange:this.handleKeyUpdate}),s.createElement("div",{className:"big-spacer-top"},s.createElement(F.ResetButtonLink,{onClick:this.handleAdditionalClick},Object(g.translate)(this.state.additional?"onboarding.create_organization.hide_additional_info":"onboarding.create_organization.add_additional_info"),s.createElement(R.a,{className:"little-spacer-left",turned:this.state.additional}))),s.createElement("div",{className:"js-additional-info",hidden:!this.state.additional},s.createElement("div",{className:"big-spacer-top"},s.createElement("label",{htmlFor:"organization-display-name"},s.createElement("strong",null,Object(g.translate)("onboarding.create_organization.display_name"))),s.createElement("div",{className:"little-spacer-top"},s.createElement("input",{className:"input-super-large text-middle",id:"organization-display-name",maxLength:255,onChange:this.handleNameUpdate,type:"text",value:this.state.name})),s.createElement("div",{className:"note abs-width-400"},Object(g.translate)("onboarding.create_organization.display_name.description"))),s.createElement("div",{className:"big-spacer-top"},s.createElement(H,{initialValue:this.state.avatar,name:this.state.name,onChange:this.handleAvatarUpdate})),s.createElement("div",{className:"big-spacer-top"},s.createElement("label",{htmlFor:"organization-description"},s.createElement("strong",null,Object(g.translate)("onboarding.create_organization.description"))),s.createElement("div",{className:"little-spacer-top"},s.createElement("textarea",{className:"input-super-large text-middle",id:"organization-description",maxLength:256,onChange:this.handleDescriptionUpdate,rows:3,value:this.state.description}))),s.createElement("div",{className:"big-spacer-top"},s.createElement(X,{initialValue:this.state.url,onChange:this.handleUrlUpdate}))),t,s.createElement("div",{className:"display-flex-center big-spacer-top"},s.createElement(F.SubmitButton,{disabled:e||!this.canSubmit(this.state)},this.props.submitText),e&&s.createElement(h.a,{className:"spacer-left"})))}}var Z=n(457),ee=n.n(Z),te=n(551);class ne extends s.PureComponent{constructor(){super(...arguments),this.renderForm=()=>s.createElement("div",{className:"boxed-group-inner"},this.props.children),this.renderResult=()=>{const e=this.props.organization;return e?s.createElement("div",{className:"boxed-group-actions display-flex-center"},s.createElement(ee.a,{className:"spacer-right"}),s.createElement("strong",{className:"text-limited"},e.key)):null}}render(){return s.createElement(te.a,{finished:this.props.finished,onOpen:this.props.onOpen,open:this.props.open,renderForm:this.renderForm,renderResult:this.renderResult,stepNumber:1,stepTitle:this.props.stepTitle||Object(g.translate)("onboarding.create_organization.enter_org_details")})}}var ae=n(438),ie=n(383),re=n(619),oe=n(426),se=n.n(oe),le=n(427),ce=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&(n[a[i]]=e[a[i]])}return n};function de(e){var t=e.almName,n=e.hasWarning,a=ce(e,["almName","hasWarning"]);const i=t&&a.disabled,r=t&&n&&!a.disabled;return s.createElement(se.a,Object.assign({title:Object(g.translate)("billing.free_plan.title"),titleInfo:Object(le.f)(0)},a),s.createElement("div",{className:"spacer-left"},s.createElement("ul",{className:"big-spacer-left note"},s.createElement("li",{className:"little-spacer-bottom"},Object(g.translate)("billing.free_plan.all_projects_analyzed_public")),s.createElement("li",null,Object(g.translate)("billing.free_plan.anyone_can_browse_source_code")))),r&&s.createElement(B.Alert,{variant:"warning"},s.createElement(U.FormattedMessage,{defaultMessage:Object(g.translate)("billing.free_plan.private_repo_warning"),id:"billing.free_plan.private_repo_warning",values:{alm:t}})),i&&s.createElement(B.Alert,{variant:"info"},s.createElement(U.FormattedMessage,{defaultMessage:Object(g.translate)("billing.free_plan.not_available_info"),id:"billing.free_plan.not_available_info",values:{alm:t}})))}var pe,me=n(552),ue=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&(n[a[i]]=e[a[i]])}return n};function he(e){var t=e.isRecommended,n=e.startingPrice,a=ue(e,["isRecommended","startingPrice"]);return s.createElement(se.a,Object.assign({recommended:t?Object(g.translate)("billing.paid_plan.recommended"):void 0,title:Object(g.translate)("billing.paid_plan.title"),titleInfo:void 0!==n&&s.createElement(U.FormattedMessage,{defaultMessage:Object(g.translate)("billing.price_from_x"),id:"billing.price_from_x",values:{price:s.createElement("span",{className:"big"},Object(le.f)(n))}})},a),s.createElement(me.a,null),s.createElement("div",{className:"big-spacer-left"},s.createElement(d.Link,{className:"spacer-left",target:"_blank",to:"/about/pricing"},Object(g.translate)("billing.pricing.learn_more"))))}!function(e){e.Free="free",e.Paid="paid"}(pe||(pe={}));class ge extends s.PureComponent{constructor(){super(...arguments),this.handleFreePlanClick=()=>{this.props.onChange(pe.Free)},this.handlePaidPlanClick=()=>{this.props.onChange(pe.Paid)}}render(){const e=this.props,t=e.almApplication,n=e.almOrganization,a=e.plan,i=Boolean(n&&n.privateRepos>0),r=Boolean(i&&n&&0===n.publicRepos),o=[s.createElement(he,{isRecommended:i,key:"paid",onClick:this.handlePaidPlanClick,selected:a===pe.Paid,startingPrice:this.props.startingPrice}),s.createElement(de,{almName:t&&t.name,disabled:r,hasWarning:i&&a===pe.Free,key:"free",onClick:this.handleFreePlanClick,selected:a===pe.Free})];return s.createElement("div",{"aria-label":Object(g.translate)("onboarding.create_organization.choose_plan"),className:"display-flex-row huge-spacer-bottom",role:"radiogroup"},i?o:o.reverse())}}const be=Object(ae.a)(re.a);class Oe extends s.PureComponent{constructor(e){super(e),this.mounted=!1,this.handlePlanChange=e=>{this.setState({plan:e})},this.stopSubmitting=()=>{this.mounted&&this.setState({submitting:!1})},this.handleFreePlanSubmit=e=>(e.preventDefault(),this.setState({submitting:!0}),this.props.createOrganization().then(()=>{this.props.onDone(),this.stopSubmitting()},this.stopSubmitting)),this.renderForm=()=>{const e=this.state.submitting,t=this.props.subscriptionPlans,n=t&&t[0]&&t[0].price;return s.createElement("div",{className:"boxed-group-inner"},this.state.ready&&s.createElement(s.Fragment,null,s.createElement(ge,{almApplication:this.props.almApplication,almOrganization:this.props.almOrganization,onChange:this.handlePlanChange,plan:this.state.plan,startingPrice:n}),this.state.plan===pe.Paid?s.createElement(be,{onCommit:this.props.onDone,onFailToUpgrade:this.props.onUpgradeFail,organizationKey:this.props.createOrganization,subscriptionPlans:this.props.subscriptionPlans},e=>{let t=e.onSubmit,n=e.renderFormFields,a=e.renderSubmitGroup;return s.createElement("form",{id:"organization-paid-plan-form",onSubmit:t},n(),s.createElement("div",{className:"billing-input-large big-spacer-top"},a(Object(g.translate)("onboarding.create_organization.create_and_upgrade"))))}):s.createElement("form",{className:"display-flex-center big-spacer-top",id:"organization-free-plan-form",onSubmit:this.handleFreePlanSubmit},s.createElement(F.SubmitButton,{disabled:e},Object(g.translate)("my_account.create_organization")),e&&s.createElement(h.a,{className:"spacer-left"}))))},this.state={plan:e.almOrganization&&e.almOrganization.privateRepos>0?pe.Paid:pe.Free,ready:!1,submitting:!1}}componentDidMount(){this.mounted=!0,Object(ie.a)("billing/billing").then(()=>{this.mounted&&this.setState({ready:!0})},()=>{})}componentWillUnmount(){this.mounted=!1}render(){const e=this.props.almOrganization,t=Object(g.translate)(e&&e.privateRepos>0&&0===e.publicRepos?"onboarding.create_organization.enter_payment_details":"onboarding.create_organization.choose_plan");return s.createElement(te.a,{finished:!1,onOpen:()=>{},open:this.props.open,renderForm:this.renderForm,renderResult:()=>null,stepNumber:2,stepTitle:t})}}var fe;!function(e){e.Bind="bind",e.Create="create"}(fe||(fe={}));class ve extends s.PureComponent{constructor(e){super(e),this.handleBindOrganization=e=>Object(v.a)({organization:e,installationId:this.props.almInstallId}).then(()=>this.props.onOrgCreated(e)),this.handleCreateOrganization=()=>{const e=this.props,t=e.almApplication,n=e.almOrganization,a=e.organization;return a?this.props.createOrganization(Object.assign({},a,{alm:{key:t.key,membersSync:!0,personal:n.personal,url:n.almUrl},installationId:this.props.almInstallId})):Promise.reject()},this.handleOptionChange=e=>{this.setState({filter:e})},this.state={filter:0===e.unboundOrganizations.length?fe.Create:void 0}}render(){const e=this.props,t=e.almApplication,n=e.almOrganization,a=e.className,i=e.organization,r=e.step,o=e.subscriptionPlans,l=e.unboundOrganizations,c=this.state.filter,d=l.length>0,p=Object(N.g)(t.key);return s.createElement("div",{className:a},s.createElement(ne,{finished:void 0!==i,onOpen:this.props.handleOrgDetailsStepOpen,open:r===le.e.OrganizationDetails,organization:i,stepTitle:Object(g.translate)("onboarding.import_organization.import_org_details")},s.createElement("div",{className:"huge-spacer-bottom"},s.createElement("p",{className:"display-flex-center big-spacer-bottom"},s.createElement(U.FormattedMessage,{defaultMessage:Object(g.translate)("onboarding.import_organization_x"),id:"onboarding.import_organization_x",values:{avatar:s.createElement("img",{alt:t.name,className:"little-spacer-left",src:"".concat(Object(K.getBaseUrl)(),"/images/sonarcloud/").concat(Object(N.g)(t.key),".svg"),width:16}),name:s.createElement("strong",null,n.name)}}),s.createElement(F.ClearButton,{className:"little-spacer-left",onClick:this.props.handleCancelImport})),d&&s.createElement(D.a,{name:"filter",onCheck:this.handleOptionChange,options:[{label:Object(g.translate)("onboarding.import_organization.create_new"),value:fe.Create},{label:Object(g.translate)("onboarding.import_organization.bind_existing"),value:fe.Bind}],value:c})),c===fe.Create&&s.createElement(Y,{infoBlock:Object(N.e)(p)&&s.createElement(B.Alert,{className:"abs-width-600 big-spacer-top",display:"block",variant:"info"},s.createElement("p",null,Object(g.translateWithParameters)("onboarding.import_organization.members_sync_info_x",Object(g.translate)("organization",p),n.name,Object(g.translate)(p))),s.createElement("a",{href:Object(N.a)(t.key,n.almUrl),rel:"noopener noreferrer",target:"_blank"},Object(g.translateWithParameters)("organization.members.see_all_members_on_x",Object(g.translate)(p)))),onContinue:this.props.handleOrgDetailsFinish,organization:n,submitText:Object(g.translate)("continue")}),c===fe.Bind&&s.createElement(M,{almKey:p,onBindOrganization:this.handleBindOrganization,unboundOrganizations:l})),void 0!==o&&c!==fe.Bind&&s.createElement(Oe,{almApplication:this.props.almApplication,almOrganization:this.props.almOrganization,createOrganization:this.handleCreateOrganization,onDone:this.props.onDone,onUpgradeFail:this.props.onUpgradeFail,open:r===le.e.Plan,subscriptionPlans:o}))}}class ze extends s.PureComponent{constructor(){super(...arguments),this.handleCreateOrganization=()=>{const e=this.props.organization;return e?this.props.createOrganization(e):Promise.reject()}}render(){const e=this.props,t=e.className,n=e.organization,a=e.subscriptionPlans;return s.createElement("div",{className:t},s.createElement(ne,{finished:void 0!==n,onOpen:this.props.handleOrgDetailsStepOpen,open:this.props.step===le.e.OrganizationDetails,organization:n},s.createElement(Y,{onContinue:this.props.handleOrgDetailsFinish,organization:n,submitText:Object(g.translate)("continue")})),void 0!==a&&s.createElement(Oe,{createOrganization:this.handleCreateOrganization,onDone:this.props.onDone,onUpgradeFail:this.props.onUpgradeFail,open:this.props.step===le.e.Plan,subscriptionPlans:a}))}}var je=n(324),_e=n.n(je),Ee=n(620),ye=n.n(Ee),Se=n(338),Ne=n.n(Se);var ke=Object(d.withRouter)(class extends s.PureComponent{constructor(){super(...arguments),this.state={unboundInstallationId:""},this.handleSubmit=e=>{e.preventDefault();const t=this.state.unboundInstallationId;t&&this.props.router.push({pathname:"/create-organization",query:Object(le.h)({almInstallId:t,almKey:this.props.almApplication.key})})},this.handleInstallAppClick=()=>{Object(O.save)(le.c,Date.now().toString(10))},this.handleInstallationChange=e=>{let t=e.installationId;this.setState({unboundInstallationId:t})},this.renderOption=e=>{const t=this.props.almApplication;return s.createElement("span",null,s.createElement("img",{alt:t.name,className:"spacer-right",height:14,src:"".concat(Object(K.getBaseUrl)(),"/images/sonarcloud/").concat(Object(N.g)(t.key),".svg")}),e.name)}}render(){const e=this.props,t=e.almApplication,n=e.almInstallId,a=e.almOrganization,i=e.almUnboundApplications,o=e.boundOrganization,l=e.className,c=this.state.unboundInstallationId;return s.createElement("div",{className:r("boxed-group",l)},s.createElement("div",{className:"boxed-group-header"},s.createElement("h2",null,Object(g.translate)("onboarding.import_organization.import_org_details"))),s.createElement("div",{className:"boxed-group-inner"},n&&!a&&s.createElement(B.Alert,{className:"big-spacer-bottom width-60",variant:"error"},s.createElement("div",{className:"markdown"},Object(g.translate)("onboarding.import_organization.org_not_found"),s.createElement("ul",null,s.createElement("li",null,Object(g.translate)("onboarding.import_organization.org_not_found.tips_1")),s.createElement("li",null,Object(g.translate)("onboarding.import_organization.org_not_found.tips_2"))))),a&&o&&s.createElement(B.Alert,{className:"big-spacer-bottom width-60",variant:"error"},s.createElement(U.FormattedMessage,{defaultMessage:Object(g.translate)("onboarding.import_organization.already_bound_x"),id:"onboarding.import_organization.already_bound_x",values:{avatar:s.createElement("img",{alt:t.name,className:"little-spacer-left",src:"".concat(Object(K.getBaseUrl)(),"/images/sonarcloud/").concat(Object(N.g)(t.key),".svg"),width:16}),name:s.createElement("strong",null,a.name),boundAvatar:s.createElement(J.a,{className:"little-spacer-left",organization:o,small:!0}),boundName:s.createElement("strong",null,o.name)}})),s.createElement("div",{className:"display-flex-center"},s.createElement("div",{className:"display-inline-block"},s.createElement(ye.a,{backgroundColor:t.backgroundColor,className:"display-inline-block",iconPath:t.iconPath,name:t.name,onClick:this.handleInstallAppClick,small:!0,url:t.installationUrl},Object(g.translate)("onboarding.import_organization.choose_organization_button",t.key))),i.length>0&&s.createElement("div",{className:"display-flex-stretch"},s.createElement("div",{className:"vertical-pipe-separator"},s.createElement("div",{className:"vertical-separator "}),s.createElement("span",{className:"note"},Object(g.translate)("or")),s.createElement("div",{className:"vertical-separator"})),s.createElement("form",{className:"big-spacer-top big-spacer-bottom",onSubmit:this.handleSubmit},s.createElement("div",{className:"form-field abs-width-400"},s.createElement("label",{className:"text-normal",htmlFor:"select-unbound-installation"},Object(g.translateWithParameters)("onboarding.import_organization.choose_unbound_installation_x",Object(g.translate)(Object(N.g)(t.key)))),s.createElement(Ne.a,{className:"input-super-large",clearable:!1,id:"select-unbound-installation",labelKey:"name",onChange:this.handleInstallationChange,optionRenderer:this.renderOption,options:_e()(i,e=>e.name.toLowerCase()),placeholder:Object(g.translate)("onboarding.import_organization.choose_organization"),value:c,valueKey:"installationId",valueRenderer:this.renderOption})),s.createElement(F.SubmitButton,{disabled:!c},Object(g.translate)("continue")))))))}});n.d(t,"CreateOrganization",function(){return Ce});class Ce extends s.PureComponent{constructor(){var e;super(...arguments),e=this,this.mounted=!1,this.state={almOrgLoading:!1,almUnboundApplications:[],bindingExistingOrg:!1,loading:!0,step:le.e.OrganizationDetails},this.deleteOrganization=()=>{this.state.organization&&this.props.deleteOrganization(this.state.organization.key)},this.fetchAlmApplication=()=>Object(v.b)().then(e=>{let t=e.application;this.mounted&&this.setState({almApplication:t})}),this.fetchAlmOrganization=e=>(this.setState({almOrgLoading:!0}),Object(v.c)({installationId:e}).then(e=>{let t=e.almOrganization,n=e.boundOrganization;return n?Promise.resolve({almOrganization:t,boundOrganization:n}):this.setValidOrgKey(t)}).then(e=>{let t=e.almOrganization,n=e.boundOrganization;this.mounted&&(n&&n.key&&!this.isStoredTimestampValid(le.c)?this.props.router.push({pathname:Object(k.p)(n.key)}):this.setState({almOrganization:t,almOrgLoading:!1,boundOrganization:n}))},()=>{this.mounted&&this.setState({almOrgLoading:!1})})),this.fetchAlmUnboundApplications=()=>Object(v.f)().then(e=>{this.mounted&&this.setState({almUnboundApplications:e})}),this.fetchSubscriptionPlans=()=>Object(z.a)().then(e=>{this.mounted&&this.setState({subscriptionPlans:e})}),this.handleCancelImport=()=>{this.updateUrlQuery({almInstallId:void 0,almKey:void 0})},this.handleOrgCreated=e=>{this.props.skipOnboarding(),this.isStoredTimestampValid(le.d)?this.props.router.push({pathname:"/projects/create",state:{organization:e,tab:this.state.almOrganization?"auto":"manual"}}):this.props.router.push({pathname:Object(k.p)(e)})},this.handleOrgDetailsFinish=e=>(this.setState({organization:e,step:le.e.Plan}),Promise.resolve()),this.handleOrgDetailsStepOpen=()=>{this.setState({step:le.e.OrganizationDetails})},this.handlePlanDone=()=>{this.state.organization&&this.handleOrgCreated(this.state.organization.key)},this.isStoredTimestampValid=e=>{const t=Object(O.get)(e);return Object(O.remove)(e),t&&o(Date.now(),Number(t))<10},this.onTabChange=e=>{this.updateUrlState({tab:e})},this.getHeader=e=>e?Object(g.translate)("onboarding.binding_organization"):Object(g.translate)("onboarding.create_organization.page.header"),this.setValidOrgKey=e=>{const t=Object(f.slugify)(e.key),n=[t,...i()(9,e=>"".concat(t,"-").concat(e+1))];return j.g({organizations:n.join(",")}).then(e=>{let a=e.organizations;return n.find(e=>!a.find(t=>t.key===e))||"".concat(t,"-").concat(Math.ceil(1e3*Math.random())+10)},()=>t).then(t=>({almOrganization:Object.assign({},e,{key:t})}))},this.stopLoading=()=>{this.mounted&&this.setState({loading:!1})},this.updateUrlQuery=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.props.router.push({pathname:e.props.location.pathname,query:Object(le.h)(Object.assign({},Object(le.g)(e.props.location.query),t)),state:e.props.location.state})},this.updateUrlState=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.props.router.replace({pathname:e.props.location.pathname,query:e.props.location.query,state:Object.assign({},e.props.location.state||{},t)})},this.renderContent=e=>{const t=this.props.location,n=this.state,a=n.organization,i=n.step,o=n.subscriptionPlans,l=(t.state||{}).tab,c=void 0===l?"auto":l,d={handleOrgDetailsFinish:this.handleOrgDetailsFinish,handleOrgDetailsStepOpen:this.handleOrgDetailsStepOpen,onDone:this.handlePlanDone,organization:a,step:i,subscriptionPlans:o};if(!this.hasAutoImport(n))return s.createElement(ze,Object.assign({},d,{createOrganization:this.props.createOrganization,onUpgradeFail:this.deleteOrganization,organization:this.state.organization,step:this.state.step}));const p=n.almApplication,u=n.almOrganization,h=n.boundOrganization;return s.createElement(s.Fragment,null,s.createElement(m.a,{onChange:this.onTabChange,selected:c||"auto",tabs:[{key:"auto",node:Object(g.translateWithParameters)("onboarding.import_organization.import_from_x",Object(g.translate)(Object(N.g)(p.key)))},{key:"manual",node:Object(g.translate)("onboarding.create_organization.create_manually")}]}),s.createElement(ze,Object.assign({},d,{className:r({hidden:"manual"!==c&&this.hasAutoImport(n)}),createOrganization:this.props.createOrganization,onUpgradeFail:this.deleteOrganization})),e&&u&&!h?s.createElement(ve,Object.assign({},d,{almApplication:p,almInstallId:e,almOrganization:u,className:r({hidden:"auto"!==c}),createOrganization:this.props.createOrganization,handleCancelImport:this.handleCancelImport,onOrgCreated:this.handleOrgCreated,onUpgradeFail:this.deleteOrganization,unboundOrganizations:this.props.userOrganizations.filter(e=>{let t=e.actions,n=void 0===t?{}:t;return!e.alm&&n.admin})})):s.createElement(ke,{almApplication:p,almInstallId:e,almOrganization:u,almUnboundApplications:n.almUnboundApplications,boundOrganization:h,className:r({hidden:"auto"!==c})}))}}componentDidMount(){this.mounted=!0,Object(b.addWhitePageClass)();const e=Object(le.g)(this.props.location.query);if(Object(N.c)(this.props.currentUser)&&e.almInstallId&&this.isStoredTimestampValid(le.b))this.bindAndRedirectToOrganizationSettings(e.almInstallId);else{const t=[this.fetchSubscriptionPlans()];Object(N.c)(this.props.currentUser)&&(t.push(this.fetchAlmApplication()),e.almInstallId?this.fetchAlmOrganization(e.almInstallId):t.push(this.fetchAlmUnboundApplications())),Promise.all(t).then(this.stopLoading,this.stopLoading)}}componentDidUpdate(e){const t=Object(le.g)(e.location.query),n=Object(le.g)(this.props.location.query);this.state.almApplication&&t.almInstallId!==n.almInstallId&&(n.almInstallId?this.fetchAlmOrganization(n.almInstallId):(this.setState({almOrganization:void 0,boundOrganization:void 0,loading:!0}),this.fetchAlmUnboundApplications().then(this.stopLoading,this.stopLoading)))}componentWillUnmount(){this.mounted=!1,Object(b.removeWhitePageClass)()}hasAutoImport(e){return Boolean(e.almApplication)}bindAndRedirectToOrganizationSettings(e){const t=Object(O.get)(le.a)||"";Object(O.remove)(le.a),this.setState({bindingExistingOrg:!0}),Object(v.a)({installationId:e,organization:t}).then(()=>{this.props.router.push({pathname:"/organizations/".concat(t)}),Object(E.a)(Object(g.translate)("organization.bind.success"))},()=>{})}render(){const e=this.props.location,t=Object(le.g)(e.query);if(this.state.almOrgLoading)return s.createElement(A,{almKey:t.almKey});const n=this.state,a=n.bindingExistingOrg,i=n.subscriptionPlans,r=this.getHeader(a),o=i&&i[0]&&i[0].price;return s.createElement(s.Fragment,null,s.createElement(l.Helmet,{title:r,titleTemplate:"%s"}),s.createElement("div",{className:"page page-limited huge-spacer-top huge-spacer-bottom"},s.createElement(_.a,{anchor:"create_org_main"}),s.createElement("header",{className:"page-header huge-spacer-bottom"},s.createElement("h1",{className:"page-title huge big-spacer-bottom"},s.createElement("strong",null,r)),void 0!==o&&s.createElement("p",{className:"page-description"},Object(g.translate)("onboarding.create_organization.page.description"))),this.state.loading?s.createElement(h.a,null):this.renderContent(t.almInstallId)))}}const xe={createOrganization:function(e){var t=e.alm,n=I(e,["alm"]);return e=>j.b(Object.assign({},n,{name:n.name||n.key})).then(n=>(e(P.a(Object.assign({},n,{alm:t}))),t&&t.membersSync&&!t.personal&&Object(N.e)(t.key)&&j.l(n.key),n.key))},deleteOrganization:x.a,skipOnboarding:C.g};t.default=Object(y.a)(Object(S.a)(Object(d.withRouter)(Object(c.connect)(null,xe)(Ce))))},343:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(2),i=n(5),r=n(399);function o(e){return a.createElement(r.a.Consumer,null,t=>{let n=t.addA11ySkipLink,i=t.removeA11ySkipLink;return a.createElement(s,Object.assign({addA11ySkipLink:n,removeA11ySkipLink:i},e))})}class s extends a.PureComponent{constructor(){super(...arguments),this.getLink=()=>{const e=this.props,t=e.anchor,n=e.label;return{key:t,label:void 0===n?Object(i.translate)("skip_to_content"):n,weight:e.weight}}}componentDidMount(){this.props.addA11ySkipLink(this.getLink())}componentWillUnmount(){this.props.removeA11ySkipLink(this.getLink())}render(){const e=this.props.anchor;return a.createElement("span",{id:"a11y_target__".concat(e)})}}},350:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"e",function(){return l}),n.d(t,"f",function(){return c}),n.d(t,"g",function(){return d});var a=n(329);function i(e,t){return t.endsWith("/")||(t+="/"),l(e)?t.replace("github.com/","github.com/orgs/")+"people":t+"profile/members"}function r(e){return Object(a.b)(e)&&e.externalProvider?d(e.externalProvider):void 0}function o(e){return Object(a.b)(e)&&(s(e.externalProvider)||l(e.externalProvider))}function s(e){return!!e&&e.startsWith("bitbucket")}function l(e){return"github"===e}function c(e){return"microsoft"===e}function d(e){return s(e)?"bitbucket":e}},383:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return s});var a=n(322),i=n(14);let r=!1;function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"body";return new Promise(n=>{const i=document.createElement("script");i.src="".concat(Object(a.getBaseUrl)()).concat(e),i.onload=n,document.getElementsByTagName(t)[0].appendChild(i)})}async function s(e){const t=Object(i.a)(e);if(t)return Promise.resolve(t);if(!r){(0,(await Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(281)]).then(n.bind(null,507))).default)(),r=!0}await o("/static/".concat(e,".js"));const a=Object(i.a)(e);return a||Promise.reject()}},421:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(378),i=n(381);function r(e){Object(i.default)().dispatch(a.b(e))}},427:function(e,t,n){"use strict";n.d(t,"c",function(){return d}),n.d(t,"d",function(){return p}),n.d(t,"a",function(){return m}),n.d(t,"b",function(){return u}),n.d(t,"e",function(){return h}),n.d(t,"f",function(){return g}),n.d(t,"g",function(){return b}),n.d(t,"h",function(){return O});var a=n(497),i=n.n(a),r=n(5),o=n(318),s=n(410),l=n(512),c=n(350);const d="sonarcloud.import_org.binding_in_progress",p="sonarcloud.import_org.redirect_to_projects",m="sonarcloud.bind_org.key",u="sonarcloud.bind_org.redirect_to_org";var h;function g(e,t){const n=Object(o.formatMeasure)(e,"FLOAT").replace(/[.|,]0$/,"").replace(/([.|,]\d)$/,"$10");return t?n:Object(r.translateWithParameters)("billing.price_format",n)}!function(e){e[e.OrganizationDetails=0]="OrganizationDetails",e[e.Plan=1]="Plan"}(h||(h={}));const b=i()(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=void 0,n=void 0;if(e.installation_id)n="github",t=Object(s.parseAsOptionalString)(e.installation_id);else if(e.clientKey)n="bitbucket",t=Object(s.parseAsOptionalString)(e.clientKey);else if(e.jwt){const a=Object(l.decodeJwt)(e.jwt);a&&a.iss&&(n="bitbucket",t=a.iss)}return{almInstallId:t,almKey:n}}),O=e=>Object(s.cleanQuery)({installation_id:Object(c.e)(e.almKey)?Object(s.serializeString)(e.almInstallId):void 0,clientKey:Object(c.d)(e.almKey)?Object(s.serializeString)(e.almInstallId):void 0})},480:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(2),i=n(31),r=n.n(i),o=n(329),s=n(393),l=n(438);function c(e){class t extends a.Component{componentDidMount(){Object(o.b)(this.props.currentUser)||r()()}render(){return Object(o.b)(this.props.currentUser)?a.createElement(e,Object.assign({},this.props)):null}}return t.displayName=Object(s.a)(e,"whenLoggedIn"),Object(l.a)(t)}},548:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"e",function(){return l}),n.d(t,"f",function(){return c}),n.d(t,"g",function(){return d}),n.d(t,"d",function(){return p});var a=n(8),i=n(320);function r(e){return Object(a.post)("/api/alm_integration/bind_organization",e).catch(i.a)}function o(){return Object(a.getJSON)("/api/alm_integration/show_app_info").catch(i.a)}function s(e){return Object(a.requestTryAndRepeatUntil)(()=>Object(a.getJSON)("/api/alm_integration/show_organization",e),{max:25,slowThreshold:20},()=>!0,[404]).catch(i.a).then(e=>{let t=e.almOrganization,n=e.boundOrganization;return{almOrganization:Object.assign({},t,{name:t.name||t.key}),boundOrganization:n}})}function l(e){return Object(a.getJSON)("/api/alm_integration/list_repositories",e).catch(i.a)}function c(){return Object(a.getJSON)("/api/alm_integration/list_unbound_applications").then(e=>{return e.applications.map(e=>Object.assign({},e,{name:e.name||e.key}))},i.a)}function d(e){return Object(a.postJSON)("/api/alm_integration/provision_projects",Object.assign({},e,{installationKeys:e.installationKeys.join(",")})).catch(i.a)}function p(e){const t=e.replace("https://github.com/","https://api.github.com/repos/");return Object(a.getCorsJSON)("".concat(t,"/languages"))}},549:function(e,t,n){var a=n(566);"string"==typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(313)(a,i);a.locals&&(e.exports=a.locals)},551:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(309),i=n(2);function r(e){const t=a("boxed-group","onboarding-step",{"is-open":e.open,"is-finished":e.finished}),n=!e.open&&e.finished;return i.createElement("div",{className:t,onClick:n?t=>{t.preventDefault(),e.onOpen()}:void 0,role:n?"button":void 0,tabIndex:n?0:void 0},i.createElement("div",{className:"onboarding-step-number"},e.stepNumber),!e.open&&e.renderResult(),i.createElement("div",{className:"boxed-group-header"},i.createElement("h2",null,e.stepTitle)),!e.open&&i.createElement("div",{className:"boxed-group-inner"}),i.createElement("div",{className:a({hidden:!e.open})},e.renderForm()))}},552:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(2),i=n(483),r=n.n(i),o=n(5),s=n(334);const l=14;function c(){return a.createElement("ul",{className:"note"},a.createElement(d,null,Object(o.translate)("billing.upgrade_box.unlimited_private_projects")),a.createElement(d,null,Object(o.translate)("billing.upgrade_box.strict_control_private_data")),a.createElement(d,null,Object(o.translate)("billing.upgrade_box.cancel_anytime")),a.createElement(d,null,a.createElement("strong",null,Object(o.translateWithParameters)("billing.upgrade_box.free_trial_x",l))))}function d(e){let t=e.children;return a.createElement("li",{className:"display-flex-center little-spacer-bottom"},a.createElement(r.a,{className:"spacer-right",fill:s.colors.lightGreen}),t)}},564:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o});var a=n(8),i=n(320);function r(){return Object(a.getJSON)("/api/billing/show_subscription_plans").then(e=>{return e.subscriptionPlans},i.a)}function o(e){return Object(a.post)("/api/billing/send_feedback",e)}},565:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var a=n(2),i=n(316),r=n(617),o=n(317),s=n(393);function l(e){class t extends a.Component{componentDidMount(){this.props.fetchMyOrganizations()}render(){return a.createElement(e,Object.assign({},this.props))}}t.displayName=Object(s.a)(e,"withUserOrganizations");const n={fetchMyOrganizations:r.b};return Object(i.connect)(function(e){return{userOrganizations:Object(o.getMyOrganizations)(e)}},n)(t)}},566:function(e,t,n){(e.exports=n(312)(!1)).push([e.i,".onboarding-step{position:relative;padding-left:34px}.onboarding-step:not(.is-open):not(.is-finished){opacity:.4}.onboarding-step .boxed-group-actions{height:24px;line-height:24px}.onboarding-step hr{margin-left:-54px}.onboarding-step-number{position:absolute;top:15px;left:15px;width:24px;height:24px;line-height:24px;border-radius:24px;background-color:#b9b9b9;color:#fff;font-size:14px;text-align:center}.onboarding-step.is-open .onboarding-step-number{background-color:#236a97}.onboarding-step.is-finished{cursor:pointer;outline:none}",""])},619:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(2);class i extends a.Component{render(){const e=window.SonarBilling.BillingForm;return a.createElement(e,Object.assign({},this.props))}}},790:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return l});var a=n(5),i=n(418),r=n(378),o=n(591);function s(e,t){return n=>i.m(e,t).then(()=>{n(o.h(e,t)),n(Object(r.b)(Object(a.translate)("organization.updated")))})}function l(e){return t=>i.c(e).then(()=>{t(o.c(e))})}},853:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var a=n(324),i=n.n(a),r=n(2),o=n(338),s=n.n(o),l=n(5),c=n(322),d=n(350);function p(e){let t=e.hideIcons,n=e.onChange,a=e.organization,o=e.organizations;const p=function(e){return function(t){const n=t.alm?"sonarcloud/".concat(Object(d.g)(t.alm.key)):"sonarcloud-square-logo",a="PAID"===t.subscription;return r.createElement("div",{className:"display-flex-space-between"},r.createElement("span",{className:"text-ellipsis flex-1"},!e&&r.createElement("img",{alt:t.alm?t.alm.key:"SonarCloud",className:"little-spacer-right",height:14,src:"".concat(Object(c.getBaseUrl)(),"/images/").concat(n,".svg")}),t.name,r.createElement("span",{className:"note little-spacer-left"},t.key)),a&&r.createElement("div",{className:"badge"},Object(l.translate)("organization.paid_plan.badge")))}}(t);return r.createElement(s.a,{autoFocus:!a,className:"input-super-large",clearable:!1,id:"select-organization",labelKey:"name",onChange:n,optionRenderer:p,options:i()(o,e=>e.name.toLowerCase()),placeholder:Object(l.translate)("onboarding.import_organization.choose_organization"),required:!0,value:a,valueKey:"key",valueRenderer:p})}}}]);
//# sourceMappingURL=306.m.6f14da8f.chunk.js.map