(window.webpackJsonp=window.webpackJsonp||[]).push([[311],{1370:function(e,t,a){var n=a(1371);"string"==typeof n&&(n=[[e.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};a(313)(n,s);n.locals&&(e.exports=n.locals)},1371:function(e,t,a){(e.exports=a(312)(!1)).push([e.i,".bt-search-form{display:flex;align-items:flex-end}.bt-search-form>li+li{margin-left:16px}.bt-search-form-label{margin-bottom:4px}.bt-search-form-field{padding:4px 0}.bt-search-form-large{flex:1}.bt-workers-warning-icon{margin-top:5px}.emphasised-measure{font-size:24px;font-weight:300}",""])},1763:function(e,t,a){"use strict";a.r(t);var n=a(458),s=a.n(n),r=a(362),o=a.n(r),l=a(2),c=a(325),i=a.n(c),u=a(316),d=a(29),m=a(5),p=a(410),h=a(568),g=a(330),b=a(409),k=(a(1370),a(498));function E(e,t){return e.map(e=>e.id===t.id?t:e)}const f=1e3,C=60*f,y=60*C;function O(e,t){return"".concat(e).concat(t)}const N=1e3;function S(e){return e.tasks.length<N?null:l.createElement("footer",{className:"spacer-top note text-center"},Object(m.translateWithParameters)("max_results_reached",N))}var v=a(28),_=a(310),x=a(323),j=a.n(x),D=a(314),w=a.n(D),A=a(778),P=a.n(A);function T(){return l.createElement(l.Fragment,null,l.createElement("p",{className:"spacer-bottom"},l.createElement("strong",null,Object(m.translate)("background_tasks.add_more_workers"))),l.createElement("p",{className:"big-spacer-bottom markdown"},Object(m.translate)("background_tasks.add_more_workers.text")),l.createElement("p",null,l.createElement("a",{href:"https://redirect.sonarsource.com/editions/enterprise.html",rel:"noopener noreferrer",target:"_blank"},Object(m.translate)("learn_more"))))}var L=a(327),I=a.n(L),R=a(338),F=a.n(R),M=a(326);const q=10;class U extends l.PureComponent{constructor(e){super(e),this.mounted=!1,this.handleClose=()=>{this.props.onClose()},this.handleWorkerCountChange=e=>this.setState({newWorkerCount:e.value}),this.handleSubmit=e=>{e.preventDefault(),this.setState({submitting:!0});const t=this.state.newWorkerCount;Object(h.j)(t).then(()=>{this.mounted&&this.props.onClose(t)},()=>{this.mounted&&this.setState({submitting:!1})})},this.state={newWorkerCount:e.workerCount,submitting:!1}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const e=[];for(let t=1;t<=q;t++)e.push({label:String(t),value:t});return l.createElement(I.a,{contentLabel:Object(m.translate)("background_tasks.change_number_of_workers"),onRequestClose:this.handleClose},l.createElement("header",{className:"modal-head"},l.createElement("h2",null,Object(m.translate)("background_tasks.change_number_of_workers"))),l.createElement("form",{onSubmit:this.handleSubmit},l.createElement("div",{className:"modal-body"},l.createElement(F.a,{className:"input-tiny spacer-top",clearable:!1,onChange:this.handleWorkerCountChange,options:e,searchable:!1,value:this.state.newWorkerCount}),l.createElement(M.Alert,{className:"big-spacer-top",variant:"info"},Object(m.translate)("background_tasks.change_number_of_workers.hint"))),l.createElement("footer",{className:"modal-foot"},l.createElement("div",null,this.state.submitting&&l.createElement("i",{className:"spinner spacer-right"}),l.createElement(_.SubmitButton,{disabled:this.state.submitting},Object(m.translate)("save")),l.createElement(_.ResetButtonLink,{onClick:this.handleClose},Object(m.translate)("cancel"))))))}}class W extends l.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={canSetWorkerCount:!1,formOpen:!1,loading:!0,noSupportPopup:!1,workerCount:1},this.loadWorkers=()=>{this.setState({loading:!0}),Object(h.i)().then(e=>{let t=e.canSetWorkerCount,a=e.value;this.mounted&&this.setState({canSetWorkerCount:t,loading:!1,workerCount:a})},()=>{this.mounted&&this.setState({loading:!1})})},this.closeForm=e=>e?this.setState({formOpen:!1,workerCount:e}):this.setState({formOpen:!1}),this.handleChangeClick=()=>{this.setState({formOpen:!0})},this.handleHelpClick=e=>{e.preventDefault(),e.stopPropagation(),this.toggleNoSupportPopup()},this.toggleNoSupportPopup=e=>{void 0!==e?this.setState({noSupportPopup:e}):this.setState(e=>({noSupportPopup:!e.noSupportPopup}))}}componentDidMount(){this.mounted=!0,this.loadWorkers()}componentWillUnmount(){this.mounted=!1}render(){const e=this.state,t=e.canSetWorkerCount,a=e.formOpen,n=e.loading,s=e.workerCount;return l.createElement("div",{className:"display-flex-center"},!n&&s>1&&l.createElement(w.a,{overlay:Object(m.translate)("background_tasks.number_of_workers.warning")},l.createElement("span",{className:"display-inline-flex-center little-spacer-right"},l.createElement(P.a,{fill:"#d3d3d3"}))),l.createElement("span",{className:"text-middle"},Object(m.translate)("background_tasks.number_of_workers"),n?l.createElement("i",{className:"spinner little-spacer-left"}):l.createElement("strong",{className:"little-spacer-left"},s)),!n&&t&&l.createElement(w.a,{overlay:Object(m.translate)("background_tasks.change_number_of_workers")},l.createElement(_.EditButton,{className:"js-edit button-small spacer-left",onClick:this.handleChangeClick})),!n&&!t&&l.createElement(j.a,{className:"spacer-left",overlay:l.createElement(T,null)}),a&&l.createElement(U,{onClose:this.closeForm,workerCount:this.state.workerCount}))}}function z(e){return l.createElement("header",{className:"page-header"},l.createElement("h1",{className:"page-title"},Object(m.translate)("background_tasks.page")),!e.component&&l.createElement("div",{className:"page-actions"},l.createElement(W,null)),l.createElement("p",{className:"page-description"},Object(m.translate)("background_tasks.page.description"),l.createElement(v.Link,{className:"spacer-left",target:"_blank",to:{pathname:"/documentation/analysis/background-tasks/"}},Object(m.translate)("learn_more"))))}var B=a(358),G=a.n(B),Y=a(359),J=a.n(Y);class H extends l.PureComponent{constructor(){super(...arguments),this.handleChange=e=>{const t=e?k.b.ONLY_CURRENTS:k.b.ALL;this.props.onChange(t)}}render(){const e=this.props.value===k.b.ONLY_CURRENTS;return l.createElement("div",{className:"bt-search-form-field"},l.createElement(J.a,{checked:e,onCheck:this.handleChange},l.createElement("span",{className:"little-spacer-left"},Object(m.translate)("yes"))))}}var K=a(629);class X extends l.PureComponent{constructor(){super(...arguments),this.handleDateRangeChange=e=>{let t=e.from,a=e.to;this.props.onChange({minSubmittedAt:t,maxExecutedAt:a})}}render(){const e={from:this.props.minSubmittedAt,to:this.props.maxExecutedAt};return l.createElement("div",{className:"nowrap"},l.createElement(K.a,{onChange:this.handleDateRangeChange,value:e}))}}class Q extends l.PureComponent{constructor(){super(...arguments),this.handleChange=e=>{let t=e.value;this.props.onChange(t)}}render(){const e=[{value:k.e.ALL,label:Object(m.translate)("background_task.status.ALL")},{value:k.e.ALL_EXCEPT_PENDING,label:Object(m.translate)("background_task.status.ALL_EXCEPT_PENDING")},{value:k.e.PENDING,label:Object(m.translate)("background_task.status.PENDING")},{value:k.e.IN_PROGRESS,label:Object(m.translate)("background_task.status.IN_PROGRESS")},{value:k.e.SUCCESS,label:Object(m.translate)("background_task.status.SUCCESS")},{value:k.e.FAILED,label:Object(m.translate)("background_task.status.FAILED")},{value:k.e.CANCELED,label:Object(m.translate)("background_task.status.CANCELED")}];return l.createElement(F.a,{className:"input-medium",clearable:!1,onChange:this.handleChange,options:e,searchable:!1,value:this.props.value})}}class V extends l.PureComponent{constructor(){super(...arguments),this.handleChange=e=>{let t=e.value;this.props.onChange(t)}}render(){const e=this.props,t=e.value,a=e.types.map(e=>({value:e,label:Object(m.translate)("background_task.type",e)})),n=[{value:k.a,label:Object(m.translate)("background_task.type.ALL")},...a];return l.createElement(F.a,{className:"input-medium",clearable:!1,onChange:this.handleChange,options:n,searchable:!1,value:t})}}class Z extends l.PureComponent{constructor(){super(...arguments),this.handleStatusChange=e=>{this.props.onFilterUpdate({status:e})},this.handleTypeChange=e=>{this.props.onFilterUpdate({taskType:e})},this.handleCurrentsChange=e=>{this.props.onFilterUpdate({currents:e})},this.handleDateChange=e=>{this.props.onFilterUpdate(e)},this.handleQueryChange=e=>{this.props.onFilterUpdate({query:e})},this.handleReset=()=>{this.props.onFilterUpdate(k.d)}}renderSearchBox(){const e=this.props,t=e.component,a=e.query;return t?null:l.createElement("li",{className:"bt-search-form-large"},l.createElement(G.a,{onChange:this.handleQueryChange,placeholder:Object(m.translate)("background_tasks.search_by_task_or_component"),value:a}))}render(){const e=this.props,t=e.loading,a=e.component,n=e.types,s=e.status,r=e.taskType,o=e.currents,c=e.minSubmittedAt,i=e.maxExecutedAt;return l.createElement("section",{className:"big-spacer-top big-spacer-bottom"},l.createElement("ul",{className:"bt-search-form"},l.createElement("li",null,l.createElement("h6",{className:"bt-search-form-label"},Object(m.translate)("status")),l.createElement(Q,{onChange:this.handleStatusChange,value:s})),n.length>1&&l.createElement("li",null,l.createElement("h6",{className:"bt-search-form-label"},Object(m.translate)("type")),l.createElement(V,{onChange:this.handleTypeChange,types:n,value:r})),!a&&l.createElement("li",null,l.createElement("h6",{className:"bt-search-form-label"},Object(m.translate)("background_tasks.currents_filter.ONLY_CURRENTS")),l.createElement(H,{onChange:this.handleCurrentsChange,value:o})),l.createElement("li",null,l.createElement("h6",{className:"bt-search-form-label"},Object(m.translate)("date")),l.createElement(X,{maxExecutedAt:i,minSubmittedAt:c,onChange:this.handleDateChange})),this.renderSearchBox(),l.createElement("li",{className:"nowrap"},l.createElement(_.Button,{className:"js-reload",disabled:t,onClick:this.props.onReload},Object(m.translate)("reload"))," ",l.createElement(_.Button,{disabled:t,onClick:this.handleReset},Object(m.translate)("reset_verb")))))}}var $=a(366),ee=a.n($),te=a(334),ae=a(317);var ne=Object(u.connect)(e=>({isSystemAdmin:Object(ae.getAppState)(e).canAdmin}))(function(e){let t=e.isSystemAdmin,a=e.onCancelAllPending,n=e.pendingCount;return void 0===n?null:l.createElement("span",null,l.createElement("span",{className:"emphasised-measure"},n),l.createElement("span",{className:"little-spacer-left display-inline-flex-center"},Object(m.translate)("background_tasks.pending"),t&&n>0&&l.createElement(ee.a,{cancelButtonText:Object(m.translate)("close"),confirmButtonText:Object(m.translate)("background_tasks.cancel_all_tasks.submit"),isDestructive:!0,modalBody:Object(m.translate)("background_tasks.cancel_all_tasks.text"),modalHeader:Object(m.translate)("background_tasks.cancel_all_tasks"),onConfirm:a},e=>{let t=e.onClick;return l.createElement(w.a,{overlay:Object(m.translate)("background_tasks.cancel_all_tasks")},l.createElement(_.ClearButton,{className:"little-spacer-left",color:te.colors.red,onClick:t}))})))}),se=a(318);const re=1e3;function oe(e){let t=e.className,a=e.pendingCount,n=e.pendingTime;return!n||!a||n<re?null:l.createElement("span",{className:t},l.createElement("span",{className:"emphasised-measure"},Object(se.formatMeasure)(n,"MILLISEC")),l.createElement("span",{className:"little-spacer-left"},Object(m.translate)("background_tasks.pending_time")),l.createElement(j.a,{className:"little-spacer-left",overlay:Object(m.translate)("background_tasks.pending_time.description")}))}function le(e){let t=e.className,a=e.failingCount,n=e.onShowFailing;return void 0===a?null:l.createElement("span",{className:t},a>0?l.createElement(_.ButtonLink,{className:"emphasised-measure text-baseline",onClick:n},a):l.createElement("span",{className:"emphasised-measure"},a),l.createElement("span",{className:"little-spacer-left"},Object(m.translate)("background_tasks.failures")),l.createElement(j.a,{className:"little-spacer-left",overlay:Object(m.translate)("background_tasks.failing_count")}))}var ce=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&(a[n[s]]=e[n[s]])}return a};function ie(e){var t=e.component,a=e.pendingCount,n=e.pendingTime,s=ce(e,["component","pendingCount","pendingTime"]);return l.createElement("section",{className:"big-spacer-top big-spacer-bottom"},l.createElement(ne,{onCancelAllPending:s.onCancelAllPending,pendingCount:a}),!t&&l.createElement(oe,{className:"huge-spacer-left",pendingCount:a,pendingTime:n}),!t&&l.createElement(le,{className:"huge-spacer-left",failingCount:s.failingCount,onShowFailing:s.onShowFailing}))}var ue=a(309),de=a(372),me=a.n(de),pe=a(341),he=a.n(pe),ge=a(321);class be extends l.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={},this.handleCloseClick=e=>{e.preventDefault(),this.props.onClose()}}componentDidMount(){this.mounted=!0,this.loadScannerContext()}componentWillUnmount(){this.mounted=!1}loadScannerContext(){Object(h.f)(this.props.task.id,["scannerContext"]).then(e=>{this.mounted&&this.setState({scannerContext:e.scannerContext})})}render(){const e=this.props.task,t=this.state.scannerContext;return l.createElement(I.a,{contentLabel:"scanner context",onRequestClose:this.props.onClose,size:"large"},l.createElement("div",{className:"modal-head"},l.createElement("h2",null,Object(m.translate)("background_tasks.scanner_context"),": ",e.componentName," [",Object(m.translate)("background_task.type",e.type),"]")),l.createElement("div",{className:"modal-body modal-container"},null!=t?l.createElement("pre",{className:"js-task-scanner-context"},t):l.createElement("i",{className:"spinner"})),l.createElement("div",{className:"modal-foot"},l.createElement("a",{className:"js-modal-close",href:"#",onClick:this.handleCloseClick},Object(m.translate)("close"))))}}class ke extends l.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={loading:!0},this.handleCloseClick=e=>{e.preventDefault(),this.props.onClose()}}componentDidMount(){this.mounted=!0,this.loadStacktrace()}componentWillUnmount(){this.mounted=!1}loadStacktrace(){Object(h.f)(this.props.task.id,["stacktrace"]).then(e=>{this.mounted&&this.setState({loading:!1,stacktrace:e.errorStacktrace})},()=>{this.mounted&&this.setState({loading:!1})})}render(){const e=this.props.task,t=this.state,a=t.loading,n=t.stacktrace;return l.createElement(I.a,{contentLabel:"stacktrace",onRequestClose:this.props.onClose,size:"large"},l.createElement("div",{className:"modal-head"},l.createElement("h2",null,Object(m.translate)("background_tasks.error_stacktrace"),": ",e.componentName," [",Object(m.translate)("background_task.type",e.type),"]")),l.createElement("div",{className:"modal-body modal-container"},a?l.createElement("i",{className:"spinner"}):n?l.createElement("div",null,l.createElement("h4",{className:"spacer-bottom"},Object(m.translate)("background_tasks.error_stacktrace")),l.createElement("pre",{className:"js-task-stacktrace"},n)):l.createElement("div",null,l.createElement("h4",{className:"spacer-bottom"},Object(m.translate)("background_tasks.error_message")),l.createElement("pre",{className:"js-task-error-message"},e.errorMessage))),l.createElement("div",{className:"modal-foot"},l.createElement("a",{className:"js-modal-close",href:"#",onClick:this.handleCloseClick},Object(m.translate)("close"))))}}const Ee=Object(ge.lazyLoad)(()=>a.e(367).then(a.bind(null,1706)),"AnalysisWarningsModal");class fe extends l.PureComponent{constructor(){super(...arguments),this.state={cancelTaskOpen:!1,scannerContextOpen:!1,stacktraceOpen:!1,warningsOpen:!1},this.handleFilterClick=()=>{this.props.onFilterTask(this.props.task)},this.handleCancelTask=()=>this.props.onCancelTask(this.props.task),this.handleCancelClick=()=>{this.setState({cancelTaskOpen:!0})},this.handleShowScannerContextClick=()=>{this.setState({scannerContextOpen:!0})},this.closeCancelTask=()=>{this.setState({cancelTaskOpen:!1})},this.closeScannerContext=()=>{this.setState({scannerContextOpen:!1})},this.handleShowStacktraceClick=()=>{this.setState({stacktraceOpen:!0})},this.closeStacktrace=()=>{this.setState({stacktraceOpen:!1})},this.handleShowWarningsClick=()=>{this.setState({warningsOpen:!0})},this.closeWarnings=()=>{this.setState({warningsOpen:!1})}}render(){const e=this.props,t=e.component,a=e.task,n=void 0===t,s=a.status===k.e.PENDING,r=void 0!==a.errorMessage,o=void 0!==a.warningCount&&a.warningCount>0;return n||s||a.hasScannerContext||r||o?l.createElement("td",{className:"thin nowrap"},l.createElement(me.a,{className:"js-task-action"},n&&a.componentName&&l.createElement(de.ActionsDropdownItem,{className:"js-task-filter",onClick:this.handleFilterClick},Object(m.translateWithParameters)("background_tasks.filter_by_component_x",a.componentName)),s&&l.createElement(de.ActionsDropdownItem,{className:"js-task-cancel",destructive:!0,onClick:this.handleCancelClick},Object(m.translate)("background_tasks.cancel_task")),a.hasScannerContext&&l.createElement(de.ActionsDropdownItem,{className:"js-task-show-scanner-context",onClick:this.handleShowScannerContextClick},Object(m.translate)("background_tasks.show_scanner_context")),r&&l.createElement(de.ActionsDropdownItem,{className:"js-task-show-stacktrace",onClick:this.handleShowStacktraceClick},Object(m.translate)("background_tasks.show_stacktrace")),o&&l.createElement(de.ActionsDropdownItem,{className:"js-task-show-warnings",onClick:this.handleShowWarningsClick},Object(m.translate)("background_tasks.show_warnings"))),this.state.cancelTaskOpen&&l.createElement(he.a,{cancelButtonText:Object(m.translate)("close"),confirmButtonText:Object(m.translate)("background_tasks.cancel_task"),header:Object(m.translate)("background_tasks.cancel_task"),isDestructive:!0,onClose:this.closeCancelTask,onConfirm:this.handleCancelTask},Object(m.translate)("background_tasks.cancel_task.text")),this.state.scannerContextOpen&&l.createElement(be,{onClose:this.closeScannerContext,task:a}),this.state.stacktraceOpen&&l.createElement(ke,{onClose:this.closeStacktrace,task:a}),this.state.warningsOpen&&l.createElement(Ee,{onClose:this.closeWarnings,taskId:a.id})):l.createElement("td",null," ")}}var Ce=a(405),ye=a.n(Ce),Oe=a(553),Ne=a.n(Oe),Se=a(346),ve=a.n(Se),_e=a(570),xe=a.n(_e),je=a(795),De=a(319);function we(e){let t=e.type;return l.createElement("span",{className:"display-inline-block note"},"[",Object(m.translate)("background_task.type",t),"]")}function Ae(e){let t=e.task;return t.componentKey?l.createElement("td",null,"SHORT"===t.branchType&&l.createElement(xe.a,{className:"little-spacer-right"}),"LONG"===t.branchType&&l.createElement(ye.a,{className:"little-spacer-right"}),void 0!==t.pullRequest&&l.createElement(Ne.a,{className:"little-spacer-right"}),!t.branchType&&!t.pullRequest&&t.componentQualifier&&l.createElement("span",{className:"little-spacer-right"},l.createElement(ve.a,{qualifier:t.componentQualifier})),t.organization&&l.createElement(je.a,{organizationKey:t.organization}),t.componentName&&l.createElement(v.Link,{className:"spacer-right",to:Pe(t.componentKey,t)},t.componentName,t.branch&&l.createElement("span",{className:"text-limited text-text-top",title:t.branch},l.createElement("span",{style:{marginLeft:5,marginRight:5}},"/"),t.branch),t.pullRequest&&l.createElement("span",{className:"text-limited text-text-top",title:t.pullRequestTitle},l.createElement("span",{style:{marginLeft:5,marginRight:5}},"/"),t.pullRequest)),l.createElement(we,{type:t.type})):l.createElement("td",null,l.createElement("span",{className:"note"},t.id),l.createElement(we,{type:t.type}))}function Pe(e,t){if(t.branch){if("SHORT"===t.branchType)return Object(De.z)(e,t.branch);if("LONG"===t.branchType)return Object(De.l)(e,t.branch)}else if(t.pullRequest)return Object(De.t)(e,t.pullRequest);return Object(De.s)(e)}var Te=a(595),Le=a(577);function Ie(e){let t=e.date,a=e.baseDate;const n=t&&Object(d.parseDate)(t),s=a&&Object(d.parseDate)(a),r=n&&s&&Object(d.isValidDate)(n)&&Object(d.isValidDate)(s)?Te(n,s):0;return l.createElement("td",{className:"thin nowrap text-right"},r>0&&l.createElement("span",{className:"text-warning little-spacer-right"},"(+".concat(r,"d)")),n&&Object(d.isValidDate)(n)?l.createElement(Le.a,{date:n,long:!0}):"")}var Re=a(630),Fe=a(342);function Me(e){let t=e.submittedAt,a=e.prevSubmittedAt;const n=!a||!Re(Object(d.parseDate)(t),Object(d.parseDate)(a));return l.createElement("td",{className:"thin nowrap text-right small"},n?l.createElement(Fe.a,{date:t,long:!0}):"")}function qe(e){let t=e.ms;return l.createElement("td",{className:"thin nowrap text-right"},t&&function(e){if(!e)return"";if(e<f)return O(e,"ms");if(e<10*f){const t=Math.floor(e/f);return t+"."+O(e-t*f,"s")}if(e<C)return O(Math.floor(e/f),"s");if(e<10*C){const t=Math.floor(e/C),a=Math.floor((e-t*C)/f);return O(t,"min")+" "+O(a,"s")}const t=Math.floor(e/y),a=Math.floor((e-t*y)/C);return O(t,"h")+" "+O(a,"min")}(t))}function Ue(e){let t=e.id;return l.createElement("td",{className:"thin nowrap"},l.createElement("div",{className:"note"},t))}var We=a(1372),ze=a.n(We);function Be(e){let t;switch(e.status){case k.e.PENDING:t=l.createElement(ze.a,null);break;case k.e.IN_PROGRESS:t=l.createElement("i",{className:"spinner"});break;case k.e.SUCCESS:t=l.createElement("span",{className:"badge badge-success"},Object(m.translate)("background_task.status.SUCCESS"));break;case k.e.FAILED:t=l.createElement("span",{className:"badge badge-error"},Object(m.translate)("background_task.status.FAILED"));break;case k.e.CANCELED:t=l.createElement("span",{className:"badge"},Object(m.translate)("background_task.status.CANCELED"));break;default:t=""}return l.createElement("td",{className:"thin spacer-right"},t)}function Ge(e){let t=e.submitter;return l.createElement("td",{className:"thin note"},l.createElement("span",{className:"text-limited-small text-bottom"},t||Object(m.translate)("anonymous")))}function Ye(e){const t=e.task,a=e.component,n=e.onCancelTask,s=e.onFilterTask,r=e.previousTask;return l.createElement("tr",null,l.createElement(Be,{status:t.status}),l.createElement(Ae,{task:t}),l.createElement(Ue,{id:t.id}),l.createElement(Ge,{submitter:t.submitterLogin}),l.createElement(Me,{prevSubmittedAt:r&&r.submittedAt,submittedAt:t.submittedAt}),l.createElement(Ie,{date:t.submittedAt}),l.createElement(Ie,{baseDate:t.submittedAt,date:t.startedAt}),l.createElement(Ie,{baseDate:t.submittedAt,date:t.executedAt}),l.createElement(qe,{ms:t.executionTimeMs}),l.createElement(fe,{component:a,onCancelTask:n,onFilterTask:s,task:t}))}function Je(e){let t=e.tasks,a=e.component,n=e.loading,s=e.onCancelTask,r=e.onFilterTask;const o=ue("data zebra zebra-hover background-tasks",{"new-loading":n});return l.createElement("div",{className:"boxed-group boxed-group-inner"},l.createElement("table",{className:o},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",null,Object(m.translate)("background_tasks.table.status")),l.createElement("th",null,Object(m.translate)("background_tasks.table.task")),l.createElement("th",null,Object(m.translate)("background_tasks.table.id")),l.createElement("th",null,Object(m.translate)("background_tasks.table.submitter")),l.createElement("th",null," "),l.createElement("th",{className:"text-right"},Object(m.translate)("background_tasks.table.submitted")),l.createElement("th",{className:"text-right"},Object(m.translate)("background_tasks.table.started")),l.createElement("th",{className:"text-right"},Object(m.translate)("background_tasks.table.finished")),l.createElement("th",{className:"text-right"},Object(m.translate)("background_tasks.table.duration")),l.createElement("th",null," "))),l.createElement("tbody",null,t.map((e,t,n)=>l.createElement(Ye,{component:a,key:e.id,onCancelTask:s,onFilterTask:r,previousTask:t>0?n[t-1]:void 0,task:e})))))}function He(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],n=!0,s=!1,r=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){s=!0,r=e}finally{try{n||null==l.return||l.return()}finally{if(s)throw r}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}a.d(t,"BackgroundTasksApp",function(){return Ke});class Ke extends l.PureComponent{constructor(e){super(e),this.mounted=!1,this.stopLoading=()=>{this.mounted&&this.setState({loading:!1})},this.loadTasks=()=>{this.setState({loading:!0});const e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={};return e.status===k.e.ALL?t.status=[k.e.PENDING,k.e.IN_PROGRESS,k.e.SUCCESS,k.e.FAILED,k.e.CANCELED].join():e.status===k.e.ALL_EXCEPT_PENDING?t.status=[k.e.IN_PROGRESS,k.e.SUCCESS,k.e.FAILED,k.e.CANCELED].join():t.status=e.status,e.taskType!==k.a&&(t.type=e.taskType),e.currents!==k.b.ALL&&(t.onlyCurrents=!0),e.minSubmittedAt&&(t.minSubmittedAt=Object(d.toShortNotSoISOString)(e.minSubmittedAt)),e.maxExecutedAt&&(t.maxExecutedAt=Object(d.toShortNotSoISOString)(e.maxExecutedAt)),e.query&&(t.q=e.query),t}({status:this.props.location.query.status||k.d.status,taskType:this.props.location.query.taskType||k.d.taskType,currents:this.props.location.query.currents||k.d.currents,minSubmittedAt:this.props.location.query.minSubmittedAt||k.d.minSubmittedAt,maxExecutedAt:this.props.location.query.maxExecutedAt||k.d.maxExecutedAt,query:this.props.location.query.query||k.d.query});this.props.component&&(e.componentId=this.props.component.id),Promise.all([Object(h.c)(e),Object(h.e)(e.componentId)]).then(e=>{let t=He(e,2),a=t[0].tasks,n=t[1];if(this.mounted){const e=s()(a.map(e=>e.organization).filter(e=>e));this.props.fetchOrganizations(e),this.setState({failingCount:n.failing,loading:!1,pendingCount:n.pending,pendingTime:n.pendingTime,tasks:a})}},this.stopLoading)},this.handleFilterUpdate=e=>{const t=Object.assign({},this.props.location.query,e);Object.keys(k.d).forEach(e=>{t[e]===k.d[e]&&delete t[e]}),t.minSubmittedAt&&(t.minSubmittedAt=Object(d.toShortNotSoISOString)(t.minSubmittedAt)),t.maxExecutedAt&&(t.maxExecutedAt=Object(d.toShortNotSoISOString)(t.maxExecutedAt)),this.props.router.push({pathname:this.props.location.pathname,query:t})},this.handleCancelTask=e=>(this.setState({loading:!0}),Object(h.b)(e.id).then(e=>{this.mounted&&this.setState(t=>({tasks:E(t.tasks,e),loading:!1}))},this.stopLoading)),this.handleFilterTask=e=>{this.handleFilterUpdate({query:e.componentKey})},this.handleShowFailing=()=>{this.handleFilterUpdate(Object.assign({},k.d,{status:k.e.FAILED,currents:k.b.ONLY_CURRENTS}))},this.handleCancelAllPending=()=>{this.setState({loading:!0}),Object(h.a)().then(()=>{this.mounted&&this.loadTasks()},this.stopLoading)},this.state={failingCount:0,loading:!0,pendingCount:0,tasks:[]},this.loadTasksDebounced=o()(this.loadTasks,k.c)}componentDidMount(){this.mounted=!0,Object(h.h)().then(e=>{this.setState({types:e}),this.loadTasks()},()=>{})}componentDidUpdate(e){e.component===this.props.component&&e.location===this.props.location||this.loadTasksDebounced()}componentWillUnmount(){this.mounted=!1}render(){const e=this.props.component,t=this.state,a=t.loading,n=t.types,s=t.tasks;if(!n)return l.createElement("div",{className:"page page-limited"},l.createElement("i",{className:"spinner"}));const r=this.props.location.query.status||k.d.status,o=this.props.location.query.taskType||k.d.taskType,c=this.props.location.query.currents||k.d.currents,u=Object(p.parseAsDate)(this.props.location.query.minSubmittedAt),d=Object(p.parseAsDate)(this.props.location.query.maxExecutedAt),h=this.props.location.query.query||"";return l.createElement("div",{className:"page page-limited"},l.createElement(g.a,{suggestions:"background_tasks"}),l.createElement(i.a,{title:Object(m.translate)("background_tasks.page")}),l.createElement(z,{component:e}),l.createElement(ie,{component:e,failingCount:this.state.failingCount,onCancelAllPending:this.handleCancelAllPending,onShowFailing:this.handleShowFailing,pendingCount:this.state.pendingCount,pendingTime:this.state.pendingTime}),l.createElement(Z,{component:e,currents:c,loading:a,maxExecutedAt:d,minSubmittedAt:u,onFilterUpdate:this.handleFilterUpdate,onReload:this.loadTasksDebounced,query:h,status:r,taskType:o,types:n}),l.createElement(Je,{component:e,loading:a,onCancelTask:this.handleCancelTask,onFilterTask:this.handleFilterTask,tasks:s}),l.createElement(S,{tasks:s}))}}const Xe={fetchOrganizations:b.g};t.default=Object(u.connect)(null,Xe)(Ke)},330:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a(2),s=a(349);function r(e){let t=e.suggestions;return n.createElement(s.a.Consumer,null,e=>{let a=e.addSuggestions,s=e.removeSuggestions;return n.createElement(o,{addSuggestions:a,removeSuggestions:s,suggestions:t})})}class o extends n.PureComponent{componentDidMount(){this.props.addSuggestions(this.props.suggestions)}componentDidUpdate(e){e.suggestions!==this.props.suggestions&&(this.props.removeSuggestions(this.props.suggestions),this.props.addSuggestions(e.suggestions))}componentWillUnmount(){this.props.removeSuggestions(this.props.suggestions)}render(){return null}}},342:function(e,t,a){"use strict";a.d(t,"b",function(){return l}),a.d(t,"a",function(){return c});var n=a(2),s=a(304),r=a(29);const o={year:"numeric",month:"short",day:"2-digit"},l={year:"numeric",month:"long",day:"numeric"};function c(e){let t=e.children,a=e.date,c=e.long;return n.createElement(s.FormattedDate,Object.assign({value:Object(r.parseDate)(a)},c?l:o),t)}},498:function(e,t,a){"use strict";a.d(t,"e",function(){return n}),a.d(t,"a",function(){return s}),a.d(t,"b",function(){return r}),a.d(t,"d",function(){return o}),a.d(t,"c",function(){return l});const n={ALL:"__ALL__",ALL_EXCEPT_PENDING:"__ALL_EXCEPT_PENDING__",PENDING:"PENDING",IN_PROGRESS:"IN_PROGRESS",SUCCESS:"SUCCESS",FAILED:"FAILED",CANCELED:"CANCELED"},s="ALL_TYPES",r={ALL:"__ALL__",ONLY_CURRENTS:"CURRENTS"},o={status:n.ALL_EXCEPT_PENDING,taskType:s,currents:r.ALL,minSubmittedAt:void 0,maxExecutedAt:void 0,query:""},l=250},522:function(e,t,a){"use strict";a.d(t,"a",function(){return x});var n=a(523),s=a.n(n),r=a(309),o=a(376),l=a(428),c=a(467),i=a(468),u=a(2),d=a(304),m=a(310),p=a(592),h=a.n(p),g=a(338),b=a.n(g),k=a(526),E=a.n(k),f=a(487),C=a.n(f),y=a(419),O=a.n(y),N=a(321),S=a(5),v=(a(527),a(529),function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&(a[n[s]]=e[n[s]])}return a});const _=Object(N.lazyLoad)(()=>a.e(316).then(a.t.bind(null,680,7)));class x extends u.PureComponent{constructor(e){super(e),this.focus=()=>{this.input&&this.input.focus(),this.openCalendar()},this.handleResetClick=()=>{this.closeCalendar(),this.props.onChange(void 0)},this.openCalendar=()=>{this.setState({currentMonth:this.props.value||this.props.currentMonth||new Date,lastHovered:void 0,open:!0})},this.closeCalendar=()=>{this.setState({open:!1})},this.handleDayClick=(e,t)=>{t.disabled||(this.closeCalendar(),this.props.onChange(e))},this.handleDayMouseEnter=(e,t)=>{this.setState({lastHovered:t.disabled?void 0:e})},this.handleCurrentMonthChange=e=>{let t=e.value;this.setState(e=>({currentMonth:l(e.currentMonth,t)}))},this.handleCurrentYearChange=e=>{let t=e.value;this.setState(e=>({currentMonth:c(e.currentMonth,t)}))},this.handlePreviousMonthClick=()=>{this.setState(e=>({currentMonth:i(e.currentMonth,1)}))},this.handleNextMonthClick=()=>{this.setState(e=>({currentMonth:o(e.currentMonth,1)}))},this.state={currentMonth:e.value||e.currentMonth||new Date,open:!1}}render(){const e=this.props,t=e.highlightFrom,a=e.highlightTo,n=e.minDate,o=e.value,l=this.state.lastHovered,c=this.props.maxDate||new Date,i=s()(12),d=s()((new Date).getFullYear()-10,(new Date).getFullYear()+1),p=o?[o]:[];let g;const k=l||o;t&&k&&(g={highlighted:{from:t,to:k}},p.push(t)),a&&k&&(g={highlighted:{from:k,to:a}},p.push(a));const f=s()(7).map(S.getWeekDayName),y=s()(7).map(S.getShortWeekDayName);return u.createElement(h.a,{onClickOutside:this.closeCalendar},u.createElement("span",{className:r("date-input-control",this.props.className)},u.createElement(D,{className:r("date-input-control-input",this.props.inputClassName,{"is-filled":void 0!==this.props.value}),innerRef:e=>this.input=e,name:this.props.name,onFocus:this.openCalendar,placeholder:this.props.placeholder,readOnly:!0,type:"text",value:o}),u.createElement(E.a,{className:"date-input-control-icon",fill:""}),void 0!==this.props.value&&u.createElement(m.ClearButton,{className:"button-tiny date-input-control-reset",iconProps:{size:12},onClick:this.handleResetClick}),this.state.open&&u.createElement("div",{className:"date-input-calendar"},u.createElement("nav",{className:"date-input-calendar-nav"},u.createElement(m.ButtonIcon,{className:"button-small",onClick:this.handlePreviousMonthClick},u.createElement(C.a,null)),u.createElement("div",{className:"date-input-calender-month"},u.createElement(b.a,{className:"date-input-calender-month-select",onChange:this.handleCurrentMonthChange,options:i.map(e=>({label:Object(S.getShortMonthName)(e),value:e})),value:this.state.currentMonth.getMonth()}),u.createElement(b.a,{className:"date-input-calender-month-select spacer-left",onChange:this.handleCurrentYearChange,options:d.map(e=>({label:String(e),value:e})),value:this.state.currentMonth.getFullYear()})),u.createElement(m.ButtonIcon,{className:"button-small",onClick:this.handleNextMonthClick},u.createElement(O.a,null))),u.createElement(_,{captionElement:u.createElement(j,null),disabledDays:{after:c,before:n},firstDayOfWeek:1,modifiers:g,month:this.state.currentMonth,navbarElement:u.createElement(j,null),onDayClick:this.handleDayClick,onDayMouseEnter:this.handleDayMouseEnter,selectedDays:p,weekdaysLong:f,weekdaysShort:y}))))}}function j(){return null}const D=Object(d.injectIntl)(e=>{var t=e.innerRef,a=e.intl,n=e.value,s=v(e,["innerRef","intl","value"]);const r=n&&a.formatDate(n,{year:"numeric",month:"short",day:"numeric"});return u.createElement("input",Object.assign({},s,{ref:t,value:r||""}))})},527:function(e,t,a){var n=a(528);"string"==typeof n&&(n=[[e.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};a(313)(n,s);n.locals&&(e.exports=n.locals)},528:function(e,t,a){(e.exports=a(312)(!1)).push([e.i,".DayPicker{display:inline-block}.DayPicker-wrapper{position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding-bottom:8px;flex-direction:row}.DayPicker-Months{display:flex;flex-wrap:wrap;justify-content:center}.DayPicker-Month{display:table;border-collapse:collapse;border-spacing:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:8px 8px 0}.DayPicker-Weekdays{display:table-header-group}.DayPicker-WeekdaysRow{display:table-row}.DayPicker-Weekday{display:table-cell;padding:8px;font-size:12px;text-align:center;color:#999}.DayPicker-Weekday abbr[title]{border-bottom:none;text-decoration:none}.DayPicker-Body{display:table-row-group}.DayPicker-Week{display:table-row}.DayPicker-Day{display:table-cell;line-height:15px;padding:8px;text-align:center;cursor:pointer;vertical-align:top;outline:none}.DayPicker--interactionDisabled .DayPicker-Day{cursor:default}.DayPicker-Footer{padding-top:8px}.DayPicker-Day--today{font-weight:700}.DayPicker-Day--outside{cursor:default;color:#8b9898}.DayPicker-Day--disabled{color:#cdcdcd;cursor:not-allowed}.DayPicker-Day--sunday{background-color:#f7f8f8}.DayPicker-Day--sunday:not(.DayPicker-Day--today){color:#dce0e0}.DayPicker-Day--selected:not(.DayPicker-Day--disabled):not(.DayPicker-Day--outside){background-color:#4b9fd5;color:#fff}.DayPicker:not(.DayPicker--interactionDisabled) .DayPicker-Day:not(.DayPicker-Day--disabled):not(.DayPicker-Day--selected):not(.DayPicker-Day--highlighted):not(.DayPicker-Day--outside):hover{background-color:#f3f3f3}.DayPicker-Day--highlighted:not(.DayPicker-Day--disabled):not(.DayPicker-Day--selected):not(.DayPicker-Day--outside){background-color:#cae3f2}",""])},529:function(e,t,a){var n=a(530);"string"==typeof n&&(n=[[e.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};a(313)(n,s);n.locals&&(e.exports=n.locals)},530:function(e,t,a){(e.exports=a(312)(!1)).push([e.i,".date-input-control{position:relative;display:inline-block;cursor:pointer}.date-input-control-input{width:130px;padding-left:24px!important;cursor:pointer}.date-input-control-input.is-filled{padding-right:16px!important}.date-input-control-icon{position:absolute;top:4px;left:4px}.date-input-control-icon path{fill:#cdcdcd;transition:fill .3s ease}.date-input-control-input:focus+.date-input-control-icon path{fill:#4b9fd5}.date-input-control-reset{position:absolute;top:4px;right:4px;border:none}.date-input-calendar{position:absolute;z-index:7500;top:100%;left:0;border:1px solid #e6e6e6;background-color:#fff;box-shadow:0 6px 12px rgba(0,0,0,.175)}.date-input-calendar-nav{display:flex;justify-content:space-between;align-items:center;padding-top:8px;padding-left:8px;padding-right:8px}.date-input-calender-month-select{width:70px}",""])},568:function(e,t,a){"use strict";a.d(t,"d",function(){return r}),a.d(t,"c",function(){return o}),a.d(t,"e",function(){return l}),a.d(t,"f",function(){return c}),a.d(t,"b",function(){return i}),a.d(t,"a",function(){return u}),a.d(t,"g",function(){return d}),a.d(t,"h",function(){return m}),a.d(t,"i",function(){return p}),a.d(t,"j",function(){return h});var n=a(8),s=a(320);function r(e){return Object(n.getJSON)("/api/ce/analysis_status",e).catch(s.a)}function o(e){return Object(n.getJSON)("/api/ce/activity",e)}function l(e){const t={};return e&&Object.assign(t,{componentId:e}),Object(n.getJSON)("/api/ce/activity_status",t)}function c(e,t){return Object(n.getJSON)("/api/ce/task",{id:e,additionalFields:t}).then(e=>e.task)}function i(e){return Object(n.post)("/api/ce/cancel",{id:e}).then(()=>c(e),()=>c(e))}function u(){return Object(n.post)("/api/ce/cancel_all")}function d(e){return Object(n.getJSON)("/api/ce/component",{component:e}).catch(s.a)}function m(){return Object(n.getJSON)("/api/ce/task_types").then(e=>e.taskTypes)}function p(){return Object(n.getJSON)("/api/ce/worker_count").catch(s.a)}function h(e){return Object(n.post)("/api/ce/set_worker_count",{count:e}).catch(s.a)}},577:function(e,t,a){"use strict";a.d(t,"a",function(){return c});var n=a(2),s=a(304),r=a(29);const o={hour:"numeric",minute:"numeric"},l={hour:"numeric",minute:"numeric",second:"numeric"};function c(e){let t=e.children,a=e.date,c=e.long;return n.createElement(s.FormattedTime,Object.assign({value:Object(r.parseDate)(a)},c?l:o),t)}},629:function(e,t,a){"use strict";a.d(t,"a",function(){return l});var n=a(309),s=a(2),r=a(5),o=a(522);class l extends s.PureComponent{constructor(){super(...arguments),this.handleFromChange=e=>{this.props.onChange({from:e,to:this.to}),setTimeout(()=>{e&&!this.to&&this.toDateInput&&this.toDateInput.focus()},0)},this.handleToChange=e=>{this.setState({to:e}),this.props.onChange({from:this.from,to:e})}}get from(){return this.props.value&&this.props.value.from}get to(){return this.props.value&&this.props.value.to}render(){return s.createElement("div",{className:n("display-inline-flex-center",this.props.className)},s.createElement(o.a,{currentMonth:this.to,"data-test":"from",highlightTo:this.to,maxDate:this.to,onChange:this.handleFromChange,placeholder:Object(r.translate)("start_date"),value:this.from}),s.createElement("span",{className:"note little-spacer-left little-spacer-right"},Object(r.translate)("to_")),s.createElement(o.a,{currentMonth:this.from,"data-test":"to",highlightFrom:this.from,minDate:this.from,onChange:this.handleToChange,placeholder:Object(r.translate)("end_date"),ref:e=>this.toDateInput=e,value:this.to}))}}},795:function(e,t,a){"use strict";var n=a(2),s=a(316),r=a(317),o=a(662);function l(e){const t=e.link,a=void 0===t||t,s=e.organization;return e.shouldBeDisplayed&&s?n.createElement("span",null,a?n.createElement(o.a,{className:e.linkClassName,organization:s},s.name):s.name,n.createElement("span",{className:"slash-separator"})):null}t.a=Object(s.connect)((e,t)=>({organization:Object(r.getOrganizationByKey)(e,t.organizationKey),shouldBeDisplayed:Object(r.areThereCustomOrganizations)(e)}))(l)}}]);
//# sourceMappingURL=311.m.b4f28823.chunk.js.map