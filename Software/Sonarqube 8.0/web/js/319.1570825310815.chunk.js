(window.webpackJsonp=window.webpackJsonp||[]).push([[319],{1119:function(e,t,n){"use strict";var o,r=n(957),a=n(12),s=n(644),i=n.n(s),c=n(34),l=n(689),u=n(674),p=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),t.prototype.render=function(){var e,t=this.props,n=t.children,o=t.date;return o?r(Date.now(),o)<1&&(e=Object(c.translate)("less_than_1_hour_ago")):e=Object(c.translate)("never"),e?n?n(e):e:a.createElement(i.a,{overlay:a.createElement(u.a,{date:o})},a.createElement("span",null,a.createElement(l.a,{date:o},n)))},t}(a.PureComponent);t.a=m},1399:function(e,t,n){"use strict";var o,r=n(12),a=n(640),s=n(645),i=n.n(s),c=n(34),l=n(906),u=n(634),p=n(696),m=n.n(p),d=n(644),f=n.n(d),h=n(730),b=n(672),y=n(1119),v=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.state={loading:!1,showConfirmation:!1},t.handleClick=function(){t.state.showConfirmation?t.handleRevoke().then(function(){t.mounted&&t.setState({showConfirmation:!1})}):t.setState({showConfirmation:!0})},t.handleRevoke=function(){return t.setState({loading:!0}),Object(l.c)({login:t.props.login,name:t.props.token.name}).then(function(){return t.props.onRevokeToken(t.props.token)},function(){t.mounted&&t.setState({loading:!1})})},t}return v(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=this.props,t=e.deleteConfirmation,n=e.token,o=this.state,s=o.loading,l=o.showConfirmation;return r.createElement("tr",null,r.createElement("td",null,r.createElement(f.a,{overlay:n.name},r.createElement("span",null,Object(h.limitComponentName)(n.name)))),r.createElement("td",{className:"nowrap"},r.createElement(y.a,{date:n.lastConnectionDate})),r.createElement("td",{className:"thin nowrap text-right"},r.createElement(b.a,{date:n.createdAt,long:!0})),r.createElement("td",{className:"thin nowrap text-right"},r.createElement(i.a,{loading:s},r.createElement("i",{className:"deferred-spinner-placeholder"})),"modal"===t?r.createElement(m.a,{confirmButtonText:Object(c.translate)("users.tokens.revoke_token"),isDestructive:!0,modalBody:r.createElement(u.FormattedMessage,{defaultMessage:Object(c.translate)("users.tokens.sure_X"),id:"users.tokens.sure_X",values:{token:r.createElement("strong",null,n.name)}}),modalHeader:Object(c.translate)("users.tokens.revoke_token"),onConfirm:this.handleRevoke},function(e){var t=e.onClick;return r.createElement(a.Button,{className:"spacer-left button-red input-small",disabled:s,onClick:t,title:Object(c.translate)("users.tokens.revoke_token")},Object(c.translate)("users.tokens.revoke"))}):r.createElement(a.Button,{className:"button-red input-small spacer-left",disabled:s,onClick:this.handleClick},l?Object(c.translate)("users.tokens.sure"):Object(c.translate)("users.tokens.revoke"))))},t}(r.PureComponent),g=n(829),O=n(656);function k(e){var t=e.token;return r.createElement("div",{className:"panel panel-white big-spacer-top"},r.createElement(O.Alert,{variant:"warning"},Object(c.translateWithParameters)("users.tokens.new_token_created",t.name)),r.createElement(g.ClipboardButton,{copyValue:t.token}),r.createElement("code",{className:"big-spacer-left text-success"},t.token))}var E=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.state={generating:!1,loading:!0,newTokenName:"",tokens:[]},t.fetchTokens=function(){t.setState({loading:!0}),Object(l.b)(t.props.login).then(function(e){t.mounted&&t.setState({loading:!1,tokens:e})},function(){t.mounted&&t.setState({loading:!1})})},t.updateTokensCount=function(){t.props.updateTokensCount&&t.props.updateTokensCount(t.props.login,t.state.tokens.length)},t.handleGenerateToken=function(e){e.preventDefault(),t.state.newTokenName.length>0&&(t.setState({generating:!0}),Object(l.a)({name:t.state.newTokenName,login:t.props.login}).then(function(e){t.mounted&&t.setState(function(t){var n=t.tokens.concat([{name:e.name,createdAt:e.createdAt}]);return{generating:!1,newToken:e,newTokenName:"",tokens:n}},t.updateTokensCount)},function(){t.mounted&&t.setState({generating:!1})}))},t.handleRevokeToken=function(e){t.setState(function(t){return{tokens:t.tokens.filter(function(t){return t.name!==e.name})}},t.updateTokensCount)},t.handleNewTokenChange=function(e){return t.setState({newTokenName:e.currentTarget.value})},t}return E(t,e),t.prototype.componentDidMount=function(){this.mounted=!0,this.fetchTokens()},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.renderItems=function(){var e=this,t=this.state.tokens;return t.length<=0?r.createElement("tr",null,r.createElement("td",{className:"note",colSpan:3},Object(c.translate)("users.no_tokens"))):t.map(function(t){return r.createElement(_,{deleteConfirmation:e.props.deleteConfirmation,key:t.name,login:e.props.login,onRevokeToken:e.handleRevokeToken,token:t})})},t.prototype.render=function(){var e=this.state,t=e.generating,n=e.loading,o=e.newToken,s=e.newTokenName,l=e.tokens,u=r.createElement("tr",null,r.createElement("td",null,r.createElement("i",{className:"spinner"})));return r.createElement(r.Fragment,null,r.createElement("h3",{className:"spacer-bottom"},Object(c.translate)("users.generate_tokens")),r.createElement("form",{autoComplete:"off",className:"display-flex-center",id:"generate-token-form",onSubmit:this.handleGenerateToken},r.createElement("input",{className:"input-large spacer-right",maxLength:100,onChange:this.handleNewTokenChange,placeholder:Object(c.translate)("users.enter_token_name"),required:!0,type:"text",value:s}),r.createElement(a.SubmitButton,{className:"js-generate-token",disabled:t||s.length<=0},Object(c.translate)("users.generate"))),o&&r.createElement(k,{token:o}),r.createElement("table",{className:"data zebra big-spacer-top"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,Object(c.translate)("name")),r.createElement("th",null,Object(c.translate)("my_account.tokens_last_usage")),r.createElement("th",{className:"text-right"},Object(c.translate)("created")),r.createElement("th",null))),r.createElement("tbody",null,r.createElement(i.a,{customSpinner:u,loading:n&&l.length<=0},this.renderItems()))))},t}(r.PureComponent);t.a=w},2148:function(e,t,n){"use strict";n.r(t);var o,r=n(12),a=n(654),s=n.n(a),i=n(646),c=n(34),l=n(647),u=n(640),p=n(656),m=n(766),d=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={success:!1},t.handleSuccessfulChange=function(){t.oldPassword.value="",t.password.value="",t.passwordConfirmation.value="",t.setState({success:!0,errors:void 0})},t.setErrors=function(e){t.setState({success:!1,errors:e})},t.handleChangePassword=function(e){e.preventDefault();var n=t.props.user,o=t.oldPassword.value,r=t.password.value;r!==t.passwordConfirmation.value?(t.password.focus(),t.setErrors([Object(c.translate)("user.password_doesnt_match_confirmation")])):Object(m.a)({login:n.login,password:r,previousPassword:o}).then(t.handleSuccessfulChange,function(){})},t}return d(t,e),t.prototype.render=function(){var e=this,t=this.state,n=t.success,o=t.errors;return r.createElement("section",{className:"boxed-group"},r.createElement("h2",{className:"spacer-bottom"},Object(c.translate)("my_profile.password.title")),r.createElement("form",{className:"boxed-group-inner",onSubmit:this.handleChangePassword},n&&r.createElement(p.Alert,{variant:"success"},Object(c.translate)("my_profile.password.changed")),o&&o.map(function(e,t){return r.createElement(p.Alert,{key:t,variant:"error"},e)}),r.createElement("div",{className:"form-field"},r.createElement("label",{htmlFor:"old_password"},Object(c.translate)("my_profile.password.old"),r.createElement("em",{className:"mandatory"},"*")),r.createElement("input",{autoComplete:"off",id:"old_password",name:"old_password",ref:function(t){return e.oldPassword=t},required:!0,type:"password"})),r.createElement("div",{className:"form-field"},r.createElement("label",{htmlFor:"password"},Object(c.translate)("my_profile.password.new"),r.createElement("em",{className:"mandatory"},"*")),r.createElement("input",{autoComplete:"off",id:"password",name:"password",ref:function(t){return e.password=t},required:!0,type:"password"})),r.createElement("div",{className:"form-field"},r.createElement("label",{htmlFor:"password_confirmation"},Object(c.translate)("my_profile.password.confirm"),r.createElement("em",{className:"mandatory"},"*")),r.createElement("input",{autoComplete:"off",id:"password_confirmation",name:"password_confirmation",ref:function(t){return e.passwordConfirmation=t},required:!0,type:"password"})),r.createElement("div",{className:"form-field"},r.createElement(u.SubmitButton,{id:"change-password"},Object(c.translate)("my_profile.password.submit")))))},t}(r.Component),h=n(719),b=n(1399);function y(e){var t=e.login;return r.createElement("div",{className:"boxed-group"},r.createElement("h2",null,Object(c.translate)("users.tokens")),r.createElement("div",{className:"boxed-group-inner"},r.createElement("div",{className:"big-spacer-bottom big-spacer-right markdown"},r.createElement(h.a,{message:Object(c.translate)("my_account.tokens_description")})),r.createElement(b.a,{deleteConfirmation:"modal",login:t})))}t.default=Object(i.connect)(function(e){return{user:Object(l.getCurrentUser)(e)}})(function(e){var t=e.user;return r.createElement("div",{className:"account-body account-container"},r.createElement(s.a,{title:Object(c.translate)("my_account.security")}),r.createElement(y,{login:t.login}),t.local&&r.createElement(f,{user:t}))})},662:function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},s=this&&this.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),c=n(657),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.state={submitting:!1},t.stopSubmitting=function(){t.mounted&&t.setState({submitting:!1})},t.handleCloseClick=function(e){e&&(e.preventDefault(),e.currentTarget.blur()),t.props.onClose()},t.handleFormSubmit=function(e){e.preventDefault(),t.submit()},t.handleSubmitClick=function(e){e&&(e.preventDefault(),e.currentTarget.blur()),t.submit()},t.submit=function(){var e=t.props.onSubmit();e&&(t.setState({submitting:!0}),e.then(t.stopSubmitting,t.stopSubmitting))},t}return r(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=this.props,t=e.children,n=e.header,o=e.onClose,r=(e.onSubmit,s(e,["children","header","onClose","onSubmit"]));return i.createElement(c.default,a({contentLabel:n,onRequestClose:o},r),t({onCloseClick:this.handleCloseClick,onFormSubmit:this.handleFormSubmit,onSubmitClick:this.handleSubmitClick,submitting:this.state.submitting}))},t}(i.Component);t.default=l},671:function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(12),i=n(34),c=n(645),l=n(640),u=n(662),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.handleSubmit=function(){var e=t.props.onConfirm(t.props.confirmData);return e?e.then(t.props.onClose,function(){}):void t.props.onClose()},t.renderModalContent=function(e){var n=e.onCloseClick,o=e.onFormSubmit,r=e.submitting,a=t.props,u=a.children,p=a.confirmButtonText,m=a.confirmDisable,d=a.header,f=a.headerDescription,h=a.isDestructive,b=a.cancelButtonText,y=void 0===b?i.translate("cancel"):b;return s.createElement("form",{onSubmit:o},s.createElement("header",{className:"modal-head"},s.createElement("h2",null,d),f),s.createElement("div",{className:"modal-body"},u),s.createElement("footer",{className:"modal-foot"},s.createElement(c.default,{className:"spacer-right",loading:r}),s.createElement(l.SubmitButton,{autoFocus:!0,className:h?"button-red":void 0,disabled:r||m},p),s.createElement(l.ResetButtonLink,{disabled:r,onClick:n},y)))},t}return r(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=this.props,t={header:e.header,onClose:e.onClose,noBackdrop:e.noBackdrop,size:e.size};return s.createElement(u.default,a({onSubmit:this.handleSubmit},t),this.renderModalContent)},t}(s.PureComponent);t.default=p},672:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return l});var o=n(12),r=n(634),a=n(160),s=function(){return(s=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},i={year:"numeric",month:"short",day:"2-digit"},c={year:"numeric",month:"long",day:"numeric"};function l(e){var t=e.children,n=e.date,l=e.long;return o.createElement(r.FormattedDate,s({value:Object(a.parseDate)(n)},l?c:i),t)}},674:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return c});var o=n(12),r=n(634),a=n(160),s=function(){return(s=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},i={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"};function c(e){var t=e.children,n=e.date;return o.createElement(r.FormattedDate,s({value:Object(a.parseDate)(n)},i),t)}},689:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var o=n(12),r=n(634),a=n(160);function s(e){var t=e.children,n=e.date;return o.createElement(r.FormattedRelative,{value:Object(a.parseDate)(n)},t)}},696:function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},s=this&&this.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),c=n(671),l=n(697),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderConfirmModal=function(e){var n=e.onClose,o=t.props,r=(o.children,o.modalBody),l=o.modalHeader,u=o.modalHeaderDescription,p=s(o,["children","modalBody","modalHeader","modalHeaderDescription"]);return i.createElement(c.default,a({header:l,headerDescription:u,onClose:n},p),r)},t}return r(t,e),t.prototype.render=function(){return i.createElement(l.default,{modal:this.renderConfirmModal},this.props.children)},t}(i.PureComponent);t.default=u},697:function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=n(12),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.state={modal:!1},t.handleButtonClick=function(){t.setState({modal:!0})},t.handleFormSubmit=function(e){e&&e.preventDefault(),t.setState({modal:!0})},t.handleCloseModal=function(){t.mounted&&t.setState({modal:!1})},t}return r(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){return a.createElement(a.Fragment,null,this.props.children({onClick:this.handleButtonClick,onFormSubmit:this.handleFormSubmit}),this.state.modal&&this.props.modal({onClose:this.handleCloseModal}))},t}(a.PureComponent);t.default=s},723:function(e,t,n){var o=n(158);e.exports=function(e,t){var n=o(e),r=o(t);return n.getTime()-r.getTime()}},906:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"c",function(){return i});var o=n(48),r=n(651);function a(e){return Object(o.getJSON)("/api/user_tokens/search",{login:e}).then(function(e){return e.userTokens},r.a)}function s(e){return Object(o.postJSON)("/api/user_tokens/generate",e).catch(r.a)}function i(e){return Object(o.post)("/api/user_tokens/revoke",e).catch(r.a)}},957:function(e,t,n){var o=n(723),r=36e5;e.exports=function(e,t){var n=o(e,t)/r;return n>0?Math.floor(n):Math.ceil(n)}}}]);
//# sourceMappingURL=319.1570825310815.chunk.js.map