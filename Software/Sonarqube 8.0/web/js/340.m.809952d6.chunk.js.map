{"version":3,"sources":["webpack:///./src/main/js/apps/overview/badges/styles.css?8eeb","webpack:///./src/main/js/apps/overview/badges/styles.css","webpack:///./src/main/js/apps/overview/badges/utils.ts","webpack:///./src/main/js/apps/overview/badges/BadgeButton.tsx","webpack:///./src/main/js/apps/overview/badges/BadgeParams.tsx","webpack:///./src/main/js/apps/overview/badges/BadgesModal.tsx","webpack:///./src/main/js/components/common/CodeSnippet.tsx","webpack:///./src/main/js/components/common/CodeSnippet.css?2955","webpack:///./src/main/js/components/common/CodeSnippet.css","webpack:///./src/main/js/api/web-api.ts"],"names":["content","__webpack_require__","module","i","options","hmr","transform","insertInto","undefined","locals","exports","push","BadgeType","getBadgeSnippet","type","url","getBadgeUrl","branch","_options$format","format","_options$metric","metric","project","label","projectUrl","marketing","measure","Object","l10n","key","qualityGate","urls","helpers_urls","mdImage","concat","_ref","_ref$color","color","_ref$metric","pullRequest","querystring_es3","request","BadgeButton_BadgeButton","index_js_exposed","[object Object]","this","handleClick","props","onClick","_this$props","selected","width","buttons","className","classnames","alt","src","BadgeParams_BadgeParams","mounted","state","badgeMetrics","getColorOptions","map","value","getFormatOptions","getMetricOptions","metrics","handleColorChange","updateOptions","handleFormatChange","_ref2","handleMetricChange","_ref3","renderBadgeType","htmlFor","Select_default","a","clearable","name","onChange","searchable","fetchBadgeMetrics","web_api","then","webservices","domain","find","path","ws","actions","param","params","possibleValues","setState","big-spacer-left","d","__webpack_exports__","BadgesModal_BadgesModal","open","selectedType","badgeOptions","handleClose","handleOpen","handleSelectBadge","handleUpdateOptions","assign","branchLike","qualifier","_this$state","header","fullBadgeOptions","branches","badges","system","Modal_default","contentLabel","onRequestClose","CodeSnippet","isOneLine","snippet","classnames__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_1__","sonar_ui_common_components_controls_clipboard__WEBPACK_IMPORTED_MODULE_2__","s","noCopy","render","wrap","snippetArray","Array","isArray","filter","line","finalSnippet","join","code-snippet-oneline","code-snippet-wrap","copyValue","fetchWebApi","fetchResponseExample","sonar_ui_common_helpers_request__WEBPACK_IMPORTED_MODULE_0__","_app_utils_throwGlobalError__WEBPACK_IMPORTED_MODULE_1__","showInternal","arguments","length","include_internals","r","webServices","catch","action","controller"],"mappings":"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","file":"js/340.m.809952d6.chunk.js","sourcesContent":["\nvar content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../../node_modules/postcss-loader/src/index.js??postcss!./styles.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../../node_modules/postcss-loader/src/index.js??postcss!./styles.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../../node_modules/postcss-loader/src/index.js??postcss!./styles.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \".badges-list{display:flex;justify-content:space-around;justify-content:space-evenly;flex-wrap:nowrap}.badge-button{display:flex;justify-content:center;padding:8px;min-width:146px;height:116px;background-color:#f3f3f3;border:1px solid #e6e6e6;border-radius:3px;transition:all .3s ease}.badge-button:active,.badge-button:focus,.badge-button:hover{background-color:#f3f3f3;border-color:#4b9fd5;box-shadow:none}.badge-button.selected{background-color:#cae3f2;border-color:#236a97}\", \"\"]);\n\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { stringify } from 'querystring';\nimport { getLocalizedMetricName } from 'sonar-ui-common/helpers/l10n';\nimport { omitNil } from 'sonar-ui-common/helpers/request';\nimport { getHostUrl, getPathUrlAsString } from 'sonar-ui-common/helpers/urls';\nimport { getProjectUrl } from '../../../helpers/urls';\n\nexport type BadgeColors = 'white' | 'black' | 'orange';\nexport type BadgeFormats = 'md' | 'url';\n\nexport interface BadgeOptions {\n  branch?: string;\n  color?: BadgeColors;\n  format?: BadgeFormats;\n  project?: string;\n  metric?: string;\n  pullRequest?: string;\n}\n\nexport enum BadgeType {\n  measure = 'measure',\n  qualityGate = 'quality_gate',\n  marketing = 'marketing'\n}\n\nexport function getBadgeSnippet(type: BadgeType, options: BadgeOptions) {\n  const url = getBadgeUrl(type, options);\n  const { branch, format = 'md', metric = 'alert_status', project } = options;\n\n  if (format === 'url') {\n    return url;\n  } else {\n    let label;\n    let projectUrl;\n\n    switch (type) {\n      case BadgeType.marketing:\n        label = 'SonarCloud';\n        break;\n      case BadgeType.measure:\n        label = getLocalizedMetricName({ key: metric });\n        break;\n      case BadgeType.qualityGate:\n      default:\n        label = 'Quality gate';\n        break;\n    }\n\n    if (project) {\n      projectUrl = getPathUrlAsString(getProjectUrl(project, branch), false);\n    }\n\n    const mdImage = `![${label}](${url})`;\n    return projectUrl ? `[${mdImage}](${projectUrl})` : mdImage;\n  }\n}\n\nexport function getBadgeUrl(\n  type: BadgeType,\n  { branch, project, color = 'white', metric = 'alert_status', pullRequest }: BadgeOptions\n) {\n  switch (type) {\n    case BadgeType.marketing:\n      return `${getHostUrl()}/images/project_badges/sonarcloud-${color}.svg`;\n    case BadgeType.qualityGate:\n      return `${getHostUrl()}/api/project_badges/quality_gate?${stringify(\n        omitNil({ branch, project, pullRequest })\n      )}`;\n    case BadgeType.measure:\n    default:\n      return `${getHostUrl()}/api/project_badges/measure?${stringify(\n        omitNil({ branch, project, metric, pullRequest })\n      )}`;\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { BadgeType } from './utils';\n\ninterface Props {\n  onClick: (type: BadgeType) => void;\n  selected: boolean;\n  type: BadgeType;\n  url: string;\n}\n\nexport default class BadgeButton extends React.PureComponent<Props> {\n  handleClick = () => {\n    this.props.onClick(this.props.type);\n  };\n\n  render() {\n    const { selected, type, url } = this.props;\n    const width = type !== BadgeType.measure ? '128px' : undefined;\n    return (\n      <Button className={classNames('badge-button', { selected })} onClick={this.handleClick}>\n        <img alt={translate('overview.badges', type, 'alt')} src={url} width={width} />\n      </Button>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport Select from 'sonar-ui-common/components/controls/Select';\nimport { getLocalizedMetricName, translate } from 'sonar-ui-common/helpers/l10n';\nimport { fetchWebApi } from '../../../api/web-api';\nimport { BadgeColors, BadgeFormats, BadgeOptions, BadgeType } from './utils';\n\ninterface Props {\n  className?: string;\n  metrics: T.Dict<T.Metric>;\n  options: BadgeOptions;\n  type: BadgeType;\n  updateOptions: (options: Partial<BadgeOptions>) => void;\n}\n\ninterface State {\n  badgeMetrics: string[];\n}\n\nexport default class BadgeParams extends React.PureComponent<Props> {\n  mounted = false;\n\n  state: State = { badgeMetrics: [] };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchBadgeMetrics();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchBadgeMetrics() {\n    fetchWebApi(false).then(\n      webservices => {\n        if (this.mounted) {\n          const domain = webservices.find(domain => domain.path === 'api/project_badges');\n          const ws = domain && domain.actions.find(ws => ws.key === 'measure');\n          const param = ws && ws.params && ws.params.find(param => param.key === 'metric');\n          if (param && param.possibleValues) {\n            this.setState({ badgeMetrics: param.possibleValues });\n          }\n        }\n      },\n      () => {}\n    );\n  }\n\n  getColorOptions = () => {\n    return ['white', 'black', 'orange'].map(color => ({\n      label: translate('overview.badges.options.colors', color),\n      value: color\n    }));\n  };\n\n  getFormatOptions = () => {\n    return ['md', 'url'].map(format => ({\n      label: translate('overview.badges.options.formats', format),\n      value: format\n    }));\n  };\n\n  getMetricOptions = () => {\n    return this.state.badgeMetrics.map(key => {\n      const metric = this.props.metrics[key];\n      return {\n        value: key,\n        label: metric ? getLocalizedMetricName(metric) : key\n      };\n    });\n  };\n\n  handleColorChange = ({ value }: { value: BadgeColors }) => {\n    this.props.updateOptions({ color: value });\n  };\n\n  handleFormatChange = ({ value }: { value: BadgeFormats }) => {\n    this.props.updateOptions({ format: value });\n  };\n\n  handleMetricChange = ({ value }: { value: string }) => {\n    this.props.updateOptions({ metric: value });\n  };\n\n  renderBadgeType = (type: BadgeType, options: BadgeOptions) => {\n    if (type === BadgeType.marketing) {\n      return (\n        <>\n          <label className=\"spacer-right\" htmlFor=\"badge-color\">\n            {translate('color')}:\n          </label>\n          <Select\n            className=\"input-medium\"\n            clearable={false}\n            name=\"badge-color\"\n            onChange={this.handleColorChange}\n            options={this.getColorOptions()}\n            searchable={false}\n            value={options.color}\n          />\n        </>\n      );\n    } else if (type === BadgeType.measure) {\n      return (\n        <>\n          <label className=\"spacer-right\" htmlFor=\"badge-metric\">\n            {translate('overview.badges.metric')}:\n          </label>\n          <Select\n            className=\"input-medium\"\n            clearable={false}\n            name=\"badge-metric\"\n            onChange={this.handleMetricChange}\n            options={this.getMetricOptions()}\n            searchable={false}\n            value={options.metric}\n          />\n        </>\n      );\n    } else {\n      return null;\n    }\n  };\n\n  render() {\n    const { className, options, type } = this.props;\n    return (\n      <div className={className}>\n        {this.renderBadgeType(type, options)}\n\n        <label\n          className={classNames('spacer-right', {\n            'big-spacer-left': type !== BadgeType.qualityGate\n          })}\n          htmlFor=\"badge-format\">\n          {translate('format')}:\n        </label>\n        <Select\n          className=\"input-medium\"\n          clearable={false}\n          name=\"badge-format\"\n          onChange={this.handleFormatChange}\n          options={this.getFormatOptions()}\n          searchable={false}\n          value={this.props.options.format || 'md'}\n        />\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Button, ResetButtonLink } from 'sonar-ui-common/components/controls/buttons';\nimport Modal from 'sonar-ui-common/components/controls/Modal';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport CodeSnippet from '../../../components/common/CodeSnippet';\nimport { getBranchLikeQuery } from '../../../helpers/branches';\nimport { isSonarCloud } from '../../../helpers/system';\nimport BadgeButton from './BadgeButton';\nimport BadgeParams from './BadgeParams';\nimport './styles.css';\nimport { BadgeOptions, BadgeType, getBadgeSnippet, getBadgeUrl } from './utils';\n\ninterface Props {\n  branchLike?: T.BranchLike;\n  metrics: T.Dict<T.Metric>;\n  project: string;\n  qualifier: string;\n}\n\ninterface State {\n  open: boolean;\n  selectedType: BadgeType;\n  badgeOptions: BadgeOptions;\n}\n\nexport default class BadgesModal extends React.PureComponent<Props, State> {\n  state: State = {\n    open: false,\n    selectedType: BadgeType.measure,\n    badgeOptions: { color: 'white', metric: 'alert_status' }\n  };\n\n  handleClose = () => {\n    this.setState({ open: false });\n  };\n\n  handleOpen = () => {\n    this.setState({ open: true });\n  };\n\n  handleSelectBadge = (selectedType: BadgeType) => {\n    this.setState({ selectedType });\n  };\n\n  handleUpdateOptions = (options: Partial<BadgeOptions>) => {\n    this.setState(state => ({ badgeOptions: { ...state.badgeOptions, ...options } }));\n  };\n\n  render() {\n    const { branchLike, project, qualifier } = this.props;\n    const { selectedType, badgeOptions } = this.state;\n    const header = translate('overview.badges.title');\n    const fullBadgeOptions = { project, ...badgeOptions, ...getBranchLikeQuery(branchLike) };\n    const badges = isSonarCloud()\n      ? [BadgeType.measure, BadgeType.qualityGate, BadgeType.marketing]\n      : [BadgeType.measure, BadgeType.qualityGate];\n    return (\n      <div className=\"overview-meta-card\">\n        <Button className=\"js-project-badges\" onClick={this.handleOpen}>\n          {translate('overview.badges.get_badge', qualifier)}\n        </Button>\n        {this.state.open && (\n          <Modal contentLabel={header} onRequestClose={this.handleClose}>\n            <header className=\"modal-head\">\n              <h2>{header}</h2>\n            </header>\n            <div className=\"modal-body\">\n              <p className=\"huge-spacer-bottom\">\n                {translate('overview.badges.description', qualifier)}\n              </p>\n              <div className=\"badges-list spacer-bottom\">\n                {badges.map(type => (\n                  <BadgeButton\n                    key={type}\n                    onClick={this.handleSelectBadge}\n                    selected={type === selectedType}\n                    type={type}\n                    url={getBadgeUrl(type, fullBadgeOptions)}\n                  />\n                ))}\n              </div>\n              <p className=\"text-center note huge-spacer-bottom\">\n                {translate('overview.badges', selectedType, 'description', qualifier)}\n              </p>\n              <BadgeParams\n                className=\"big-spacer-bottom\"\n                metrics={this.props.metrics}\n                options={badgeOptions}\n                type={selectedType}\n                updateOptions={this.handleUpdateOptions}\n              />\n              <CodeSnippet\n                isOneLine={true}\n                snippet={getBadgeSnippet(selectedType, fullBadgeOptions)}\n              />\n            </div>\n            <footer className=\"modal-foot\">\n              <ResetButtonLink className=\"js-modal-close\" onClick={this.handleClose}>\n                {translate('close')}\n              </ResetButtonLink>\n            </footer>\n          </Modal>\n        )}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport { ClipboardButton } from 'sonar-ui-common/components/controls/clipboard';\nimport './CodeSnippet.css';\n\ninterface Props {\n  className?: string;\n  isOneLine?: boolean;\n  noCopy?: boolean;\n  render?: () => JSX.Element;\n  snippet: string | (string | undefined)[];\n  wrap?: boolean;\n}\n\n// keep this \"useless\" concatentation for the readability reason\n// eslint-disable-next-line no-useless-concat\nconst s = ' \\\\' + '\\n  ';\n\nexport default function CodeSnippet({\n  className,\n  isOneLine,\n  noCopy,\n  render,\n  snippet,\n  wrap\n}: Props) {\n  const snippetArray = Array.isArray(snippet)\n    ? snippet.filter(line => line !== undefined)\n    : [snippet];\n  const finalSnippet = isOneLine ? snippetArray.join(' ') : snippetArray.join(s);\n  return (\n    <div\n      className={classNames(\n        'code-snippet',\n        { 'code-snippet-oneline': isOneLine, 'code-snippet-wrap': wrap },\n        className\n      )}>\n      <pre>{render ? render() : finalSnippet}</pre>\n      {!noCopy && <ClipboardButton copyValue={finalSnippet} />}\n    </div>\n  );\n}\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./CodeSnippet.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./CodeSnippet.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./CodeSnippet.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \".code-snippet{position:relative;margin:8px 0;background:#404040;color:#f0f0f0;border-radius:3px}.code-snippet pre{padding:16px;overflow:auto}.code-snippet>button{position:absolute;top:16px;right:16px;line-height:18px;border:1px solid #fff;color:#fff;font-size:11px;font-weight:400;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.code-snippet>button:active,.code-snippet>button:focus,.code-snippet>button:hover{background-color:#fff;color:#404040}.code-snippet-oneline pre{padding-bottom:40px}.code-snippet-oneline>button{top:auto;bottom:16px}.code-snippet-wrap pre{white-space:pre-wrap;word-break:break-all}.code-snippet .highlight{font-weight:700;color:#f4b1b0}.code-snippet .button-icon{color:#fff!important}.code-snippet .button-icon:active svg,.code-snippet .button-icon:focus svg,.code-snippet .button-icon:hover svg{background-color:#fff;color:#404040}\", \"\"]);\n\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { getJSON } from 'sonar-ui-common/helpers/request';\nimport throwGlobalError from '../app/utils/throwGlobalError';\n\ninterface RawDomain {\n  actions: T.WebApi.Action[];\n  deprecatedSince?: string;\n  description: string;\n  internal: boolean;\n  path: string;\n  since?: string;\n}\n\nexport function fetchWebApi(showInternal = true): Promise<RawDomain[]> {\n  return getJSON('/api/webservices/list', { include_internals: showInternal })\n    .then(r => r.webServices)\n    .catch(throwGlobalError);\n}\n\nexport function fetchResponseExample(domain: string, action: string): Promise<T.WebApi.Example> {\n  return getJSON('/api/webservices/response_example', { controller: domain, action }).catch(\n    throwGlobalError\n  );\n}\n"],"sourceRoot":""}