{"version":3,"sources":["webpack:///./src/main/js/apps/sessions/components/EmailAlreadyExists.tsx"],"names":["__webpack_require__","r","__webpack_exports__","d","EmailAlreadyExists","react__WEBPACK_IMPORTED_MODULE_0__","react_intl__WEBPACK_IMPORTED_MODULE_1__","sonar_ui_common_components_ui_Alert__WEBPACK_IMPORTED_MODULE_2__","sonar_ui_common_helpers_colors__WEBPACK_IMPORTED_MODULE_3__","sonar_ui_common_helpers_cookies__WEBPACK_IMPORTED_MODULE_4__","sonar_ui_common_helpers_l10n__WEBPACK_IMPORTED_MODULE_5__","sonar_ui_common_helpers_urls__WEBPACK_IMPORTED_MODULE_6__","_api_users__WEBPACK_IMPORTED_MODULE_7__","_app_theme__WEBPACK_IMPORTED_MODULE_8__","[object Object]","this","mounted","state","identityProviders","fetchIdentityProviders","Object","then","_ref","setState","getAuthError","cookie","JSON","parse","decodeURIComponent","renderIdentityProvier","provider","login","identityProvider","find","p","key","className","style","backgroundColor","color","secondFontColor","alt","name","height","src","iconPath","width","authError","id","defaultMessage","values","email","existingProvider","existingLogin","variant","href","concat"],"mappings":"6FAAAA,EAAAC,EAAAC,GAAAF,EAAAG,EAAAD,EAAA,4BAAAE,IAAA,IAAAC,EAAAL,EAAA,GAAAM,EAAAN,EAAA,KAAAO,EAAAP,EAAA,KAAAQ,EAAAR,EAAA,KAAAS,EAAAT,EAAA,IAAAU,EAAAV,EAAA,GAAAW,EAAAX,EAAA,KAAAY,EAAAZ,EAAA,KAAAa,EAAAb,EAAA,KAiCe,MAAMI,UAA2BC,EAAA,cAAhDS,kCACEC,KAAAC,SAAU,EACVD,KAAAE,MAAe,CAAEC,kBAAmB,IAWpCH,KAAAI,uBAAyB,KACvBC,OAAAR,EAAA,EAAAQ,GAAuBC,KACrBC,IAA0B,IAAvBJ,EAAuBI,EAAvBJ,kBACGH,KAAKC,SACPD,KAAKQ,SAAS,CAAEL,uBAGpB,SAIJH,KAAAS,aAAe,KAOb,MAAMC,EAASL,OAAAX,EAAA,UAAAW,CAAU,wBACzB,OAAIK,EACKC,KAAKC,MAAMC,mBAAmBH,IAEhC,IAGTV,KAAAc,sBAAwB,CAACC,EAAmBC,KAC1C,MAAMC,EAAmBjB,KAAKE,MAAMC,kBAAkBe,KAAKC,GAAKA,EAAEC,MAAQL,GAE1E,OAAOE,EACL3B,EAAA,qBACE+B,UAAU,oBACVC,MAAO,CACLC,gBAAiBN,EAAiBM,gBAClCC,MAAOnB,OAAAZ,EAAA,aAAAY,CAAaY,EAAiBM,gBAAiBzB,EAAA,OAAO2B,mBAE/DnC,EAAA,qBACEoC,IAAKT,EAAiBU,KACtBN,UAAU,sBACVO,OAAO,KACPC,IAAKxB,OAAAT,EAAA,WAAAS,GAAeY,EAAiBa,SACrCC,MAAM,OAEPf,GAGH1B,EAAA,yBACgB,cAAbyB,GAA4BA,MAAWC,IAvD9CjB,oBACEC,KAAKC,SAAU,EACfD,KAAKI,yBAGPL,uBACEC,KAAKC,SAAU,EAsDjBF,SACE,MAAMiC,EAAYhC,KAAKS,eACvB,OACEnB,EAAA,qBAAK+B,UAAU,sBAAsBY,GAAG,MACtC3C,EAAA,qBAAK+B,UAAU,cAAcY,GAAG,SAC9B3C,EAAA,qBAAK+B,UAAU,yCACb/B,EAAA,mBAAG+B,UAAU,wBACX/B,EAAA,cAACC,EAAA,iBAAgB,CACf2C,eAAgB7B,OAAAV,EAAA,UAAAU,CAAU,mCAC1B4B,GAAG,kCACHE,OAAQ,CAAEC,MAAO9C,EAAA,4BAAS0C,EAAUI,WAGvCpC,KAAKc,sBAAsBkB,EAAUK,iBAAkBL,EAAUM,gBAGpEhD,EAAA,qBAAK+B,UAAU,oCACb/B,EAAA,mBAAG+B,UAAU,wBAAwBhB,OAAAV,EAAA,UAAAU,CAAU,oCAC9CL,KAAKc,sBAAsBkB,EAAUjB,SAAUiB,EAAUhB,QAG5D1B,EAAA,cAACE,EAAA,MAAK,CAAC+C,QAAQ,WACZlC,OAAAV,EAAA,UAAAU,CAAU,mCACXf,EAAA,oBAAI+B,UAAU,eACZ/B,EAAA,oBAAI+B,UAAU,cAAchB,OAAAV,EAAA,UAAAU,CAAU,oCACtCf,EAAA,oBAAI+B,UAAU,cAAchB,OAAAV,EAAA,UAAAU,CAAU,oCACtCf,EAAA,oBAAI+B,UAAU,cAAchB,OAAAV,EAAA,UAAAU,CAAU,sCAI1Cf,EAAA,qBAAK+B,UAAU,6BACb/B,EAAA,mBACE+B,UAAU,qBACVmB,KAAI,GAAAC,OAAKpC,OAAAT,EAAA,WAAAS,GAAL,mBAAAoC,OAAmCT,EAAUjB,SAA7C,0BACHV,OAAAV,EAAA,UAAAU,CAAU,aAEbf,EAAA,mBAAG+B,UAAU,4BAA4BmB,KAAMnC,OAAAT,EAAA,WAAAS,GAAe,KAC3DA,OAAAV,EAAA,UAAAU,CAAU","file":"js/379.m.b78c9a02.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { getTextColor } from 'sonar-ui-common/helpers/colors';\nimport { getCookie } from 'sonar-ui-common/helpers/cookies';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { getBaseUrl } from 'sonar-ui-common/helpers/urls';\nimport { getIdentityProviders } from '../../../api/users';\nimport { colors } from '../../../app/theme';\n\ninterface State {\n  identityProviders: T.IdentityProvider[];\n}\n\nexport default class EmailAlreadyExists extends React.PureComponent<{}, State> {\n  mounted = false;\n  state: State = { identityProviders: [] };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchIdentityProviders();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchIdentityProviders = () => {\n    getIdentityProviders().then(\n      ({ identityProviders }) => {\n        if (this.mounted) {\n          this.setState({ identityProviders });\n        }\n      },\n      () => {}\n    );\n  };\n\n  getAuthError = (): {\n    email?: string;\n    login?: string;\n    provider?: string;\n    existingLogin?: string;\n    existingProvider?: string;\n  } => {\n    const cookie = getCookie('AUTHENTICATION-ERROR');\n    if (cookie) {\n      return JSON.parse(decodeURIComponent(cookie));\n    }\n    return {};\n  };\n\n  renderIdentityProvier = (provider?: string, login?: string) => {\n    const identityProvider = this.state.identityProviders.find(p => p.key === provider);\n\n    return identityProvider ? (\n      <div\n        className=\"identity-provider\"\n        style={{\n          backgroundColor: identityProvider.backgroundColor,\n          color: getTextColor(identityProvider.backgroundColor, colors.secondFontColor)\n        }}>\n        <img\n          alt={identityProvider.name}\n          className=\"little-spacer-right\"\n          height=\"14\"\n          src={getBaseUrl() + identityProvider.iconPath}\n          width=\"14\"\n        />\n        {login}\n      </div>\n    ) : (\n      <div>\n        {provider !== 'sonarqube' && provider} {login}\n      </div>\n    );\n  };\n\n  render() {\n    const authError = this.getAuthError();\n    return (\n      <div className=\"page-wrapper-simple\" id=\"bd\">\n        <div className=\"page-simple\" id=\"nonav\">\n          <div className=\"big-spacer-bottom js-existing-account\">\n            <p className=\"little-spacer-bottom\">\n              <FormattedMessage\n                defaultMessage={translate('sessions.email_already_exists.1')}\n                id=\"sessions.email_already_exists.1\"\n                values={{ email: <strong>{authError.email}</strong> }}\n              />\n            </p>\n            {this.renderIdentityProvier(authError.existingProvider, authError.existingLogin)}\n          </div>\n\n          <div className=\"big-spacer-bottom js-new-account\">\n            <p className=\"little-spacer-bottom\">{translate('sessions.email_already_exists.2')}</p>\n            {this.renderIdentityProvier(authError.provider, authError.login)}\n          </div>\n\n          <Alert variant=\"warning\">\n            {translate('sessions.email_already_exists.3')}\n            <ul className=\"list-styled\">\n              <li className=\"spacer-top\">{translate('sessions.email_already_exists.4')}</li>\n              <li className=\"spacer-top\">{translate('sessions.email_already_exists.5')}</li>\n              <li className=\"spacer-top\">{translate('sessions.email_already_exists.6')}</li>\n            </ul>\n          </Alert>\n\n          <div className=\"big-spacer-top text-right\">\n            <a\n              className=\"button js-continue\"\n              href={`${getBaseUrl()}/sessions/init/${authError.provider}?allowEmailShift=true`}>\n              {translate('continue')}\n            </a>\n            <a className=\"big-spacer-left js-cancel\" href={getBaseUrl() + '/'}>\n              {translate('cancel')}\n            </a>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n"],"sourceRoot":""}